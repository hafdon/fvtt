'use strict';const _0x21d2=['isStreamerMode','copy','spells','concentration','time','1hJyAhJ','_pageFilter','DetailPreparation','getSpellItemItemOpts','schoolLong','pGetSpellItem','OwnedItem','absorbFnBindListenersRadio','5etools-spells','init','_titleButtonRun','name','[name=\x22sel-preparation-mode\x22]','Spells','sourceJsonToFull','_list','meta','getListDisplayLevel','[name=\x22sel-is-prepared\x22]','log','sp__school-','source','_titleSearch','[name=\x22btn-run\x22]','_isRadio','_pFnPostProcessEntries','_normalisedTime','val','Time','constructor','entries','isNonstandardSource','1110199zvBKxP','_normalisedRange','_dataList','getData','initBtnSortHandlers','map','SOURCE_TYP_BREW','_content','sourceJsonToColor','\x20(rit.)','_pImportEntry_pImportToDirectoryGeneric','DataSourceUrl','technomagic','Upload\x20File','isTemp','render','absorbFnBindListeners','.search','absorbFnGetData','_actor','pGetSources','_isConc','2053SFeCjc','reset','2tGALSd','sourceShort','8068RyYbdz','Range','schoolShort','168174NkhbqB','schoolClassName','find','Level','\x22\x20(from\x20\x22','pGetHomebrewSources','5etools','SOURCE_TYP_CUSTOM','_resolve','2-5','sourceJsonToAbv','level','close','SOURCE_TYP_ARCANA','range','ritual','[name=\x22btn-reset\x22]','Custom\x20URL','sourceClassName','btn-run-mods','/template/ImportListSpellDetailPreparation.handlebars','PG_SPELLS','preparation.mode','.veapp__list','school','spLevelToFull','doAbsorbItems','_l_time','activateListeners','items','getFolderPathMeta','_activateListeners_absorbListItems','getSpellUrl','MODULE_LOCATION','_$btnReset','107275jyHJsX','342607znXqeW','preparation.prepared','_l_school','151PVgQvC','12pmXmCl','_pImportEntry_pImportToActor','pImportEntry','0-3','\x20level','Concentration','spell','143321oRmpwn','get','isToken','sheet','_isPreviewable','foundryData','subschools','click','[data-name=\x22wrp-btns-sort\x22]','titleSearch','pGetSpellIndex','text-center'];const _0x1b73=function(_0x4f16b3,_0x506bed){_0x4f16b3=_0x4f16b3-0xde;let _0x21d24f=_0x21d2[_0x4f16b3];return _0x21d24f;};const _0x33f9da=_0x1b73;(function(_0x10da63,_0x3223de){const _0x1fb614=_0x1b73;while(!![]){try{const _0x4bc1d8=parseInt(_0x1fb614(0x114))*parseInt(_0x1fb614(0x103))+parseInt(_0x1fb614(0x14e))*parseInt(_0x1fb614(0xfc))+parseInt(_0x1fb614(0x151))+-parseInt(_0x1fb614(0x14c))*parseInt(_0x1fb614(0xf8))+-parseInt(_0x1fb614(0xf7))+parseInt(_0x1fb614(0x14a))*-parseInt(_0x1fb614(0xfb))+parseInt(_0x1fb614(0x134));if(_0x4bc1d8===_0x3223de)break;else _0x10da63['push'](_0x10da63['shift']());}catch(_0x42eda4){_0x10da63['push'](_0x10da63['shift']());}}}(_0x21d2,0x65912));import{ImportList}from'./ImportList.js';import{Vetools}from'./Vetools.js';import{LGT,Util}from'./Util.js';import{UtilActors}from'./UtilActors.js';import{Config}from'./Config.js';import{UtilList2}from'./UtilList2.js';import{DataConverterSpell}from'./DataConverterSpell.js';import{SharedConsts}from'../shared/SharedConsts.js';import{ImportListCreature}from'./ImportListCreature.js';import{UtilApplications}from'./UtilApplications.js';class ImportListSpell extends ImportList{constructor(_0x52ff3c){const _0x232e9f=_0x1b73;_0x52ff3c=_0x52ff3c||{},super({'title':'Import\x20Spells'},_0x52ff3c,{'props':['spell'],'titleSearch':_0x232e9f(0x111),'sidebarTab':'items','gameProp':_0x232e9f(0xf1),'defaultFolderPath':[_0x232e9f(0x121)],'folderType':'Item','fnListSort':PageFilterSpells['sortSpells'],'pageFilter':new PageFilterSpells(),'page':UrlUtil[_0x232e9f(0xe9)],'isPreviewable':!![],'isModdable':!![],'isDedupable':!![]});}async[_0x33f9da(0x148)](){const _0x3b81ed=_0x33f9da,_0x310b55=await Vetools[_0x3b81ed(0x10d)]();return[new ImportList['DataSourceSpecial'](Config[_0x3b81ed(0x104)]('ui',_0x3b81ed(0x10f))?'SRD':_0x3b81ed(0x157),async()=>(await Vetools['pGetAllSpells']())['spell'],{'cacheKey':_0x3b81ed(0x11c),'filterTypes':[ImportList['SOURCE_TYP_OFFICIAL_ALL']],'isDefault':!![]}),new ImportList[(_0x3b81ed(0x13f))](_0x3b81ed(0xe5),'',{'filterTypes':[ImportList[_0x3b81ed(0x158)]]}),new ImportList['DataSourceFile'](_0x3b81ed(0x141),{'filterTypes':[ImportList[_0x3b81ed(0x158)]]}),...Object[_0x3b81ed(0x132)](_0x310b55)[_0x3b81ed(0x139)](([_0x22773e,_0x54b04f])=>new ImportList[(_0x3b81ed(0x13f))](Parser[_0x3b81ed(0x122)](_0x22773e),Vetools[_0x3b81ed(0xf4)](_0x54b04f),{'source':_0x22773e,'filterTypes':SourceUtil[_0x3b81ed(0x133)](_0x22773e)?[ImportList[_0x3b81ed(0xe1)]]:[ImportList['SOURCE_TYP_OFFICIAL_SINGLE']]})),...(await Vetools[_0x3b81ed(0x156)](_0x3b81ed(0x102)))[_0x3b81ed(0x139)](({name:_0x4c58b8,url:_0x267894})=>new ImportList[(_0x3b81ed(0x13f))](_0x4c58b8,_0x267894,{'filterTypes':[ImportList[_0x3b81ed(0x13a)]]}))];}[_0x33f9da(0xf2)](){const _0x263aaa=_0x33f9da;return{...super[_0x263aaa(0xf2)](),'level':{'label':_0x263aaa(0x154),'getter':_0x250d35=>''+Parser[_0x263aaa(0xed)](_0x250d35[_0x263aaa(0xdf)])+(_0x250d35[_0x263aaa(0xdf)]?_0x263aaa(0x100):'')},'spellPoints':{'label':'Spell\x20Points','getter':_0x559202=>{const _0x3d5a57=(()=>{const _0x43ee89=_0x1b73;switch(_0x559202[_0x43ee89(0xdf)]){case 0x1:return 0x2;case 0x2:return 0x3;case 0x3:return 0x5;case 0x4:return 0x6;case 0x5:return 0x7;case 0x6:return 0x8;case 0x7:return 0xa;case 0x8:return 0xb;case 0x9:return 0xd;case 0x0:default:return 0x0;}})();return _0x3d5a57+'\x20Spell\x20Points';}}};}[_0x33f9da(0x137)](){const _0x3e8313=_0x33f9da;return{'isPreviewable':this[_0x3e8313(0x107)],'titleButtonRun':this[_0x3e8313(0x11e)],'titleSearch':this['_titleSearch'],'buttonsAdditional':[{'name':_0x3e8313(0xe7),'text':'Import\x20and\x20Set\x20Preparation\x20Details'}],'cols':[{'name':'Name','width':'3-2','field':_0x3e8313(0x11f)},{'name':'Level','width':0x1,'field':_0x3e8313(0xdf),'rowClassName':_0x3e8313(0x10e)},{'name':_0x3e8313(0x130),'width':0x2,'field':_0x3e8313(0x113),'rowClassName':_0x3e8313(0x10e)},{'name':'School','width':0x1,'field':_0x3e8313(0xec),'titleProp':_0x3e8313(0x118),'displayProp':_0x3e8313(0x150),'classNameProp':_0x3e8313(0x152),'rowClassName':'text-center'},{'name':'C.','width':_0x3e8313(0xff),'field':_0x3e8313(0x112),'rowClassName':_0x3e8313(0x10e),'title':_0x3e8313(0x101)},{'name':_0x3e8313(0x14f),'width':_0x3e8313(0x15a),'field':_0x3e8313(0xe2),'rowClassName':'text-right'},{'name':'Source','width':0x1,'field':'source','titleProp':'sourceLong','displayProp':_0x3e8313(0x14d),'classNameProp':_0x3e8313(0xe6),'rowClassName':_0x3e8313(0x10e)}],'rows':this[_0x3e8313(0x13b)][_0x3e8313(0x139)]((_0x4a58d9,_0x26a472)=>{const _0x314365=_0x3e8313;return this[_0x314365(0x115)][_0x314365(0x131)]['mutateForFilters'](_0x4a58d9),_0x4a58d9[_0x314365(0xef)]=PageFilterSpells['getTblTimeStr'](_0x4a58d9['time'][0x0]),_0x4a58d9['_l_school']=Parser['spSchoolAbvToFull'](_0x4a58d9[_0x314365(0xec)],_0x4a58d9[_0x314365(0x109)]),{'name':_0x4a58d9[_0x314365(0x11f)],'level':this[_0x314365(0x131)][_0x314365(0x125)](_0x4a58d9),'time':_0x4a58d9[_0x314365(0xef)],'range':Parser['spRangeToFull'](_0x4a58d9[_0x314365(0xe2)]),'source':_0x4a58d9[_0x314365(0x129)],'sourceShort':Parser[_0x314365(0xde)](_0x4a58d9['source']),'sourceLong':Parser[_0x314365(0x122)](_0x4a58d9[_0x314365(0x129)]),'sourceClassName':Parser['sourceJsonToColor'](_0x4a58d9[_0x314365(0x129)]),'school':_0x4a58d9[_0x314365(0xec)],'schoolShort':Parser['spSchoolAndSubschoolsAbvsShort'](_0x4a58d9[_0x314365(0xec)],_0x4a58d9['subschools']),'schoolLong':_0x4a58d9[_0x314365(0xfa)],'schoolClassName':_0x314365(0x128)+_0x4a58d9[_0x314365(0xec)],'concentration':_0x4a58d9[_0x314365(0x149)]?'Ã—':'','ix':_0x26a472};})};}[_0x33f9da(0xf3)](){const _0x5b66f4=_0x33f9da;this[_0x5b66f4(0x123)][_0x5b66f4(0xee)](this['_content'],{'fnGetName':_0x3ee588=>_0x3ee588[_0x5b66f4(0x11f)],'fnGetValues':_0x310a33=>({'source':_0x310a33[_0x5b66f4(0x129)],'level':_0x310a33['level'],'time':_0x310a33[_0x5b66f4(0xef)],'normalisedTime':_0x310a33[_0x5b66f4(0x12e)],'normalisedRange':_0x310a33[_0x5b66f4(0x135)],'school':_0x310a33[_0x5b66f4(0xfa)],'concentration':_0x310a33[_0x5b66f4(0x149)],'hash':UrlUtil['URL_TO_HASH_BUILDER'][this['_page']](_0x310a33)}),'fnGetData':UtilList2[_0x5b66f4(0x146)],'fnBindListeners':_0x5cd1c1=>this[_0x5b66f4(0x12c)]?UtilList2[_0x5b66f4(0x11b)](this[_0x5b66f4(0x123)],_0x5cd1c1):UtilList2[_0x5b66f4(0x144)](this[_0x5b66f4(0x123)],_0x5cd1c1)});}[_0x33f9da(0x12d)](_0x93fb93){if(!this['_isUseMods'])return _0x93fb93;return new Promise(_0x4d9b79=>{const _0x742373=_0x1b73,_0x295b8e=new ImportListSpell[(_0x742373(0x116))](_0x93fb93,_0x4d9b79,{'titleSearch':this[_0x742373(0x12a)]});_0x295b8e[_0x742373(0x143)](!![]);});}async[_0x33f9da(0xfe)](_0x8fbbf,_0x591600){const _0x4e8115=_0x33f9da;_0x591600=_0x591600||{},console[_0x4e8115(0x127)](...LGT,'Importing\x20spell\x20\x22'+_0x8fbbf[_0x4e8115(0x11f)]+_0x4e8115(0x155)+Parser['sourceJsonToAbv'](_0x8fbbf[_0x4e8115(0x129)])+'\x22)');if(_0x591600[_0x4e8115(0x142)])return this[_0x4e8115(0x13e)](_0x8fbbf,_0x591600);else{if(this[_0x4e8115(0x147)])return this[_0x4e8115(0xfd)](_0x8fbbf,_0x591600);else return this[_0x4e8115(0x13e)](_0x8fbbf,_0x591600);}}async[_0x33f9da(0xfd)](_0x5f49f4,_0x5940c7){const _0x4d2157=_0x33f9da,_0x1bb331=await this['_actor']['createEmbeddedEntity'](_0x4d2157(0x11a),await DataConverterSpell[_0x4d2157(0x119)](_0x5f49f4,UtilActors['getActorSpellItemOpts'](this[_0x4d2157(0x147)])),{});if(this['_actor'][_0x4d2157(0x105)])this[_0x4d2157(0x147)][_0x4d2157(0x106)][_0x4d2157(0x143)]();return{'imported':{'name':_0x5f49f4['name'],'actor':this[_0x4d2157(0x147)],'embeddedEntity':_0x1bb331},'status':UtilApplications['TASK_EXIT_COMPLETE']};}['_pImportEntry_pImportToDirectoryGeneric_pGetImportableData'](_0x1129a5,_0x41109c){const _0x342189=_0x33f9da;return DataConverterSpell[_0x342189(0x119)](_0x1129a5,{...UtilActors[_0x342189(0x117)](),..._0x41109c});}static[_0x33f9da(0x125)](_0x171289){const _0x484039=_0x33f9da;return''+Parser[_0x484039(0xed)](_0x171289[_0x484039(0xdf)])+(_0x171289[_0x484039(0x124)]&&_0x171289[_0x484039(0x124)][_0x484039(0xe3)]?_0x484039(0x13d):'')+(_0x171289[_0x484039(0x124)]&&_0x171289[_0x484039(0x124)][_0x484039(0x140)]?'\x20(tec.)':'');}}ImportListSpell['DetailPreparation']=class extends Application{constructor(_0x4e97da,_0x69671f,_0x4f4842){const _0x15251d=_0x33f9da;super({'title':'Set\x20Preparation\x20Details','template':SharedConsts[_0x15251d(0xf5)]+_0x15251d(0xe8),'width':0x3c0,'height':Util['getMaxWindowHeight'](),'resizable':!![]}),this[_0x15251d(0x136)]=_0x4e97da,this[_0x15251d(0x159)]=_0x69671f,this[_0x15251d(0x12a)]=_0x4f4842[_0x15251d(0x10c)],this['_list']=null,this['_$btnReset']=null;}[_0x33f9da(0x137)](){const _0x4f0bf4=_0x33f9da;return{'titleSearch':this[_0x4f0bf4(0x12a)],'rows':this[_0x4f0bf4(0x136)]['map']((_0x3e3ca1,_0x1c485b)=>({'name':_0x3e3ca1[_0x4f0bf4(0x11f)],'level':ImportListSpell[_0x4f0bf4(0x125)](_0x3e3ca1),'source':_0x3e3ca1[_0x4f0bf4(0x129)],'sourceShort':Parser[_0x4f0bf4(0xde)](_0x3e3ca1[_0x4f0bf4(0x129)]),'sourceLong':Parser[_0x4f0bf4(0x122)](_0x3e3ca1[_0x4f0bf4(0x129)]),'sourceClassName':Parser[_0x4f0bf4(0x13c)](_0x3e3ca1['source']),'ix':_0x1c485b}))};}['activateListeners'](_0x4c2a0f){const _0x5462ba=_0x33f9da;super[_0x5462ba(0xf0)](_0x4c2a0f),this[_0x5462ba(0x123)]=new List({'$iptSearch':_0x4c2a0f[_0x5462ba(0x153)]('.search'),'$wrpList':_0x4c2a0f[_0x5462ba(0x153)](_0x5462ba(0xeb)),'valueNames':[_0x5462ba(0x11f),_0x5462ba(0x129),_0x5462ba(0xdf),'ix']}),SortUtil[_0x5462ba(0x138)](_0x4c2a0f['find'](_0x5462ba(0x10b)),this[_0x5462ba(0x123)]),this[_0x5462ba(0x123)]['doAbsorbItems'](this['_dataList'],{'fnGetName':_0x3e2f65=>_0x3e2f65[_0x5462ba(0x11f)],'fnGetValues':_0x54d8ee=>({'source':_0x54d8ee[_0x5462ba(0x129)],'level':_0x54d8ee['level']})}),this[_0x5462ba(0x123)][_0x5462ba(0x11d)](),this[_0x5462ba(0xf6)]=_0x4c2a0f[_0x5462ba(0x153)](_0x5462ba(0xe4))['click'](()=>{const _0x2a15e0=_0x5462ba;_0x4c2a0f[_0x2a15e0(0x153)](_0x2a15e0(0x145))['val']('');if(this[_0x2a15e0(0x123)])this[_0x2a15e0(0x123)][_0x2a15e0(0x14b)]();}),_0x4c2a0f['find'](_0x5462ba(0x12b))[_0x5462ba(0x10a)](async()=>{const _0x54aeed=_0x5462ba,_0x5a5471=this[_0x54aeed(0x123)]['items'][_0x54aeed(0x139)](_0x4f0a58=>{const _0x2501d0=_0x54aeed,_0x391f59=$(_0x4f0a58['ele']),_0xa4d21b=_0x391f59[_0x2501d0(0x153)](_0x2501d0(0x126))[_0x2501d0(0x12f)](),_0x22b6fe=_0x391f59['find'](_0x2501d0(0x120))[_0x2501d0(0x12f)](),_0x198ca8=_0xa4d21b&&_0xa4d21b!=='-1',_0x516713=_0x22b6fe&&_0x22b6fe!=='-1';if(!_0x198ca8&&!_0x516713)return this['_dataList'][_0x4f0a58['ix']];const _0x306b47=MiscUtil[_0x2501d0(0x110)](this[_0x2501d0(0x136)][_0x4f0a58['ix']]);_0x306b47[_0x2501d0(0x108)]={};if(_0x198ca8)_0x306b47[_0x2501d0(0x108)][_0x2501d0(0xf9)]=!!Number(_0xa4d21b);if(_0x516713)_0x306b47[_0x2501d0(0x108)][_0x2501d0(0xea)]=_0x22b6fe;return _0x306b47;});this[_0x54aeed(0x159)](_0x5a5471),this[_0x54aeed(0xe0)]();});if(this[_0x5462ba(0xf6)])this['_$btnReset']['click']();}async[_0x33f9da(0xe0)](){const _0x36c717=_0x33f9da;return this['_resolve'](null),super[_0x36c717(0xe0)]();}};export{ImportListSpell};
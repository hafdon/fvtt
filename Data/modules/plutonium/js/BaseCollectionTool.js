const _0x3935=['136YDEnDA','\x20folder','_folderType','Delete','find','[name=btn-filter]','delete','<h3>Are\x20you\x20sure?</h3><p>','_pDoPruneFolders','_getSelectedIds','absorbFnGetData','_activateListeners_initBtnReset','actors','info','length','_activateListeners_pInitListAndFilters','_sidebarTab','bind','643571srRTME','toDisplay','render','input','fa-trash','_activateListeners_doBindSelectAll','_pDoDelete','.fltr__mini-view','_gameProp','children','tool-folderizer_','uppercaseFirst','its','map','close','.search','checked','_activateListeners_initBtnPrune','[name=\x22btn-prune\x22]','_rows','notifications','add','.veapp__list','_mapEntitiesToRows','_handleFilterChange','filterBox','forEach','Deleted\x20','then','_pageFilter','collection','sort','data','getFolderPath','Failed\x20to\x20delete\x20','get','ele','addToFilters','9868jJETHG','journal','_collection','pRunTasks','Item','RollTable','[name=btn-toggle-summary]','STR_SEE_CONSOLE','Delete\x20','2911dkfZdk','_pDeleteItem','Unknown\x20collection\x20\x22','Deleting\x20','<h3>Are\x20you\x20sure?</h3><p>Any\x20empty\x20folders\x20will\x20be\x20permanently\x20deleted.</p>','_sortNamePathRows','activateTab','click','item','Delete\x20Folders','133pfTdmb','...','filter','_activateListeners_listAbsorbGetData','6gOyENc','actor','Please\x20select\x20something\x20to\x20delete!','reset','Actor','name','JournalEntry','type','15dsxUJG','\x20and\x20','EVNT_VALCHANGE','_collectionName','pInitFilterBox','getValues','_list','[name=\x22cb-select-all\x22]','values','674916SvfbcO','content','items','_$btnReset','has','4437JJYZFv','Delete\x20Complete','absorbFnBindListeners','ascSortLower','_listSortNamePathRows','their','49023JfKfst','_$iptSearch','[data-name=\x22wrp-btns-sort\x22]','path','prop','473634rrFfGj','entities','[name=\x22btn-reset\x22]'];const _0x5cdc=function(_0x11b6a2,_0x5b01bd){_0x11b6a2=_0x11b6a2-0x111;let _0x39350e=_0x3935[_0x11b6a2];return _0x39350e;};const _0x5c9632=_0x5cdc;(function(_0x18534f,_0x4a5d1a){const _0x2b8726=_0x5cdc;while(!![]){try{const _0x3870ba=parseInt(_0x2b8726(0x114))+-parseInt(_0x2b8726(0x129))+-parseInt(_0x2b8726(0x16e))*parseInt(_0x2b8726(0x14f))+parseInt(_0x2b8726(0x177))+parseInt(_0x2b8726(0x166))*parseInt(_0x2b8726(0x182))+-parseInt(_0x2b8726(0x117))*parseInt(_0x2b8726(0x17c))+-parseInt(_0x2b8726(0x158))*-parseInt(_0x2b8726(0x162));if(_0x3870ba===_0x4a5d1a)break;else _0x18534f['push'](_0x18534f['shift']());}catch(_0x4f584a){_0x18534f['push'](_0x18534f['shift']());}}}(_0x3935,0x6a28c));import{UtilList2}from'./UtilList2.js';import{UtilApplications}from'./UtilApplications.js';import{Util}from'./Util.js';class BaseCollectionTool extends Application{static[_0x5c9632(0x15d)](_0x15ca84,_0x4edbfa){const _0x510960=_0x5c9632;if(_0x15ca84[_0x510960(0x112)]==null&&_0x4edbfa[_0x510960(0x112)]==null)return SortUtil[_0x510960(0x17f)](_0x15ca84['name'],_0x4edbfa[_0x510960(0x16b)]);if(_0x15ca84[_0x510960(0x112)]!=null&&_0x4edbfa[_0x510960(0x112)]==null)return-0x1;if(_0x15ca84[_0x510960(0x112)]==null&&_0x4edbfa[_0x510960(0x112)]!=null)return 0x1;return SortUtil[_0x510960(0x17f)](_0x15ca84['path'],_0x4edbfa[_0x510960(0x112)])||SortUtil[_0x510960(0x17f)](_0x15ca84[_0x510960(0x16b)],_0x4edbfa['name']);}static['_listSortNamePathRows'](_0x4db749,_0x2d481f,_0x32f702){const _0xee3560=_0x5c9632,_0x202ed4={'name':_0x4db749['name'],'path':_0x4db749[_0xee3560(0x176)][_0xee3560(0x112)]},_0x137137={'name':_0x2d481f[_0xee3560(0x16b)],'path':_0x2d481f[_0xee3560(0x176)][_0xee3560(0x112)]};return BaseCollectionTool['_sortNamePathRows'](_0x202ed4,_0x137137);}constructor(_0x509786,_0x838ddf){const _0x21b122=_0x5c9632;super(_0x509786),this[_0x21b122(0x171)]=_0x838ddf,this[_0x21b122(0x151)]=null,this[_0x21b122(0x127)]=null,this['_gameProp']=null,this[_0x21b122(0x119)]=null;switch(_0x838ddf){case _0x21b122(0x160):{this[_0x21b122(0x151)]=Item[_0x21b122(0x147)],this['_sidebarTab']=_0x21b122(0x179),this[_0x21b122(0x131)]=_0x21b122(0x179),this[_0x21b122(0x119)]=_0x21b122(0x153);break;}case _0x21b122(0x167):{this[_0x21b122(0x151)]=Actor[_0x21b122(0x147)],this[_0x21b122(0x127)]=_0x21b122(0x123),this[_0x21b122(0x131)]='actors',this[_0x21b122(0x119)]=_0x21b122(0x16a);break;}case'journal':{this['_collection']=JournalEntry[_0x21b122(0x147)],this[_0x21b122(0x127)]='journal',this[_0x21b122(0x131)]=_0x21b122(0x150),this[_0x21b122(0x119)]=_0x21b122(0x16c);break;}case'rolltable':{this[_0x21b122(0x151)]=RollTable['collection'],this[_0x21b122(0x127)]='tables',this[_0x21b122(0x131)]='tables',this[_0x21b122(0x119)]=_0x21b122(0x154);break;}default:throw new Error(_0x21b122(0x15a)+_0x838ddf+'\x22');}}[_0x5c9632(0x140)](){const _0x370eb7=_0x5c9632;return this[_0x370eb7(0x151)]['entities'][_0x370eb7(0x136)]((_0xb41b74,_0x13b851)=>{const _0x213de1=_0x370eb7,_0x21ab37=UtilApplications[_0x213de1(0x14a)](_0xb41b74,{'isAddTrailingSlash':!![]});return{'path':_0x21ab37,'name':_0xb41b74['name'],'displayName':''+(_0x21ab37||'')+_0xb41b74[_0x213de1(0x16b)],'id':_0xb41b74['id'],'type':MiscUtil[_0x213de1(0x14c)](_0xb41b74,_0x213de1(0x149),'type')||'unknown','ix':_0x13b851};})[_0x370eb7(0x148)](BaseCollectionTool['_sortNamePathRows']);}['_handleFilterChange'](){const _0x25f21c=_0x5c9632,_0x40b8af=this[_0x25f21c(0x146)][_0x25f21c(0x142)][_0x25f21c(0x173)]();this[_0x25f21c(0x174)][_0x25f21c(0x164)](_0x587f40=>this[_0x25f21c(0x146)][_0x25f21c(0x12a)](_0x40b8af,this['_rows'][_0x587f40['ix']]));}[_0x5c9632(0x122)](_0x23552d){const _0x348f6f=_0x5c9632;this[_0x348f6f(0x17a)]=_0x23552d['find'](_0x348f6f(0x116))['click'](()=>{const _0x20441f=_0x348f6f;_0x23552d[_0x20441f(0x11b)](_0x20441f(0x138))['val']('');if(this[_0x20441f(0x174)])this[_0x20441f(0x174)][_0x20441f(0x169)]();});}[_0x5c9632(0x165)](_0x1dbb56){const _0x565600=_0x5c9632;return UtilList2[_0x565600(0x121)](_0x1dbb56);}[_0x5c9632(0x12e)](_0x4fdb93){const _0x12c1ca=_0x5c9632;ListUiUtil['bindSelectAllCheckbox'](_0x4fdb93,this[_0x12c1ca(0x174)]);}[_0x5c9632(0x126)](_0x11550b){const _0x5b6ac4=_0x5c9632;return this[_0x5b6ac4(0x183)]=_0x11550b[_0x5b6ac4(0x11b)](_0x5b6ac4(0x138)),this[_0x5b6ac4(0x174)]=new List({'$iptSearch':this[_0x5b6ac4(0x183)],'$wrpList':_0x11550b[_0x5b6ac4(0x11b)](_0x5b6ac4(0x13f)),'fnSort':BaseCollectionTool[_0x5b6ac4(0x180)]}),SortUtil['initBtnSortHandlers'](_0x11550b[_0x5b6ac4(0x11b)](_0x5b6ac4(0x111)),this[_0x5b6ac4(0x174)]),this[_0x5b6ac4(0x12e)](_0x11550b[_0x5b6ac4(0x11b)](_0x5b6ac4(0x175))),this[_0x5b6ac4(0x146)][_0x5b6ac4(0x172)]({'$iptSearch':this[_0x5b6ac4(0x183)],'$btnReset':this[_0x5b6ac4(0x17a)],'$btnOpen':_0x11550b[_0x5b6ac4(0x11b)](_0x5b6ac4(0x11c)),'$btnToggleSummaryHidden':_0x11550b[_0x5b6ac4(0x11b)](_0x5b6ac4(0x155)),'$wrpMiniPills':_0x11550b[_0x5b6ac4(0x11b)](_0x5b6ac4(0x130)),'namespace':_0x5b6ac4(0x133)+this[_0x5b6ac4(0x171)]})[_0x5b6ac4(0x145)](()=>{const _0x2489c3=_0x5b6ac4;this[_0x2489c3(0x13c)][_0x2489c3(0x143)](_0x48491d=>this[_0x2489c3(0x146)][_0x2489c3(0x14e)](_0x48491d)),this['_list']['doAbsorbItems'](this[_0x2489c3(0x13c)],{'fnGetName':_0x49e0c2=>_0x49e0c2['name'],'fnGetValues':_0x54935e=>({'id':_0x54935e['id'],'path':_0x54935e[_0x2489c3(0x112)]}),'fnGetData':this['_activateListeners_listAbsorbGetData'][_0x2489c3(0x128)](this),'fnBindListeners':_0x2ac0ed=>UtilList2[_0x2489c3(0x17e)](this['_list'],_0x2ac0ed)}),this['_list']['init'](),this[_0x2489c3(0x146)][_0x2489c3(0x142)][_0x2489c3(0x12b)](),this[_0x2489c3(0x146)][_0x2489c3(0x142)]['on'](FilterBox[_0x2489c3(0x170)],this['_handleFilterChange'][_0x2489c3(0x128)](this)),this[_0x2489c3(0x141)]();});}[_0x5c9632(0x120)](){const _0x344e92=_0x5c9632;return this[_0x344e92(0x174)][_0x344e92(0x179)]['filter'](_0x5bb302=>$(_0x5bb302[_0x344e92(0x14d)])[_0x344e92(0x11b)](_0x344e92(0x12c))[_0x344e92(0x113)](_0x344e92(0x139)))['map'](_0x3dd8fa=>({'name':_0x3dd8fa[_0x344e92(0x16b)],'id':_0x3dd8fa[_0x344e92(0x176)]['id']}));}[_0x5c9632(0x13a)](_0x42ca7d){const _0x4177b5=_0x5c9632;_0x42ca7d['find'](_0x4177b5(0x13b))[_0x4177b5(0x15f)](async()=>{const _0x5d95a3=_0x4177b5,_0x36b8a0=await UtilApplications['pGetConfirmation']({'title':_0x5d95a3(0x161),'content':_0x5d95a3(0x15c),'confirmText':'Delete','faIcon':_0x5d95a3(0x12d)});if(!_0x36b8a0)return;await this['_pDoPruneFolders']();});}async[_0x5c9632(0x12f)](_0x25369e){const _0x1b2222=_0x5c9632;if(!this['_list'])return;let _0x3f944c=this[_0x1b2222(0x120)]();if(!_0x3f944c[_0x1b2222(0x125)])return ui[_0x1b2222(0x13d)]['warn'](_0x1b2222(0x168));const _0x4434da=this[_0x1b2222(0x171)][_0x1b2222(0x134)](),_0x41bdcb=_0x3f944c[_0x1b2222(0x125)]!==0x1?'s':'',_0x3aa472=await UtilApplications['pGetConfirmation']({'title':_0x1b2222(0x157)+_0x4434da+_0x41bdcb,'content':_0x1b2222(0x11e)+_0x3f944c['length']+'\x20'+_0x4434da+_0x41bdcb+_0x1b2222(0x16f)+(_0x41bdcb?_0x1b2222(0x181):_0x1b2222(0x135))+'\x20data\x20will\x20be\x20permanently\x20deleted.</p>','confirmText':_0x1b2222(0x11a),'faIcon':_0x1b2222(0x12d)});if(!_0x3aa472)return;this[_0x1b2222(0x137)](),ui['sidebar'][_0x1b2222(0x15e)](this[_0x1b2222(0x127)]);if(_0x25369e[_0x1b2222(0x113)]('checked')){const _0x1a80f7=await this[_0x1b2222(0x11f)](_0x3f944c[_0x1b2222(0x136)](({id:_0xe8511b})=>_0xe8511b));_0x3f944c=_0x3f944c[_0x1b2222(0x164)](({id:_0x22b671})=>!_0x1a80f7[_0x1b2222(0x17b)](_0x22b671));}const _0x31fb86=_0x3f944c[_0x1b2222(0x136)](({id:_0x385169,name:_0x34009b})=>new Util['Task'](_0x34009b,()=>this[_0x1b2222(0x159)](_0x385169)));await UtilApplications[_0x1b2222(0x152)](_0x31fb86,{'titleInitial':'Deleting...','titleComplete':_0x1b2222(0x17d),'fnGetRowRunningText':_0x279eec=>_0x1b2222(0x15b)+_0x279eec+_0x1b2222(0x163),'fnGetRowSuccessText':_0x54959b=>_0x1b2222(0x144)+_0x54959b+'.','fnGetRowErrorText':_0xccda61=>_0x1b2222(0x14b)+_0xccda61+'!\x20'+VeCt[_0x1b2222(0x156)]});if(_0x25369e['prop'](_0x1b2222(0x139)))await this[_0x1b2222(0x11f)]();game[this[_0x1b2222(0x131)]]['render']();}async[_0x5c9632(0x159)](_0x240517){const _0x261610=_0x5c9632;await this[_0x261610(0x151)][_0x261610(0x14c)](_0x240517)[_0x261610(0x11d)]();}async[_0x5c9632(0x11f)](_0x4a990e){const _0x1678e9=_0x5c9632,_0x17e075=()=>Folder[_0x1678e9(0x147)][_0x1678e9(0x115)][_0x1678e9(0x164)](_0x1b678f=>_0x1b678f[_0x1678e9(0x149)][_0x1678e9(0x16d)]===this[_0x1678e9(0x119)]),_0x289d22=_0x4a990e?new Set(_0x4a990e):null,_0x53f676=new Set();let _0x1ca140=0x0,_0x1bc9c9=null,_0x3706ad=_0x17e075()[_0x1678e9(0x125)];do{let _0x28f966;_0x289d22?_0x28f966=_0x17e075()[_0x1678e9(0x164)](_0x164c90=>{const _0xd3b274=_0x1678e9;if(!_0x164c90['children']||!_0x164c90['children'][_0xd3b274(0x125)]){if(!_0x164c90[_0xd3b274(0x178)][_0xd3b274(0x125)])return!![];const _0x48e695=_0x164c90[_0xd3b274(0x178)][_0xd3b274(0x136)](_0x377314=>_0x377314['id'])[_0xd3b274(0x164)](_0x4ba4c5=>_0x289d22['has'](_0x4ba4c5));if(_0x48e695[_0xd3b274(0x125)]===_0x164c90['content']['length'])return _0x48e695[_0xd3b274(0x143)](_0x555faa=>_0x53f676[_0xd3b274(0x13e)](_0x555faa)),!![];}return![];}):_0x28f966=_0x17e075()['filter'](_0x5ad1c3=>!_0x5ad1c3['content']['length']&&(!_0x5ad1c3[_0x1678e9(0x132)]||!_0x5ad1c3['children']['length']));for(const _0x5c9808 of _0x28f966){await _0x5c9808[_0x1678e9(0x11d)]({'deleteSubfolders':!![],'deleteContents':!![]}),_0x1ca140++;}_0x1bc9c9=_0x3706ad,_0x3706ad=_0x17e075()['length'];}while(_0x3706ad!==_0x1bc9c9);if(_0x1ca140)ui[_0x1678e9(0x13d)][_0x1678e9(0x124)](_0x1678e9(0x144)+_0x1ca140+_0x1678e9(0x118)+(_0x1ca140===0x1?'':'s')+'.');return _0x53f676;}}export{BaseCollectionTool};
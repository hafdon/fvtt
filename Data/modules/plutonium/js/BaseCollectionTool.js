const _0x1828=['_collectionName','their','filterBox','values','_$btnReset','entities','type','_getSelectedIds','Task','notifications','[name=btn-toggle-summary]','tool-folderizer_','filter','find','pInitFilterBox','Deleting...','_mapEntitiesToRows','_listSortNamePathRows','info','_sortNamePathRows','pGetConfirmation','its','fa-trash','path','sort','\x20and\x20','render','Unknown\x20collection\x20\x22','_activateListeners_pInitListAndFilters','\x20folder','length','\x20data\x20will\x20be\x20permanently\x20deleted.</p>','Delete\x20Folders','getValues','JournalEntry','actor','.search','get','tables','_activateListeners_listAbsorbGetData','_list','collection','Actor','Deleting\x20','_collection','has','Delete\x20','checked','prop','Delete','_pDoPruneFolders','EVNT_VALCHANGE','ele','_handleFilterChange','val','[name=\x22btn-reset\x22]','bindSelectAllCheckbox','forEach','warn','_activateListeners_initBtnReset','sidebar','then','Failed\x20to\x20delete\x20','name','Please\x20select\x20something\x20to\x20delete!','getFolderPath','data','[name=btn-filter]','reset','<h3>Are\x20you\x20sure?</h3><p>','actors','absorbFnGetData','[name=\x22btn-prune\x22]','content','_sidebarTab','bind','ascSortLower','doAbsorbItems','journal','_gameProp','Delete\x20Complete','map','children','.veapp__list','[name=\x22cb-select-all\x22]','_pageFilter','addToFilters','_pDoDelete','_pDeleteItem','delete','items','unknown','absorbFnBindListeners','Deleted\x20','_folderType','pRunTasks','_rows','_$iptSearch'];(function(_0x5551a0,_0x18280){const _0x1570f9=function(_0x328181){while(--_0x328181){_0x5551a0['push'](_0x5551a0['shift']());}};_0x1570f9(++_0x18280);}(_0x1828,0x152));const _0x1570=function(_0x5551a0,_0x18280){_0x5551a0=_0x5551a0-0x0;let _0x1570f9=_0x1828[_0x5551a0];return _0x1570f9;};const _0x855b41=_0x1570;'use strict';import{UtilList2}from'./UtilList2.js';import{UtilApplications}from'./UtilApplications.js';import{Util}from'./Util.js';class BaseCollectionTool extends Application{static[_0x855b41('0x49')](_0x328181,_0x12aa2f){const _0x45ab56=_0x855b41;if(_0x328181[_0x45ab56('0x4d')]==null&&_0x12aa2f[_0x45ab56('0x4d')]==null)return SortUtil[_0x45ab56('0x20')](_0x328181[_0x45ab56('0x13')],_0x12aa2f[_0x45ab56('0x13')]);if(_0x328181['path']!=null&&_0x12aa2f[_0x45ab56('0x4d')]==null)return-0x1;if(_0x328181[_0x45ab56('0x4d')]==null&&_0x12aa2f['path']!=null)return 0x1;return SortUtil['ascSortLower'](_0x328181[_0x45ab56('0x4d')],_0x12aa2f[_0x45ab56('0x4d')])||SortUtil[_0x45ab56('0x20')](_0x328181[_0x45ab56('0x13')],_0x12aa2f[_0x45ab56('0x13')]);}static[_0x855b41('0x47')](_0x1439b3,_0x59f81e,_0x4a255e){const _0x5eb6cc=_0x855b41,_0x34ff5d={'name':_0x1439b3[_0x5eb6cc('0x13')],'path':_0x1439b3[_0x5eb6cc('0x39')][_0x5eb6cc('0x4d')]},_0x2a8422={'name':_0x59f81e[_0x5eb6cc('0x13')],'path':_0x59f81e['values'][_0x5eb6cc('0x4d')]};return BaseCollectionTool[_0x5eb6cc('0x49')](_0x34ff5d,_0x2a8422);}constructor(_0x2840d0,_0xf3fed6){const _0x365e0c=_0x855b41;super(_0x2840d0),this[_0x365e0c('0x36')]=_0xf3fed6,this[_0x365e0c('0x0')]=null,this[_0x365e0c('0x1e')]=null,this[_0x365e0c('0x23')]=null,this[_0x365e0c('0x32')]=null;switch(_0xf3fed6){case'item':{this[_0x365e0c('0x0')]=Item['collection'],this[_0x365e0c('0x1e')]=_0x365e0c('0x2e'),this['_gameProp']='items',this[_0x365e0c('0x32')]='Item';break;}case _0x365e0c('0x59'):{this[_0x365e0c('0x0')]=Actor[_0x365e0c('0x5f')],this[_0x365e0c('0x1e')]='actors',this[_0x365e0c('0x23')]=_0x365e0c('0x1a'),this[_0x365e0c('0x32')]=_0x365e0c('0x60');break;}case _0x365e0c('0x22'):{this[_0x365e0c('0x0')]=JournalEntry[_0x365e0c('0x5f')],this['_sidebarTab']='journal',this[_0x365e0c('0x23')]=_0x365e0c('0x22'),this[_0x365e0c('0x32')]=_0x365e0c('0x58');break;}case'rolltable':{this[_0x365e0c('0x0')]=RollTable[_0x365e0c('0x5f')],this[_0x365e0c('0x1e')]=_0x365e0c('0x5c'),this[_0x365e0c('0x23')]='tables',this[_0x365e0c('0x32')]='RollTable';break;}default:throw new Error(_0x365e0c('0x51')+_0xf3fed6+'\x22');}}[_0x855b41('0x46')](){const _0x236e84=_0x855b41;return this[_0x236e84('0x0')][_0x236e84('0x3b')][_0x236e84('0x25')]((_0x8bc553,_0x2671f3)=>{const _0x2a43cb=_0x236e84,_0x17ae8c=UtilApplications[_0x2a43cb('0x15')](_0x8bc553,{'isAddTrailingSlash':!![]});return{'path':_0x17ae8c,'name':_0x8bc553[_0x2a43cb('0x13')],'displayName':''+(_0x17ae8c||'')+_0x8bc553[_0x2a43cb('0x13')],'id':_0x8bc553['id'],'type':MiscUtil[_0x2a43cb('0x5b')](_0x8bc553,'data',_0x2a43cb('0x3c'))||_0x2a43cb('0x2f'),'ix':_0x2671f3};})[_0x236e84('0x4e')](BaseCollectionTool[_0x236e84('0x49')]);}[_0x855b41('0x9')](){const _0x2c5856=_0x855b41,_0x19dc36=this[_0x2c5856('0x29')]['filterBox'][_0x2c5856('0x57')]();this['_list']['filter'](_0x1b9099=>this[_0x2c5856('0x29')]['toDisplay'](_0x19dc36,this[_0x2c5856('0x34')][_0x1b9099['ix']]));}[_0x855b41('0xf')](_0x3fad63){const _0x5cfc6e=_0x855b41;this[_0x5cfc6e('0x3a')]=_0x3fad63[_0x5cfc6e('0x43')](_0x5cfc6e('0xb'))['click'](()=>{const _0x3caf79=_0x5cfc6e;_0x3fad63['find'](_0x3caf79('0x5a'))[_0x3caf79('0xa')]('');if(this[_0x3caf79('0x5e')])this[_0x3caf79('0x5e')][_0x3caf79('0x18')]();});}[_0x855b41('0x5d')](_0x116991){const _0x5e6cdd=_0x855b41;return UtilList2[_0x5e6cdd('0x1b')](_0x116991);}['_activateListeners_doBindSelectAll'](_0x3df352){const _0x4a126c=_0x855b41;ListUiUtil[_0x4a126c('0xc')](_0x3df352,this[_0x4a126c('0x5e')]);}[_0x855b41('0x52')](_0xd2dce6){const _0x4c00cc=_0x855b41;return this[_0x4c00cc('0x35')]=_0xd2dce6[_0x4c00cc('0x43')](_0x4c00cc('0x5a')),this[_0x4c00cc('0x5e')]=new List({'$iptSearch':this[_0x4c00cc('0x35')],'$wrpList':_0xd2dce6[_0x4c00cc('0x43')](_0x4c00cc('0x27')),'fnSort':BaseCollectionTool[_0x4c00cc('0x47')]}),SortUtil['initBtnSortHandlers'](_0xd2dce6[_0x4c00cc('0x43')]('[data-name=\x22wrp-btns-sort\x22]'),this[_0x4c00cc('0x5e')]),this['_activateListeners_doBindSelectAll'](_0xd2dce6[_0x4c00cc('0x43')](_0x4c00cc('0x28'))),this[_0x4c00cc('0x29')][_0x4c00cc('0x44')]({'$iptSearch':this[_0x4c00cc('0x35')],'$btnReset':this[_0x4c00cc('0x3a')],'$btnOpen':_0xd2dce6[_0x4c00cc('0x43')](_0x4c00cc('0x17')),'$btnToggleSummaryHidden':_0xd2dce6[_0x4c00cc('0x43')](_0x4c00cc('0x40')),'$wrpMiniPills':_0xd2dce6['find']('.fltr__mini-view'),'namespace':_0x4c00cc('0x41')+this['_collectionName']})[_0x4c00cc('0x11')](()=>{const _0x4988fb=_0x4c00cc;this[_0x4988fb('0x34')][_0x4988fb('0xd')](_0x4b6fc1=>this[_0x4988fb('0x29')][_0x4988fb('0x2a')](_0x4b6fc1)),this['_list'][_0x4988fb('0x21')](this[_0x4988fb('0x34')],{'fnGetName':_0x1da76c=>_0x1da76c[_0x4988fb('0x13')],'fnGetValues':_0x49b1fa=>({'id':_0x49b1fa['id'],'path':_0x49b1fa[_0x4988fb('0x4d')]}),'fnGetData':this[_0x4988fb('0x5d')][_0x4988fb('0x1f')](this),'fnBindListeners':_0x96bbb4=>UtilList2[_0x4988fb('0x30')](this[_0x4988fb('0x5e')],_0x96bbb4)}),this[_0x4988fb('0x5e')]['init'](),this[_0x4988fb('0x29')][_0x4988fb('0x38')]['render'](),$(this[_0x4988fb('0x29')][_0x4988fb('0x38')])['on'](FilterBox[_0x4988fb('0x7')],this[_0x4988fb('0x9')][_0x4988fb('0x1f')](this)),this[_0x4988fb('0x9')]();});}[_0x855b41('0x3d')](){const _0x4bfbcf=_0x855b41;return this[_0x4bfbcf('0x5e')][_0x4bfbcf('0x2e')][_0x4bfbcf('0x42')](_0x24ad7f=>$(_0x24ad7f[_0x4bfbcf('0x8')])[_0x4bfbcf('0x43')]('input')[_0x4bfbcf('0x4')]('checked'))[_0x4bfbcf('0x25')](_0xafcd43=>({'name':_0xafcd43[_0x4bfbcf('0x13')],'id':_0xafcd43[_0x4bfbcf('0x39')]['id']}));}['_activateListeners_initBtnPrune'](_0x1cb91e){const _0x3965a2=_0x855b41;_0x1cb91e[_0x3965a2('0x43')](_0x3965a2('0x1c'))['click'](async()=>{const _0x5a3e6c=_0x3965a2,_0x532261=await UtilApplications[_0x5a3e6c('0x4a')]({'title':_0x5a3e6c('0x56'),'content':'<h3>Are\x20you\x20sure?</h3><p>Any\x20empty\x20folders\x20will\x20be\x20permanently\x20deleted.</p>','confirmText':_0x5a3e6c('0x5'),'faIcon':_0x5a3e6c('0x4c')});if(!_0x532261)return;await this[_0x5a3e6c('0x6')]();});}async[_0x855b41('0x2b')](_0x2d46e6){const _0x517a8c=_0x855b41;if(!this['_list'])return;let _0x38b7b1=this[_0x517a8c('0x3d')]();if(!_0x38b7b1[_0x517a8c('0x54')])return ui[_0x517a8c('0x3f')][_0x517a8c('0xe')](_0x517a8c('0x14'));const _0x323b77=this[_0x517a8c('0x36')]['uppercaseFirst'](),_0x2c0466=_0x38b7b1[_0x517a8c('0x54')]!==0x1?'s':'',_0x3f58c5=await UtilApplications['pGetConfirmation']({'title':_0x517a8c('0x2')+_0x323b77+_0x2c0466,'content':_0x517a8c('0x19')+_0x38b7b1[_0x517a8c('0x54')]+'\x20'+_0x323b77+_0x2c0466+_0x517a8c('0x4f')+(_0x2c0466?_0x517a8c('0x37'):_0x517a8c('0x4b'))+_0x517a8c('0x55'),'confirmText':'Delete','faIcon':_0x517a8c('0x4c')});if(!_0x3f58c5)return;this['close'](),ui[_0x517a8c('0x10')]['activateTab'](this[_0x517a8c('0x1e')]);if(_0x2d46e6[_0x517a8c('0x4')](_0x517a8c('0x3'))){const _0x47b78b=await this[_0x517a8c('0x6')](_0x38b7b1['map'](({id:_0x9237fa})=>_0x9237fa));_0x38b7b1=_0x38b7b1[_0x517a8c('0x42')](({id:_0x56ab1e})=>!_0x47b78b[_0x517a8c('0x1')](_0x56ab1e));}const _0x5bb457=_0x38b7b1[_0x517a8c('0x25')](({id:_0x5d7012,name:_0x49d95e})=>new Util[(_0x517a8c('0x3e'))](_0x49d95e,()=>this[_0x517a8c('0x2c')](_0x5d7012)));await UtilApplications[_0x517a8c('0x33')](_0x5bb457,{'titleInitial':_0x517a8c('0x45'),'titleComplete':_0x517a8c('0x24'),'fnGetRowRunningText':_0x2bbc45=>_0x517a8c('0x61')+_0x2bbc45+'...','fnGetRowSuccessText':_0x58761f=>_0x517a8c('0x31')+_0x58761f+'.','fnGetRowErrorText':_0x4e4a08=>_0x517a8c('0x12')+_0x4e4a08+'!\x20'+VeCt['STR_SEE_CONSOLE']});if(_0x2d46e6[_0x517a8c('0x4')](_0x517a8c('0x3')))await this[_0x517a8c('0x6')]();game[this[_0x517a8c('0x23')]][_0x517a8c('0x50')]();}async[_0x855b41('0x2c')](_0xef040){const _0x2bc30b=_0x855b41;await this[_0x2bc30b('0x0')][_0x2bc30b('0x5b')](_0xef040)[_0x2bc30b('0x2d')]();}async[_0x855b41('0x6')](_0x535830){const _0x392e8d=_0x855b41,_0x150102=()=>Folder[_0x392e8d('0x5f')]['entities'][_0x392e8d('0x42')](_0x494ae3=>_0x494ae3[_0x392e8d('0x16')][_0x392e8d('0x3c')]===this[_0x392e8d('0x32')]),_0x1a715d=_0x535830?new Set(_0x535830):null,_0x44d829=new Set();let _0x3be56e=0x0,_0x22f122=null,_0x154e72=_0x150102()[_0x392e8d('0x54')];do{let _0x3ea92a;_0x1a715d?_0x3ea92a=_0x150102()['filter'](_0xa8a52=>{const _0x275df5=_0x392e8d;if(!_0xa8a52[_0x275df5('0x26')]||!_0xa8a52['children'][_0x275df5('0x54')]){if(!_0xa8a52[_0x275df5('0x1d')][_0x275df5('0x54')])return!![];const _0x566cd1=_0xa8a52[_0x275df5('0x1d')][_0x275df5('0x25')](_0x1bffbe=>_0x1bffbe['id'])[_0x275df5('0x42')](_0x504055=>_0x1a715d[_0x275df5('0x1')](_0x504055));if(_0x566cd1['length']===_0xa8a52[_0x275df5('0x1d')][_0x275df5('0x54')])return _0x566cd1['forEach'](_0x34c0d4=>_0x44d829['add'](_0x34c0d4)),!![];}return![];}):_0x3ea92a=_0x150102()['filter'](_0x407054=>!_0x407054[_0x392e8d('0x1d')][_0x392e8d('0x54')]&&(!_0x407054[_0x392e8d('0x26')]||!_0x407054['children'][_0x392e8d('0x54')]));for(const _0x1c072e of _0x3ea92a){await _0x1c072e[_0x392e8d('0x2d')]({'deleteSubfolders':!![],'deleteContents':!![]}),_0x3be56e++;}_0x22f122=_0x154e72,_0x154e72=_0x150102()[_0x392e8d('0x54')];}while(_0x154e72!==_0x22f122);if(_0x3be56e)ui[_0x392e8d('0x3f')][_0x392e8d('0x48')](_0x392e8d('0x31')+_0x3be56e+_0x392e8d('0x53')+(_0x3be56e===0x1?'':'s')+'.');return _0x44d829;}}export{BaseCollectionTool};
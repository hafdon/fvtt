const _0x4f85=['.cfg__btn-open-alt','animate','renderCompendiumDirectory','insertAfter','object','addClass','init','button[data-action=\x22configure\x22]','target','Plutonium\x20','pHandleButtonClick','trim','cacheMethod','isHidePlutoniumDirectoryButtons','map','_controlled','renderSettings','dir__btn-header','add','slideDown','user','settings','Could\x20not\x20determine\x20z-index\x20for\x20app\x20','_onEscape','windows','</button>','#compendium','getCachedMethod','$getDirButton','_handleConfigUpdate','appId','releaseAll','renderItemDirectory','duration','hasFocus','css','<button\x20class=\x22ui__btn-open-menu\x22><i\x20class=\x22fas\x20fa-bars\x22></i>\x20Open\x20Main\x20Menu</button>','nodeName','prototype','sight','TEXTAREA','blur','ready','plutonium.configUpdate','context','restoreCachedMethod','_handleConfigUpdate_handleFastAnimations','_doRenderSettings_addPlayerConfigButton','renderJournalDirectory','length','appendTo','span','filter','.directory-footer','each','.dir__wrp-footer','remove','get','preventDefault','isFixEscapeKey','sort','ascSort','getCoreVersion','isEscapeable','_MODAL_STACK','entries','z-index','find','has','isStreamerMode','toggle','_init_addDirectoryWrapper','click','.compendium-footer','isGM','activeLayer','isZeroSix','zIndex','text','.ui__wrp-player-settings','SRD\x20Module','MODULE_NAME','.ui__btn-open-menu','keys','INPUT','\x20(Expanded\x20SRD)','menu','_init_addCompendiumObfuscation','style','_ELEMENTS_WITH_FOCUS','saveFog','.dir__wrp-header','keyboard','element','_doRenderSettings_handleConfigFixEscapeKey','_doRenderSettings_handleConfigHidePlutoniumDirectoryButtons','closeAllMenus','call','.header-actions'];(function(_0x560233,_0x4f8590){const _0xf1f8b4=function(_0x229181){while(--_0x229181){_0x560233['push'](_0x560233['shift']());}};_0xf1f8b4(++_0x4f8590);}(_0x4f85,0x162));const _0xf1f8=function(_0x560233,_0x4f8590){_0x560233=_0x560233-0x0;let _0xf1f8b4=_0x4f85[_0x560233];return _0xf1f8b4;};const _0x3392d2=_0xf1f8;'use strict';import{Config}from'./Config.js';import{ChooseImporter}from'./ChooseImporter.js';import{MenuCollectionTools}from'./MenuCollectionTools.js';import{SharedConsts}from'../shared/SharedConsts.js';import{UtilPatch}from'./UtilPatch.js';import{Menu}from'./Menu.js';class UtilUi{static[_0x3392d2('0x30')](){const _0x59fbad=_0x3392d2;game[_0x59fbad('0x3e')]['isGM']&&(UtilUi[_0x59fbad('0xe')]('renderActorDirectory'),UtilUi['_init_addDirectoryWrapper'](_0x59fbad('0x4a')),UtilUi[_0x59fbad('0xe')](_0x59fbad('0x5a')),UtilUi[_0x59fbad('0xe')]('renderRollTableDirectory')),UtilUi['_init_addCompendiumObfuscation'](),Hooks['on'](_0x59fbad('0x55'),()=>this[_0x59fbad('0x47')]()),this[_0x59fbad('0x47')]();}static[_0x3392d2('0x1e')](){const _0x27e3f4=_0x3392d2,_0x229181='('+SharedConsts[_0x27e3f4('0x18')]+')';Hooks['on'](_0x27e3f4('0x2c'),()=>{const _0x499b14=_0x27e3f4;if(!Config['get']('ui',_0x499b14('0xc')))return;$(_0x499b14('0x44'))[_0x499b14('0xa')](_0x499b14('0x10'))[_0x499b14('0x60')]((_0x22afb6,_0x50435e)=>{const _0x49ab7a=_0x499b14;$(_0x50435e)[_0x49ab7a('0xa')](_0x49ab7a('0x5d'))[_0x49ab7a('0x5e')]((_0x488bf1,_0x43f71f)=>$(_0x43f71f)['text']()[_0x49ab7a('0x35')]()===_0x229181)[_0x49ab7a('0x15')](_0x49ab7a('0x1c'));});});}static['_init_addDirectoryWrapper'](_0x7dba81){const _0x2a4825=_0x3392d2;Config[_0x2a4825('0x5')]()[_0x2a4825('0x13')]?Hooks['on'](_0x7dba81,(_0x30d0a4,_0x328cd3)=>{const _0x155078=_0x2a4825;_0x328cd3['find'](_0x155078('0x61'))[_0x155078('0x62')](),$$`<div class="flex-col dir__wrp-footer w-100 no-shrink min-w-100">
					<hr class="w-100 m-1">
					<div class="flex w-100">
						${ChooseImporter[_0x155078('0x46')](_0x7dba81)}
						${MenuCollectionTools[_0x155078('0x46')](_0x7dba81)}
						${Config[_0x155078('0x46')]()}
					</div>
				</div>`['appendTo'](_0x328cd3[_0x155078('0xa')](_0x155078('0x5f')));}):Hooks['on'](_0x7dba81,(_0x21549d,_0x4da6c1)=>{const _0x5cdfd5=_0x2a4825;_0x4da6c1['find'](_0x5cdfd5('0x22'))['remove'](),$$`<div class="flex-col dir__wrp-header w-100 no-shrink min-w-100 dir__control-header">
					<div class="flex w-100">
						${ChooseImporter['$getDirButton'](_0x7dba81)[_0x5cdfd5('0x2f')](_0x5cdfd5('0x3b'))}
						${MenuCollectionTools['$getDirButton'](_0x7dba81)['addClass']('dir__btn-header')}
						${Config['$getDirButton']()[_0x5cdfd5('0x2f')](_0x5cdfd5('0x3b'))}
					</div>
				</div>`[_0x5cdfd5('0x2d')](_0x4da6c1[_0x5cdfd5('0xa')](_0x5cdfd5('0x29'))),MenuCollectionTools['$getDirButton'](_0x7dba81)[_0x5cdfd5('0x2f')]('dir__btn-header\x20dir__control-header--alt')[_0x5cdfd5('0x4d')]({'maxWidth':0x1c})[_0x5cdfd5('0x5c')](_0x4da6c1[_0x5cdfd5('0xa')]('.action-buttons'));}),Hooks['on'](_0x2a4825('0x3a'),(_0x2a7ea2,_0x14397b)=>{this['_doRenderSettings_handleConfigFixEscapeKey'](_0x2a7ea2,_0x14397b),this['_doRenderSettings_handleConfigHidePlutoniumDirectoryButtons'](_0x2a7ea2,_0x14397b),this['_doRenderSettings_addPlayerConfigButton'](_0x2a7ea2,_0x14397b);});}static[_0x3392d2('0x47')](){const _0x5de429=_0x3392d2;this[_0x5de429('0x58')](),this['_handleConfigUpdate_handleFixEscapeKey']();}static[_0x3392d2('0x58')](){const _0x2af46c=_0x3392d2;UtilPatch[_0x2af46c('0x36')]($[_0x2af46c('0x50')],'animate');if(!Config[_0x2af46c('0x0')]('ui','isFastAnimations')){UtilPatch[_0x2af46c('0x57')]($[_0x2af46c('0x50')],_0x2af46c('0x2b'));return;}$[_0x2af46c('0x50')][_0x2af46c('0x2b')]=function(..._0x15e069){const _0x350676=_0x2af46c,_0xd78ee4=[..._0x15e069];for(let _0x37dee5=0x0;_0x37dee5<_0xd78ee4[_0x350676('0x5b')];++_0x37dee5){const _0x286e4c=_0xd78ee4[_0x37dee5];if(typeof _0x286e4c===_0x350676('0x2e')&&_0x286e4c[_0x350676('0x4b')]!=null){if(_0x286e4c['duration']>0x21)_0x286e4c[_0x350676('0x4b')]=0x21;break;}else{if(typeof _0x286e4c==='number'){if(_0x286e4c>0x21)_0xd78ee4[_0x37dee5]=0x21;break;}}}const _0x306aa5=UtilPatch[_0x350676('0x45')]($[_0x350676('0x50')],_0x350676('0x2b'));_0x306aa5[_0x350676('0x28')](this,..._0xd78ee4);};}static['_handleConfigUpdate_handleFixEscapeKey'](){const _0x56c124=_0x3392d2;ui[_0x56c124('0x3f')]['render'](),UtilPatch[_0x56c124('0x36')](game[_0x56c124('0x23')],_0x56c124('0x41'),{'isBind':!![]});if(!Config[_0x56c124('0x0')]('ui',_0x56c124('0x2'))){game[_0x56c124('0x23')][_0x56c124('0x41')]=function(_0xeeed5c,_0x4c2a3b,_0x4d7158){const _0x3356d5=_0x56c124;if(UiUtil['_MODAL_STACK']&&UiUtil[_0x3356d5('0x7')]['length'])return;UtilPatch[_0x3356d5('0x45')](game[_0x3356d5('0x23')],_0x3356d5('0x41'))(_0xeeed5c,_0x4c2a3b,_0x4d7158);};return;}game[_0x56c124('0x23')][_0x56c124('0x41')]=function(_0x591fc1,_0x629699,_0x475e0c){const _0x2bdeb7=_0x56c124;if(UiUtil[_0x2bdeb7('0x7')]&&UiUtil[_0x2bdeb7('0x7')]['length'])return;if(_0x629699)return;if(_0x475e0c[_0x2bdeb7('0x4c')]&&UtilUi[_0x2bdeb7('0x20')][_0x2bdeb7('0xb')](_0x591fc1['target'][_0x2bdeb7('0x4f')])){_0x591fc1[_0x2bdeb7('0x32')][_0x2bdeb7('0x53')]();return;}if(canvas[_0x2bdeb7('0x54')])canvas[_0x2bdeb7('0x51')][_0x2bdeb7('0x21')]();if(ui['context']&&ui[_0x2bdeb7('0x56')][_0x2bdeb7('0x1d')][_0x2bdeb7('0x5b')])ui[_0x2bdeb7('0x56')]['close']();else{if(Menu[_0x2bdeb7('0x27')]())return;else{if(canvas[_0x2bdeb7('0x54')]&&Object[_0x2bdeb7('0x1a')](canvas[_0x2bdeb7('0x12')][_0x2bdeb7('0x39')])['length'])_0x591fc1[_0x2bdeb7('0x1')](),canvas[_0x2bdeb7('0x12')][_0x2bdeb7('0x49')]();else{if(Object['values'](ui[_0x2bdeb7('0x42')])[_0x2bdeb7('0x5e')](_0x3059e5=>_0x3059e5[_0x2bdeb7('0x6')]==null||_0x3059e5['isEscapeable']===!![])[_0x2bdeb7('0x5b')]){const _0x5d620c=Object[_0x2bdeb7('0x8')](ui[_0x2bdeb7('0x42')])[_0x2bdeb7('0x5e')](([_0x26df0b,_0x8239d5])=>_0x8239d5[_0x2bdeb7('0x6')]==null||_0x8239d5[_0x2bdeb7('0x6')]===!![])[_0x2bdeb7('0x38')](([_0x24309d,_0x1b69e6])=>{const _0x4521a5=_0x2bdeb7,_0x16c4ea=Number(((_0x1b69e6[_0x4521a5('0x24')][0x0]||{})[_0x4521a5('0x1f')]||{})[_0x4521a5('0x9')]||-0x1);if(isNaN(_0x16c4ea)||!~_0x16c4ea)console['warn'](_0x4521a5('0x40')+_0x24309d);return{'appId':_0x24309d,'zIndex':isNaN(_0x16c4ea)?-0x1:_0x16c4ea};})[_0x2bdeb7('0x3')]((_0x4de82c,_0x9b0240)=>SortUtil[_0x2bdeb7('0x4')](_0x9b0240[_0x2bdeb7('0x14')],_0x4de82c[_0x2bdeb7('0x14')]));ui[_0x2bdeb7('0x42')][_0x5d620c[0x0][_0x2bdeb7('0x48')]]['close']();}else ui[_0x2bdeb7('0x1d')][_0x2bdeb7('0xd')]();}}}this['_handled'][_0x2bdeb7('0x3c')](_0x475e0c['key']);};}static[_0x3392d2('0x25')](_0x54c4ec,_0xe4a9e){const _0x3d491c=_0x3392d2;if(!Config[_0x3d491c('0x0')]('ui',_0x3d491c('0x2')))return _0xe4a9e[_0x3d491c('0xa')](_0x3d491c('0x19'))['remove']();if(_0xe4a9e[_0x3d491c('0xa')]('.ui__btn-open-menu')[_0x3d491c('0x5b')])return;$(_0x3d491c('0x4e'))[_0x3d491c('0xf')](()=>{const _0x372e4b=_0x3d491c,_0xcf44de=ui[_0x372e4b('0x1d')][_0x372e4b('0x24')];if(!_0xcf44de['length'])ui['menu']['render'](!![]);else _0xcf44de[_0x372e4b('0x3d')](0x96);})['insertBefore'](_0xe4a9e[_0x3d491c('0xa')](_0x3d491c('0x31')));}static[_0x3392d2('0x26')](_0x22cdea,_0x10a7a4){const _0x45d103=_0x3392d2;if(!Config[_0x45d103('0x0')]('ui',_0x45d103('0x37')))return _0x10a7a4[_0x45d103('0xa')](_0x45d103('0x2a'))['remove']();if(_0x10a7a4[_0x45d103('0xa')](_0x45d103('0x2a'))['length'])return;Config['$getDirButton']({'isGameSettingsButton':!![]})['insertAfter'](_0x10a7a4[_0x45d103('0xa')]('button[data-action=\x22configure\x22]'));}static[_0x3392d2('0x59')](_0x4dcc9b,_0x4022e8){const _0x383359=_0x3392d2;if(game['user'][_0x383359('0x11')])return;if(_0x4022e8[_0x383359('0xa')](_0x383359('0x16'))[_0x383359('0x5b')])return;const _0x59ea45=$('<button><i\x20class=\x22fas\x20fa-cogs\x22></i>\x20Configure\x20'+(Config[_0x383359('0x0')]('ui',_0x383359('0xc'))?_0x383359('0x17'):_0x383359('0x33'))+_0x383359('0x43'))['click'](_0x216f4d=>Config[_0x383359('0x34')](_0x216f4d));$$`<div class="ui__wrp-player-settings">${_0x59ea45}</div>`['insertAfter'](_0x4022e8['find']('.game-system'));}}UtilUi['_ELEMENTS_WITH_FOCUS']=new Set([_0x3392d2('0x1b'),_0x3392d2('0x52')]);export{UtilUi};
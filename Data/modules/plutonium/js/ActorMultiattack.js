const _0x156f=['push','deepEquals','includes','items','slice','TERMS_COUNT','error','item','multiattack','endsWith','test','trim','map','_getActionByLowerName','rwak','type','text','replace','with','fake','Failed\x20to\x20evaluate\x20damage\x20part\x20\x22','TITLE_LOWER_WORDS','isPunctuation','actor','ranged','\x22></div>','abilityMod','and','max','mwak','undefined','simpleR','betterrolls5e','userId','isAutoMultiattack','_pHandleCreateChatMessage_handleMeleeRangedAttacks','settings','find','attr','tokens','get','actionType','value','_pHandleCreateChatMessage_mutExtractSimpleAttacks','lang','isCapsFirst','thr','evl','speaker','description','content','melee','forEach','length','data','getWithoutParens','meanDamage','getTree3','abilities','ascSort','sheet','properties','toLowerCase','altKey','<div\x20class=\x22item\x22\x20data-item-id=\x22','last','_pHandleCreateChatMessage','toMessage','join','_pHandleCreateChatMessage_mutExtractNamedActions','getTokens','avg(','collection','sort','damage','filter','pop','shift','shiftKey','textToNumber','createChatMessage','count','name','reduce','ctrlKey','simpleM'];(function(_0x501d7e,_0x156fc3){const _0x4cf2f1=function(_0x2dfe9c){while(--_0x2dfe9c){_0x501d7e['push'](_0x501d7e['shift']());}};_0x4cf2f1(++_0x156fc3);}(_0x156f,0x1b4));const _0x4cf2=function(_0x501d7e,_0x156fc3){_0x501d7e=_0x501d7e-0x0;let _0x4cf2f1=_0x156f[_0x501d7e];return _0x4cf2f1;};import{Config}from'./Config.js';import{LGT,Util}from'./Util.js';import{Consts}from'./Consts.js';class ActorMultiattack{static['init'](){Hooks['on'](_0x4cf2('0x4a'),(_0x1832c4,_0x21a6b5,_0x59faff)=>{this[_0x4cf2('0x3c')](_0x1832c4,_0x21a6b5,_0x59faff);});}static async['_pHandleCreateChatMessage'](_0x21863d,_0x218066,_0x2c6fbe){if(!Config[_0x4cf2('0x22')](_0x4cf2('0x11'),_0x4cf2('0x1c')))return;if(_0x2c6fbe!==game[_0x4cf2('0x1b')])return;const _0x8a9c21=MiscUtil[_0x4cf2('0x22')](_0x21863d,_0x4cf2('0x30'),_0x4cf2('0x2a'),_0x4cf2('0x11'));if(!_0x8a9c21)return;const _0x558bc9=Actor[_0x4cf2('0x42')]['get'](_0x8a9c21);if(!_0x558bc9)return;const _0x5de003=$(_0x21863d[_0x4cf2('0x30')][_0x4cf2('0x2c')]||'')[_0x4cf2('0x20')]('data-item-id');if(!_0x5de003)return;const _0x37cd51=_0x558bc9['items']['get'](_0x5de003),_0x36f9bc=Util[_0x4cf2('0x31')](_0x37cd51[_0x4cf2('0x4c')])[_0x4cf2('0x38')]();if(_0x36f9bc!==_0x4cf2('0x2'))return;const _0x16c4be=$(_0x37cd51[_0x4cf2('0x30')][_0x4cf2('0x30')]['description']['value'])[_0x4cf2('0xa')]()['trim']();if(!_0x16c4be)return;const _0xe312e0=_0x16c4be['split'](/[.?!]/g)[_0x4cf2('0x6')](_0x3b2c00=>_0x3b2c00[_0x4cf2('0x5')]())[_0x4cf2('0x45')](Boolean),_0x1d48e6=[];this[_0x4cf2('0x3f')](_0x558bc9,_0xe312e0,_0x1d48e6),this[_0x4cf2('0x25')](_0x558bc9,_0xe312e0,_0x1d48e6);for(const _0x54074f of _0x1d48e6){for(let _0xdcbe51=0x0;_0xdcbe51<_0x54074f['count'];++_0xdcbe51){const _0x2df86d={'preventDefault':()=>{},'stopPropagation':()=>{},'currentTarget':$(_0x4cf2('0x3a')+_0x54074f[_0x4cf2('0x1')]['_id']+_0x4cf2('0x13'))[0x0]};if(typeof BetterRolls!==_0x4cf2('0x18')){const _0x5d4268=new Event(_0x4cf2('0xd'));_0x5d4268[_0x4cf2('0x4e')]=![],_0x5d4268[_0x4cf2('0x48')]=![],_0x5d4268[_0x4cf2('0x39')]=![];const _0x3b5482={'adv':0x0,'disadv':0x0,'event':_0x5d4268};!game[_0x4cf2('0x1e')]['get'](_0x4cf2('0x1a'),'imageButtonEnabled')?_0x54074f[_0x4cf2('0x1')][_0x4cf2('0x11')][_0x4cf2('0x36')]['_onItemRoll'](_0x2df86d):await BetterRolls['rollItem'](_0x54074f['item'],mergeObject(_0x3b5482,{'preset':0x0}))[_0x4cf2('0x3d')]();}else await _0x54074f[_0x4cf2('0x1')]['actor'][_0x4cf2('0x36')]['_onItemRoll'](_0x2df86d);}}}static[_0x4cf2('0x3f')](_0x5c168c,_0x3b448f,_0x47fdbc){_0x3b448f[_0x4cf2('0x2e')](_0x4ac3f7=>{let _0x4bb3bf=Util[_0x4cf2('0x40')](_0x4ac3f7);while((Util['isPunctuation'](_0x4bb3bf[0x0])||Util[_0x4cf2('0x27')](_0x4bb3bf[0x0]))&&_0x4bb3bf[_0x4cf2('0x2f')])_0x4bb3bf[_0x4cf2('0x47')]();_0x4bb3bf=_0x4bb3bf[_0x4cf2('0x6')](_0x104571=>_0x104571[_0x4cf2('0x5')]())[_0x4cf2('0x45')](Boolean);const _0xdc9916=[];let _0x5a8deb=[],_0x187c08={};const _0x118ea4=()=>{if(!_0x5a8deb[_0x4cf2('0x2f')])return;while(_0x5a8deb[_0x4cf2('0x2f')]){if(StrUtil['TITLE_LOWER_WORDS'][_0x4cf2('0x52')](_0x5a8deb[_0x4cf2('0x3b')]()))_0x5a8deb[_0x4cf2('0x46')]();else break;}_0xdc9916['push']({'name':_0x5a8deb[_0x4cf2('0x3e')]('\x20'),'count':_0x187c08[_0x4cf2('0x4b')]||0x1}),_0x5a8deb=[],_0x187c08={};};for(let _0x52a5e2=0x0;_0x52a5e2<_0x4bb3bf[_0x4cf2('0x2f')];++_0x52a5e2){const _0x35a09b=_0x4bb3bf[_0x52a5e2];if(Util[_0x4cf2('0x27')](_0x35a09b))_0x5a8deb[_0x4cf2('0x50')](_0x35a09b);else{if(_0x5a8deb['length']&&StrUtil[_0x4cf2('0xf')]['includes'](_0x35a09b))_0x5a8deb[_0x4cf2('0x50')](_0x35a09b);else{const _0x54640d=Consts[_0x4cf2('0x55')]['find'](_0x34a170=>{const _0x25a26e=_0x4bb3bf['slice'](_0x52a5e2,_0x52a5e2+_0x34a170[_0x4cf2('0x21')][_0x4cf2('0x2f')]);return CollectionUtil[_0x4cf2('0x51')](_0x34a170[_0x4cf2('0x21')],_0x25a26e);});_0x5a8deb[_0x4cf2('0x2f')]&&_0x54640d&&(_0x52a5e2+=_0x54640d[_0x4cf2('0x21')][_0x4cf2('0x2f')]-0x1,_0x187c08[_0x4cf2('0x4b')]=_0x54640d[_0x4cf2('0x4b')]),_0x118ea4();}}}_0x118ea4(),_0xdc9916['forEach'](_0x59763b=>{const _0x5e0d76=_0x59763b[_0x4cf2('0x4c')][_0x4cf2('0x38')]()['trim'](),_0x359302=_0x5c168c['items']['find'](_0x310833=>Util[_0x4cf2('0x31')](_0x310833[_0x4cf2('0x4c')])[_0x4cf2('0x38')]()===_0x5e0d76);if(!_0x359302)return;_0x47fdbc[_0x4cf2('0x50')]({'item':_0x359302,'count':_0x59763b[_0x4cf2('0x4b')]||0x1});});});}static[_0x4cf2('0x25')](_0x501b49,_0x2847ef,_0x170376){_0x2847ef['forEach'](_0x4baeea=>{_0x4baeea=_0x4baeea['replace'](/(two|three|four|five|six|seven|eight) (.*?) attacks/gi,(..._0x32ec54)=>{const _0x188fd0=_0x32ec54[0x1]['toLowerCase'](),_0x1dd965=Parser[_0x4cf2('0x49')](_0x188fd0),_0x36598d=Util['getWithoutParens'](_0x32ec54[0x2])[_0x4cf2('0x38')]();if(_0x36598d==='melee'||_0x36598d===_0x4cf2('0x12'))return this[_0x4cf2('0x1d')](_0x501b49,_0x36598d,_0x1dd965,_0x170376),'';const _0x4cb312=_0x501b49[_0x4cf2('0x53')]['find'](_0x27960a=>Util[_0x4cf2('0x31')](_0x27960a[_0x4cf2('0x4c')])[_0x4cf2('0x38')]()===_0x36598d);if(!_0x4cb312)return _0x32ec54[0x0];return _0x170376['push']({'item':_0x4cb312,'count':_0x1dd965}),'';}),_0x4baeea=_0x4baeea[_0x4cf2('0xb')](/makes (two|three|four|five|six|seven|eight) attacks with its (.*? or .*?)$/gi,(..._0x1b4ef6)=>{const _0x30a5d0=_0x1b4ef6[0x1];let _0x1a7dcc=_0x1b4ef6[0x2];const _0x98ab54=Util[_0x4cf2('0x40')](_0x1a7dcc);while(_0x98ab54[_0x4cf2('0x2f')]){const _0x2179ac=[];for(let _0x453590=0x0;_0x453590<_0x98ab54[_0x4cf2('0x2f')];++_0x453590){const _0x43f803=_0x98ab54[_0x453590]['toLowerCase']();if(_0x43f803==='and'||_0x43f803==='or'||_0x43f803==='its'||_0x43f803===_0x4cf2('0xc')||Util[_0x4cf2('0x10')](_0x43f803)){_0x98ab54[_0x4cf2('0x47')]();break;}else _0x2179ac[_0x4cf2('0x50')](_0x98ab54[_0x4cf2('0x47')]()),_0x453590--;}if(_0x2179ac[_0x4cf2('0x2f')]){const _0x5e3e76=_0x2179ac['join']('')[_0x4cf2('0x5')](),_0x219c8a=this[_0x4cf2('0x7')](_0x501b49,_0x5e3e76);_0x219c8a&&_0x170376['push']({'item':_0x219c8a,'count':Parser[_0x4cf2('0x49')](_0x30a5d0)});}}return _0x98ab54[_0x4cf2('0x3e')]('')[_0x4cf2('0x5')]();}),_0x4baeea=_0x4baeea['replace'](/makes (?:two|three|four|five|six|seven|eight) attacks:(.*?)$/gi,(..._0x335bbd)=>{let _0x44b071=_0x335bbd[0x1],_0x22ee76=![],_0x1431d2=null;while(_0x44b071[_0x4cf2('0x2f')]&&_0x44b071!==_0x1431d2){_0x1431d2=_0x44b071,_0x44b071=_0x44b071[_0x4cf2('0xb')](/(one|two|three|four|five|six|seven|eight) with (?:its |his |her )(.*)/gi,(..._0x48f0b7)=>{const _0x1d38c4=_0x48f0b7[0x1],_0x5f0791=_0x48f0b7[0x2],_0x2edeb8=[],_0x20f3cd=Util['getTokens'](_0x5f0791);for(let _0x480cdb=0x0;_0x480cdb<_0x20f3cd[_0x4cf2('0x2f')];++_0x480cdb){const _0x2f180c=_0x20f3cd[_0x480cdb]['toLowerCase']();if(_0x2f180c===_0x4cf2('0x15')||_0x2f180c==='or'||Util[_0x4cf2('0x10')](_0x2f180c)){_0x20f3cd['shift']();break;}else _0x2edeb8['push'](_0x20f3cd[_0x4cf2('0x47')]()),_0x480cdb--;}if(_0x2edeb8[_0x4cf2('0x2f')]){const _0x145e94=_0x2edeb8[_0x4cf2('0x3e')]('')['trim'](),_0xbe239a=this['_getActionByLowerName'](_0x501b49,_0x145e94);_0xbe239a&&_0x170376['push']({'item':_0xbe239a,'count':Parser[_0x4cf2('0x49')](_0x1d38c4)});}return _0x20f3cd[_0x4cf2('0x3e')]('')[_0x4cf2('0x5')]();});}if(_0x22ee76)return'';return _0x335bbd[0x0];});});}static[_0x4cf2('0x1d')](_0x1029ae,_0x3a465e,_0x22ee53,_0xa3398f){let _0x50b150;const _0xc571bb=[],_0x350f9b=[];_0x1029ae[_0x4cf2('0x53')][_0x4cf2('0x45')](_0x4d9baf=>_0x4d9baf[_0x4cf2('0x9')]==='weapon')['forEach'](_0x84b432=>{const _0x5f2847=MiscUtil['get'](_0x84b432,_0x4cf2('0x30'),'data');if(!_0x5f2847)return;const _0x4d0280=MiscUtil[_0x4cf2('0x22')](_0x5f2847,'weaponType');switch(_0x4d0280){case _0x4cf2('0x4f'):case'martialM':{_0xc571bb['push'](_0x84b432);if(MiscUtil['get'](_0x5f2847,_0x4cf2('0x37'),_0x4cf2('0x28')))_0x350f9b[_0x4cf2('0x50')](_0x84b432);return;}case _0x4cf2('0x19'):case'martialR':{_0x350f9b[_0x4cf2('0x50')](_0x84b432);return;}}const _0x9ebd50=MiscUtil[_0x4cf2('0x22')](_0x5f2847,_0x4cf2('0x23'));switch(_0x9ebd50){case _0x4cf2('0x17'):{_0xc571bb[_0x4cf2('0x50')](_0x84b432);if(MiscUtil[_0x4cf2('0x22')](_0x5f2847,_0x4cf2('0x37'),_0x4cf2('0x28')))_0x350f9b[_0x4cf2('0x50')](_0x84b432);return;}case _0x4cf2('0x8'):{_0x350f9b[_0x4cf2('0x50')](_0x84b432);return;}}const _0x42378e=(MiscUtil['get'](_0x5f2847,_0x4cf2('0x2b'),'value')||'')[_0x4cf2('0xb')](/[^a-zA-Z0-9:.,()]/g,'')['replace'](/\s+/g,'\x20')[_0x4cf2('0x5')]();if(/melee or ranged weapon attack:/i[_0x4cf2('0x4')](_0x42378e))_0xc571bb[_0x4cf2('0x50')](_0x84b432),_0x350f9b['push'](_0x84b432);else{if(/melee weapon attack:/i[_0x4cf2('0x4')](_0x42378e))_0xc571bb[_0x4cf2('0x50')](_0x84b432);else/ranged weapon attack:/i[_0x4cf2('0x4')](_0x42378e)&&_0x350f9b['push'](_0x84b432);}});const _0x174533=_0x3a465e===_0x4cf2('0x2d')?_0xc571bb:_0x350f9b;_0x50b150=_0x174533['map'](_0x7bf87a=>{const _0x47d68e=MiscUtil[_0x4cf2('0x22')](_0x7bf87a,_0x4cf2('0x30'),'data',_0x4cf2('0x44'),'parts');if(!_0x47d68e)return null;const _0x4b0320=_0x47d68e['map'](_0x457450=>{try{const _0x11dd66=_0x457450[0x0][_0x4cf2('0xb')](/@mod/gi,()=>{const _0x1ffcb9=_0x7bf87a[_0x4cf2('0x14')];if(!_0x1ffcb9)return 0x0;const _0x53eeec=MiscUtil['get'](_0x1029ae,_0x4cf2('0x30'),_0x4cf2('0x30'),_0x4cf2('0x34'),_0x4cf2('0x24'))||0xa;return Parser['getAbilityModNumber'](_0x53eeec);}),_0x56bcae=Renderer['dice'][_0x4cf2('0x26')][_0x4cf2('0x33')](_0x4cf2('0x41')+_0x11dd66+')');return{'type':_0x457450[0x1],'meanDamage':_0x56bcae[_0x4cf2('0x29')]({})};}catch(_0x2cb8fd){return console[_0x4cf2('0x0')](...LGT,_0x4cf2('0xe')+_0x457450[0x0]+'\x22',_0x2cb8fd),null;}})[_0x4cf2('0x45')](Boolean);if(!_0x4b0320[_0x4cf2('0x2f')])return null;const _0x2499c4={};_0x4b0320[_0x4cf2('0x2e')](_0x4fd61b=>_0x2499c4[_0x4fd61b[_0x4cf2('0x9')]]=Math[_0x4cf2('0x16')](_0x4fd61b['meanDamage'],_0x2499c4[_0x4fd61b[_0x4cf2('0x9')]]||0x0));const _0x496f47=Object['values'](_0x2499c4)[_0x4cf2('0x4d')]((_0x3b25b8,_0x1f7b53)=>_0x3b25b8+_0x1f7b53,0x0);return{'item':_0x7bf87a,'meanDamage':_0x496f47};})[_0x4cf2('0x45')](Boolean)[_0x4cf2('0x43')]((_0x2971c1,_0x4606f6)=>SortUtil[_0x4cf2('0x35')](_0x4606f6['meanDamage'],_0x2971c1[_0x4cf2('0x32')]))[_0x4cf2('0x6')](_0x1f02d0=>_0x1f02d0[_0x4cf2('0x1')])['find'](Boolean);if(!_0x50b150&&_0x174533[0x0])_0x50b150=_0x174533[0x0];else{if(!_0x50b150&&!_0x174533[0x0])return;}_0xa3398f[_0x4cf2('0x50')]({'item':_0x50b150,'count':_0x22ee53});}static[_0x4cf2('0x7')](_0x106d31,_0x3f249c){let _0x35d9e2=_0x106d31[_0x4cf2('0x53')][_0x4cf2('0x1f')](_0x5d7846=>Util[_0x4cf2('0x31')](_0x5d7846[_0x4cf2('0x4c')])['toLowerCase']()===_0x3f249c);if(!_0x35d9e2&&_0x3f249c[_0x4cf2('0x3')]('s')){const _0x17b6f0=_0x3f249c[_0x4cf2('0x54')](0x0,-0x1);_0x35d9e2=_0x106d31[_0x4cf2('0x53')][_0x4cf2('0x1f')](_0x69d122=>Util[_0x4cf2('0x31')](_0x69d122[_0x4cf2('0x4c')])[_0x4cf2('0x38')]()===_0x17b6f0);}return _0x35d9e2;}}export{ActorMultiattack};
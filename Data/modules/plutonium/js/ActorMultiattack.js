const _0x305a=['settings','<div\x20class=\x22item\x22\x20data-item-id=\x22','and','sort','push','dice','slice','forEach','values','damage','toLowerCase','test','\x22></div>','getWithoutParens','shift','isCapsFirst','undefined','text','join','init','error','find','textToNumber','length','name','imageButtonEnabled','abilityMod','_onItemRoll','tokens','speaker','ascSort','properties','getTree3','isAutoMultiattack','martialR','createChatMessage','weapon','content','deepEquals','ctrlKey','count','lang','_pHandleCreateChatMessage_mutExtractNamedActions','getTokens','get','includes','filter','thr','isPunctuation','collection','_pHandleCreateChatMessage_mutExtractSimpleAttacks','actionType','_pHandleCreateChatMessage','data-item-id','TERMS_COUNT','data','with','type','TITLE_LOWER_WORDS','userId','attr','map','abilities','_id','max','weaponType','melee','meanDamage','sheet','its','getAbilityModNumber','multiattack','value','betterrolls5e','_pHandleCreateChatMessage_handleMeleeRangedAttacks','martialM','pop','actor','trim','replace','avg(','toMessage','item','description','items','_getActionByLowerName'];(function(_0x1de0df,_0x305ad3){const _0x1a4716=function(_0x493f48){while(--_0x493f48){_0x1de0df['push'](_0x1de0df['shift']());}};_0x1a4716(++_0x305ad3);}(_0x305a,0x17c));const _0x1a47=function(_0x1de0df,_0x305ad3){_0x1de0df=_0x1de0df-0x0;let _0x1a4716=_0x305a[_0x1de0df];return _0x1a4716;};const _0x45855e=_0x1a47;import{Config}from'./Config.js';import{LGT,Util}from'./Util.js';import{Consts}from'./Consts.js';class ActorMultiattack{static[_0x45855e('0x45')](){const _0x242127=_0x45855e;Hooks['on'](_0x242127('0x55'),(_0x493f48,_0x393e0b,_0xeee7a6)=>{const _0x48fd15=_0x242127;this[_0x48fd15('0x10')](_0x493f48,_0x393e0b,_0xeee7a6);});}static async['_pHandleCreateChatMessage'](_0x26714c,_0x21362e,_0x11ef5e){const _0x28b68b=_0x45855e;if(!Config[_0x28b68b('0x8')](_0x28b68b('0x29'),_0x28b68b('0x53')))return;if(_0x11ef5e!==game[_0x28b68b('0x17')])return;const _0x4a1cc2=MiscUtil[_0x28b68b('0x8')](_0x26714c,_0x28b68b('0x13'),_0x28b68b('0x4f'),_0x28b68b('0x29'));if(!_0x4a1cc2)return;const _0x4cdf94=Actor[_0x28b68b('0xd')][_0x28b68b('0x8')](_0x4a1cc2);if(!_0x4cdf94)return;const _0x4c04f3=$(_0x26714c[_0x28b68b('0x13')][_0x28b68b('0x1')]||'')[_0x28b68b('0x18')](_0x28b68b('0x11'));if(!_0x4c04f3)return;const _0x5e12a1=_0x4cdf94[_0x28b68b('0x30')][_0x28b68b('0x8')](_0x4c04f3),_0x470bb6=Util[_0x28b68b('0x3f')](_0x5e12a1[_0x28b68b('0x4a')])[_0x28b68b('0x3c')]();if(_0x470bb6!==_0x28b68b('0x23'))return;const _0x5919b6=$(_0x5e12a1['data']['data'][_0x28b68b('0x2f')]['value'])[_0x28b68b('0x43')]()[_0x28b68b('0x2a')]();if(!_0x5919b6)return;const _0x16dcfe=_0x5919b6['split'](/[.?!]/g)['map'](_0xa2c685=>_0xa2c685[_0x28b68b('0x2a')]())['filter'](Boolean),_0x11ed0f=[];this[_0x28b68b('0x6')](_0x4cdf94,_0x16dcfe,_0x11ed0f),this['_pHandleCreateChatMessage_mutExtractSimpleAttacks'](_0x4cdf94,_0x16dcfe,_0x11ed0f);for(const _0x337f04 of _0x11ed0f){for(let _0x2394be=0x0;_0x2394be<_0x337f04['count'];++_0x2394be){const _0x67d88b={'preventDefault':()=>{},'stopPropagation':()=>{},'currentTarget':$(_0x28b68b('0x33')+_0x337f04[_0x28b68b('0x2e')][_0x28b68b('0x1b')]+_0x28b68b('0x3e'))[0x0]};if(typeof BetterRolls!==_0x28b68b('0x42')){const _0x18177e=new Event('fake');_0x18177e[_0x28b68b('0x3')]=![],_0x18177e['shiftKey']=![],_0x18177e['altKey']=![];const _0x5ca945={'adv':0x0,'disadv':0x0,'event':_0x18177e};!game[_0x28b68b('0x32')][_0x28b68b('0x8')](_0x28b68b('0x25'),_0x28b68b('0x4b'))?_0x337f04[_0x28b68b('0x2e')][_0x28b68b('0x29')][_0x28b68b('0x20')][_0x28b68b('0x4d')](_0x67d88b):await BetterRolls['rollItem'](_0x337f04[_0x28b68b('0x2e')],mergeObject(_0x5ca945,{'preset':0x0}))[_0x28b68b('0x2d')]();}else await _0x337f04[_0x28b68b('0x2e')]['actor'][_0x28b68b('0x20')][_0x28b68b('0x4d')](_0x67d88b);}}}static[_0x45855e('0x6')](_0x1dcb2b,_0x2496db,_0x37209c){_0x2496db['forEach'](_0x1217d6=>{const _0x4665da=_0x1a47;let _0x4ea933=Util[_0x4665da('0x7')](_0x1217d6);while((Util[_0x4665da('0xc')](_0x4ea933[0x0])||Util[_0x4665da('0x41')](_0x4ea933[0x0]))&&_0x4ea933[_0x4665da('0x49')])_0x4ea933[_0x4665da('0x40')]();_0x4ea933=_0x4ea933['map'](_0x1248e2=>_0x1248e2['trim']())[_0x4665da('0xa')](Boolean);const _0x1b43b8=[];let _0x2b9076=[],_0x42ba10={};const _0x3a6f47=()=>{const _0x6effcd=_0x4665da;if(!_0x2b9076[_0x6effcd('0x49')])return;while(_0x2b9076[_0x6effcd('0x49')]){if(StrUtil['TITLE_LOWER_WORDS'][_0x6effcd('0x9')](_0x2b9076['last']()))_0x2b9076[_0x6effcd('0x28')]();else break;}_0x1b43b8[_0x6effcd('0x36')]({'name':_0x2b9076[_0x6effcd('0x44')]('\x20'),'count':_0x42ba10[_0x6effcd('0x4')]||0x1}),_0x2b9076=[],_0x42ba10={};};for(let _0x272b3b=0x0;_0x272b3b<_0x4ea933[_0x4665da('0x49')];++_0x272b3b){const _0x534de1=_0x4ea933[_0x272b3b];if(Util['isCapsFirst'](_0x534de1))_0x2b9076[_0x4665da('0x36')](_0x534de1);else{if(_0x2b9076['length']&&StrUtil[_0x4665da('0x16')][_0x4665da('0x9')](_0x534de1))_0x2b9076['push'](_0x534de1);else{const _0x2c5ba8=Consts[_0x4665da('0x12')][_0x4665da('0x47')](_0x1462c3=>{const _0x50d6f5=_0x4665da,_0x36487b=_0x4ea933[_0x50d6f5('0x38')](_0x272b3b,_0x272b3b+_0x1462c3[_0x50d6f5('0x4e')][_0x50d6f5('0x49')]);return CollectionUtil[_0x50d6f5('0x2')](_0x1462c3[_0x50d6f5('0x4e')],_0x36487b);});_0x2b9076[_0x4665da('0x49')]&&_0x2c5ba8&&(_0x272b3b+=_0x2c5ba8[_0x4665da('0x4e')][_0x4665da('0x49')]-0x1,_0x42ba10[_0x4665da('0x4')]=_0x2c5ba8[_0x4665da('0x4')]),_0x3a6f47();}}}_0x3a6f47(),_0x1b43b8[_0x4665da('0x39')](_0x1ff68b=>{const _0x10ee2b=_0x4665da,_0x12cc43=_0x1ff68b[_0x10ee2b('0x4a')]['toLowerCase']()[_0x10ee2b('0x2a')](),_0x11cd26=_0x1dcb2b[_0x10ee2b('0x30')][_0x10ee2b('0x47')](_0x8e62dc=>Util[_0x10ee2b('0x3f')](_0x8e62dc[_0x10ee2b('0x4a')])[_0x10ee2b('0x3c')]()===_0x12cc43);if(!_0x11cd26)return;_0x37209c[_0x10ee2b('0x36')]({'item':_0x11cd26,'count':_0x1ff68b[_0x10ee2b('0x4')]||0x1});});});}static[_0x45855e('0xe')](_0x43fe8f,_0x9e4dcc,_0x2a9bde){_0x9e4dcc['forEach'](_0x4128e6=>{const _0x3a7af4=_0x1a47;_0x4128e6=_0x4128e6[_0x3a7af4('0x2b')](/(two|three|four|five|six|seven|eight) (.*?) attacks/gi,(..._0x47c2bc)=>{const _0xba84bb=_0x3a7af4,_0x4ed8b7=_0x47c2bc[0x1][_0xba84bb('0x3c')](),_0x305a92=Parser[_0xba84bb('0x48')](_0x4ed8b7),_0x58c324=Util['getWithoutParens'](_0x47c2bc[0x2])[_0xba84bb('0x3c')]();if(_0x58c324===_0xba84bb('0x1e')||_0x58c324==='ranged')return this['_pHandleCreateChatMessage_handleMeleeRangedAttacks'](_0x43fe8f,_0x58c324,_0x305a92,_0x2a9bde),'';const _0x126c20=_0x43fe8f['items']['find'](_0x3a7183=>Util[_0xba84bb('0x3f')](_0x3a7183[_0xba84bb('0x4a')])[_0xba84bb('0x3c')]()===_0x58c324);if(!_0x126c20)return _0x47c2bc[0x0];return _0x2a9bde[_0xba84bb('0x36')]({'item':_0x126c20,'count':_0x305a92}),'';}),_0x4128e6=_0x4128e6[_0x3a7af4('0x2b')](/makes (two|three|four|five|six|seven|eight) attacks with its (.*? or .*?)$/gi,(..._0x5cb046)=>{const _0x590744=_0x3a7af4,_0x504f90=_0x5cb046[0x1];let _0x3e1fea=_0x5cb046[0x2];const _0x1b5fd2=Util[_0x590744('0x7')](_0x3e1fea);while(_0x1b5fd2[_0x590744('0x49')]){const _0x16972a=[];for(let _0x3089c4=0x0;_0x3089c4<_0x1b5fd2['length'];++_0x3089c4){const _0x1d20fe=_0x1b5fd2[_0x3089c4][_0x590744('0x3c')]();if(_0x1d20fe===_0x590744('0x34')||_0x1d20fe==='or'||_0x1d20fe===_0x590744('0x21')||_0x1d20fe===_0x590744('0x14')||Util[_0x590744('0xc')](_0x1d20fe)){_0x1b5fd2[_0x590744('0x40')]();break;}else _0x16972a[_0x590744('0x36')](_0x1b5fd2[_0x590744('0x40')]()),_0x3089c4--;}if(_0x16972a[_0x590744('0x49')]){const _0x46b62f=_0x16972a['join']('')[_0x590744('0x2a')](),_0x58dbc6=this[_0x590744('0x31')](_0x43fe8f,_0x46b62f);_0x58dbc6&&_0x2a9bde[_0x590744('0x36')]({'item':_0x58dbc6,'count':Parser[_0x590744('0x48')](_0x504f90)});}}return _0x1b5fd2[_0x590744('0x44')]('')['trim']();}),_0x4128e6=_0x4128e6['replace'](/makes (?:two|three|four|five|six|seven|eight) attacks:(.*?)$/gi,(..._0x250f6a)=>{const _0x222366=_0x3a7af4;let _0x26ebe8=_0x250f6a[0x1],_0x153e1c=![],_0x5c2f2a=null;while(_0x26ebe8[_0x222366('0x49')]&&_0x26ebe8!==_0x5c2f2a){_0x5c2f2a=_0x26ebe8,_0x26ebe8=_0x26ebe8[_0x222366('0x2b')](/(one|two|three|four|five|six|seven|eight) with (?:its |his |her )(.*)/gi,(..._0x22c136)=>{const _0x469da3=_0x222366,_0x12420f=_0x22c136[0x1],_0x4116fc=_0x22c136[0x2],_0xa86584=[],_0x668ce4=Util[_0x469da3('0x7')](_0x4116fc);for(let _0x5899a4=0x0;_0x5899a4<_0x668ce4['length'];++_0x5899a4){const _0x3429dd=_0x668ce4[_0x5899a4][_0x469da3('0x3c')]();if(_0x3429dd==='and'||_0x3429dd==='or'||Util[_0x469da3('0xc')](_0x3429dd)){_0x668ce4[_0x469da3('0x40')]();break;}else _0xa86584[_0x469da3('0x36')](_0x668ce4[_0x469da3('0x40')]()),_0x5899a4--;}if(_0xa86584[_0x469da3('0x49')]){const _0x4728c0=_0xa86584['join']('')[_0x469da3('0x2a')](),_0x546656=this[_0x469da3('0x31')](_0x43fe8f,_0x4728c0);_0x546656&&_0x2a9bde[_0x469da3('0x36')]({'item':_0x546656,'count':Parser['textToNumber'](_0x12420f)});}return _0x668ce4[_0x469da3('0x44')]('')['trim']();});}if(_0x153e1c)return'';return _0x250f6a[0x0];});});}static[_0x45855e('0x26')](_0x2aa6aa,_0x3632a7,_0x5eed58,_0x23c52d){const _0x4c0d82=_0x45855e;let _0x44d7b5;const _0x4b8a48=[],_0x7fa4fa=[];_0x2aa6aa['items'][_0x4c0d82('0xa')](_0x263c50=>_0x263c50[_0x4c0d82('0x15')]===_0x4c0d82('0x0'))['forEach'](_0x56924b=>{const _0x37df73=_0x4c0d82,_0x109f5e=MiscUtil[_0x37df73('0x8')](_0x56924b,_0x37df73('0x13'),_0x37df73('0x13'));if(!_0x109f5e)return;const _0x55a142=MiscUtil['get'](_0x109f5e,_0x37df73('0x1d'));switch(_0x55a142){case'simpleM':case _0x37df73('0x27'):{_0x4b8a48['push'](_0x56924b);if(MiscUtil['get'](_0x109f5e,'properties',_0x37df73('0xb')))_0x7fa4fa[_0x37df73('0x36')](_0x56924b);return;}case'simpleR':case _0x37df73('0x54'):{_0x7fa4fa[_0x37df73('0x36')](_0x56924b);return;}}const _0x32f037=MiscUtil[_0x37df73('0x8')](_0x109f5e,_0x37df73('0xf'));switch(_0x32f037){case'mwak':{_0x4b8a48['push'](_0x56924b);if(MiscUtil[_0x37df73('0x8')](_0x109f5e,_0x37df73('0x51'),'thr'))_0x7fa4fa[_0x37df73('0x36')](_0x56924b);return;}case'rwak':{_0x7fa4fa['push'](_0x56924b);return;}}const _0x470123=(MiscUtil[_0x37df73('0x8')](_0x109f5e,'description',_0x37df73('0x24'))||'')['replace'](/[^a-zA-Z0-9:.,()]/g,'')[_0x37df73('0x2b')](/\s+/g,'\x20')[_0x37df73('0x2a')]();if(/melee or ranged weapon attack:/i[_0x37df73('0x3d')](_0x470123))_0x4b8a48['push'](_0x56924b),_0x7fa4fa[_0x37df73('0x36')](_0x56924b);else{if(/melee weapon attack:/i[_0x37df73('0x3d')](_0x470123))_0x4b8a48[_0x37df73('0x36')](_0x56924b);else/ranged weapon attack:/i[_0x37df73('0x3d')](_0x470123)&&_0x7fa4fa['push'](_0x56924b);}});const _0x1dbbd5=_0x3632a7===_0x4c0d82('0x1e')?_0x4b8a48:_0x7fa4fa;_0x44d7b5=_0x1dbbd5[_0x4c0d82('0x19')](_0xc06983=>{const _0x43af97=_0x4c0d82,_0x2661ae=MiscUtil[_0x43af97('0x8')](_0xc06983,'data',_0x43af97('0x13'),_0x43af97('0x3b'),'parts');if(!_0x2661ae)return null;const _0x16745a=_0x2661ae[_0x43af97('0x19')](_0x106a16=>{const _0x5049ad=_0x43af97;try{const _0x25a0e0=_0x106a16[0x0][_0x5049ad('0x2b')](/@mod/gi,()=>{const _0x25195b=_0x5049ad,_0x319391=_0xc06983[_0x25195b('0x4c')];if(!_0x319391)return 0x0;const _0xc05fb=MiscUtil[_0x25195b('0x8')](_0x2aa6aa,_0x25195b('0x13'),_0x25195b('0x13'),_0x25195b('0x1a'),_0x25195b('0x24'))||0xa;return Parser[_0x25195b('0x22')](_0xc05fb);}),_0xe4d342=Renderer[_0x5049ad('0x37')][_0x5049ad('0x5')][_0x5049ad('0x52')](_0x5049ad('0x2c')+_0x25a0e0+')');return{'type':_0x106a16[0x1],'meanDamage':_0xe4d342['evl']({})};}catch(_0x5a9032){return console[_0x5049ad('0x46')](...LGT,'Failed\x20to\x20evaluate\x20damage\x20part\x20\x22'+_0x106a16[0x0]+'\x22',_0x5a9032),null;}})[_0x43af97('0xa')](Boolean);if(!_0x16745a[_0x43af97('0x49')])return null;const _0x43d782={};_0x16745a[_0x43af97('0x39')](_0x484a4e=>_0x43d782[_0x484a4e[_0x43af97('0x15')]]=Math[_0x43af97('0x1c')](_0x484a4e[_0x43af97('0x1f')],_0x43d782[_0x484a4e['type']]||0x0));const _0x31e53f=Object[_0x43af97('0x3a')](_0x43d782)['reduce']((_0x4fb35d,_0x3c52dd)=>_0x4fb35d+_0x3c52dd,0x0);return{'item':_0xc06983,'meanDamage':_0x31e53f};})[_0x4c0d82('0xa')](Boolean)[_0x4c0d82('0x35')]((_0x3c5293,_0x56e425)=>SortUtil[_0x4c0d82('0x50')](_0x56e425[_0x4c0d82('0x1f')],_0x3c5293[_0x4c0d82('0x1f')]))['map'](_0x3e9ee1=>_0x3e9ee1[_0x4c0d82('0x2e')])[_0x4c0d82('0x47')](Boolean);if(!_0x44d7b5&&_0x1dbbd5[0x0])_0x44d7b5=_0x1dbbd5[0x0];else{if(!_0x44d7b5&&!_0x1dbbd5[0x0])return;}_0x23c52d['push']({'item':_0x44d7b5,'count':_0x5eed58});}static[_0x45855e('0x31')](_0x10b8d6,_0x5b13e9){const _0x227fbd=_0x45855e;let _0x22b53c=_0x10b8d6[_0x227fbd('0x30')]['find'](_0x690f7e=>Util[_0x227fbd('0x3f')](_0x690f7e[_0x227fbd('0x4a')])['toLowerCase']()===_0x5b13e9);if(!_0x22b53c&&_0x5b13e9['endsWith']('s')){const _0x285744=_0x5b13e9['slice'](0x0,-0x1);_0x22b53c=_0x10b8d6[_0x227fbd('0x30')][_0x227fbd('0x47')](_0xd67f0f=>Util[_0x227fbd('0x3f')](_0xd67f0f[_0x227fbd('0x4a')])[_0x227fbd('0x3c')]()===_0x285744);}return _0x22b53c;}}export{ActorMultiattack};
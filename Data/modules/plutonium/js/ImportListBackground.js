const _0x44fa=['_actor','Import\x20Backgrounds','_list','1602231GdppkF','currency','Item','_pImportEntry_pImportToActor','skills','pImportEquipmentItemEntries','_normalisedTime','sourceJsonToColor','/media/icon/mighty-force.svg','_pImportEntry_pImportToDirectoryGeneric','skillProficiencies','source','Backgrounds','constructor','filter','56598AbmzDG','TASK_EXIT_CANCELLED','pFillActorSkillData','sourceJsonToAbv','length','mutateForFilters','getData','getBackgroundItem','languageProficiencies','268913gxLtkQ','text-center','94477AIUgZi','isCancelled','557959FbDPVs','forEach','sourceClassName','items','55deZaXK','DataSourceUrl','languages','Skills','DATA_URL_BACKGROUNDS','pWaitForUserInput','601895OlgiNe','sheet','doAbsorbItems','_skillDisplay','TASK_EXIT_COMPLETE','toolProf','sourceLong','_activateListeners_absorbListItems','name','_page','URL_TO_HASH_BUILDER','modules/','746457QyRfxM','set','log','_normalisedRange','_titleButtonRun','absorbFnGetData','data','12jWVxnW','Upload\x20File','absorbFnBindListeners','_pImportEntry_pFillItems','feat','pGetHomebrewSources','absorbFnBindListenersRadio','3qTmRlj','5etools','DataSourceFile','SOURCE_TYP_CUSTOM','_pImportEntry_pImportToDirectoryGeneric_pGetImportableData','_content','_isPreviewable','pAddActorItems','_pageFilter','get','SOURCE_TYP_OFFICIAL_ALL','render','map','page','SOURCE_TYP_BREW','\x22\x20(from\x20\x22','entries','_titleSearch','pFillActorToolData','isFeature','isRadio','_pImportEntry_pFillProficiencies','background','isTemp','1SURvSG','startingEquipment','toolProficiencies','replace','applyFormDataToActorUpdate','_pImportEntry_pImportToActor_pImportStartingEquipment','isToken','Importing\x20background\x20\x22','pFillActorLanguageData','SRD','_foundryFormDataCharacteristics','backgrounds','pImportEntry'];const _0x4752=function(_0x353fd3,_0xcf684a){_0x353fd3=_0x353fd3-0x10b;let _0x44fa46=_0x44fa[_0x353fd3];return _0x44fa46;};const _0x386757=_0x4752;(function(_0x1ffb33,_0x1d37e5){const _0x5e0466=_0x4752;while(!![]){try{const _0x5df3e6=-parseInt(_0x5e0466(0x127))*-parseInt(_0x5e0466(0x146))+parseInt(_0x5e0466(0x125))*parseInt(_0x5e0466(0x14d))+parseInt(_0x5e0466(0x10d))+parseInt(_0x5e0466(0x133))+parseInt(_0x5e0466(0x165))*parseInt(_0x5e0466(0x129))+-parseInt(_0x5e0466(0x13f))+-parseInt(_0x5e0466(0x11c))*parseInt(_0x5e0466(0x12d));if(_0x5df3e6===_0x1d37e5)break;else _0x1ffb33['push'](_0x1ffb33['shift']());}catch(_0x4cc9fa){_0x1ffb33['push'](_0x1ffb33['shift']());}}}(_0x44fa,0xcddc1));import{Vetools}from'./Vetools.js';import{LGT}from'./Util.js';import{UtilActors}from'./UtilActors.js';import{DataConverter}from'./DataConverter.js';import{SharedConsts}from'../shared/SharedConsts.js';import{Config}from'./Config.js';import{UtilList2}from'./UtilList2.js';import{UtilApplications}from'./UtilApplications.js';import{ImportListCharacter}from'./ImportListCharacter.js';import{DataConverterBackground}from'./DataConverterBackground.js';import{Charactermancer_StartingEquipment}from'./UtilCharactermancerEquipment.js';import{Charactermancer_Background_Characteristics}from'./UtilCharactermancerBackground.js';import{UtilDataSource}from'./UtilDataSource.js';class ImportListBackground extends ImportListCharacter{static['init'](){this['_initCreateSheetItemHook']({'prop':'background','importerName':'Background'});}constructor(_0x761d0e){const _0x281744=_0x4752;_0x761d0e=_0x761d0e||{},super({'title':_0x281744(0x10b)},_0x761d0e,{'props':[_0x281744(0x163)],'titleSearch':_0x281744(0x170),'sidebarTab':_0x281744(0x12c),'gameProp':_0x281744(0x12c),'defaultFolderPath':[_0x281744(0x119)],'folderType':_0x281744(0x10f),'pageFilter':new PageFilterBackgrounds(),'isActorRadio':!![],'page':UrlUtil['PG_BACKGROUNDS'],'isPreviewable':!![],'isDedupable':!![]});}async['pGetSources'](){const _0x56720b=_0x4752;return[new UtilDataSource['DataSourceUrl'](Config[_0x56720b(0x156)]('ui','isStreamerMode')?_0x56720b(0x16e):_0x56720b(0x14e),Vetools[_0x56720b(0x131)],{'filterTypes':[UtilDataSource[_0x56720b(0x157)]],'isDefault':!![]}),new UtilDataSource[(_0x56720b(0x12e))]('Custom\x20URL','',{'filterTypes':[UtilDataSource[_0x56720b(0x150)]]}),new UtilDataSource[(_0x56720b(0x14f))](_0x56720b(0x147),{'filterTypes':[UtilDataSource[_0x56720b(0x150)]]}),...(await Vetools[_0x56720b(0x14b)](_0x56720b(0x163)))[_0x56720b(0x159)](({name:_0x4f265f,url:_0x48cb48})=>new UtilDataSource[(_0x56720b(0x12e))](_0x4f265f,_0x48cb48,{'filterTypes':[UtilDataSource[_0x56720b(0x15b)]]}))];}[_0x386757(0x122)](){const _0x127f0b=_0x386757,_0x29fb0c={'isPreviewable':this[_0x127f0b(0x153)],'titleButtonRun':this[_0x127f0b(0x143)],'titleSearch':this[_0x127f0b(0x15e)],'cols':[{'name':'Name','width':0x4,'field':'name'},{'name':_0x127f0b(0x130),'width':0x6,'field':'skills'},{'name':'Source','width':0x1,'field':_0x127f0b(0x118),'titleProp':_0x127f0b(0x139),'displayProp':'sourceShort','classNameProp':_0x127f0b(0x12b),'rowClassName':_0x127f0b(0x126)}],'rows':this['_content'][_0x127f0b(0x159)]((_0xb641ae,_0x3ff131)=>{const _0x249ad6=_0x127f0b;return this[_0x249ad6(0x155)][_0x249ad6(0x11a)][_0x249ad6(0x121)](_0xb641ae),{'name':_0xb641ae['name'],'skills':_0xb641ae['_skillDisplay'],'source':_0xb641ae[_0x249ad6(0x118)],'sourceShort':Parser[_0x249ad6(0x11f)](_0xb641ae[_0x249ad6(0x118)]),'sourceLong':Parser['sourceJsonToFull'](_0xb641ae['source']),'sourceClassName':Parser[_0x249ad6(0x114)](_0xb641ae[_0x249ad6(0x118)]),'ix':_0x3ff131};})};return this[_0x127f0b(0x172)]&&(_0x29fb0c[_0x127f0b(0x161)]=!![]),_0x29fb0c;}[_0x386757(0x13a)](){const _0x51af31=_0x386757;this['_list'][_0x51af31(0x135)](this[_0x51af31(0x152)],{'fnGetName':_0x4d9d4f=>_0x4d9d4f[_0x51af31(0x13b)],'fnGetValues':_0x931875=>({'source':_0x931875[_0x51af31(0x118)],'skills':_0x931875[_0x51af31(0x136)],'normalisedTime':_0x931875[_0x51af31(0x113)],'normalisedRange':_0x931875[_0x51af31(0x142)],'hash':UrlUtil[_0x51af31(0x13d)][this[_0x51af31(0x13c)]](_0x931875)}),'fnGetData':UtilList2[_0x51af31(0x144)],'fnBindListeners':_0xed6b50=>this[_0x51af31(0x172)]?UtilList2[_0x51af31(0x14c)](this['_list'],_0xed6b50):UtilList2[_0x51af31(0x148)](this[_0x51af31(0x10c)],_0xed6b50)});}async[_0x386757(0x171)](_0x41cb6a,_0x14349b){const _0x30802e=_0x386757;_0x14349b=_0x14349b||{},console[_0x30802e(0x141)](...LGT,_0x30802e(0x16c)+_0x41cb6a[_0x30802e(0x13b)]+_0x30802e(0x15c)+Parser[_0x30802e(0x11f)](_0x41cb6a['source'])+'\x22)');if(_0x14349b[_0x30802e(0x164)])return this['_pImportEntry_pImportToDirectoryGeneric'](_0x41cb6a,_0x14349b);else{if(this[_0x30802e(0x172)])return this[_0x30802e(0x110)](_0x41cb6a,_0x14349b);else return this[_0x30802e(0x116)](_0x41cb6a,_0x14349b);}}async[_0x386757(0x110)](_0x57c1e3,_0x17e15d){const _0x20a943=_0x386757,_0x3d2364={'data':{'details':{'background':_0x57c1e3[_0x20a943(0x13b)]}}},_0x1f7ee2=new ImportListCharacter['ImportEntryOpts']();await this[_0x20a943(0x162)](_0x57c1e3,_0x3d2364[_0x20a943(0x145)],_0x1f7ee2);if(_0x1f7ee2['isCancelled'])return{'status':UtilApplications[_0x20a943(0x11d)]};await this['_pImportEntry_pFillDetails'](_0x57c1e3,_0x3d2364,_0x1f7ee2);if(_0x1f7ee2[_0x20a943(0x128)])return{'status':UtilApplications[_0x20a943(0x11d)]};await this[_0x20a943(0x149)](_0x57c1e3,_0x3d2364,_0x1f7ee2);const _0x2232d9=await this[_0x20a943(0x16a)](_0x57c1e3,_0x1f7ee2);if(_0x1f7ee2[_0x20a943(0x128)])return{'status':UtilApplications['TASK_EXIT_CANCELLED']};if(_0x2232d9?.[_0x20a943(0x145)]?.['currency'])MiscUtil[_0x20a943(0x140)](_0x3d2364,_0x20a943(0x145),_0x20a943(0x10e),_0x2232d9[_0x20a943(0x145)][_0x20a943(0x10e)]);this['_actor']['update'](_0x3d2364),await Charactermancer_StartingEquipment[_0x20a943(0x112)](this['_actor'],_0x2232d9);if(this[_0x20a943(0x172)][_0x20a943(0x16b)])this[_0x20a943(0x172)][_0x20a943(0x134)][_0x20a943(0x158)]();return{'imported':{'name':_0x57c1e3[_0x20a943(0x13b)],'actor':this[_0x20a943(0x172)]},'status':UtilApplications[_0x20a943(0x137)]};}async[_0x386757(0x16a)](_0x13de0a,_0x4c5931){const _0x779678=_0x386757;if(!_0x13de0a[_0x779678(0x166)])return;const _0x562385={'defaultData':_0x13de0a[_0x779678(0x166)]},_0x582d62=new Charactermancer_StartingEquipment({'actor':this[_0x779678(0x172)],'startingEquipment':_0x562385,'appSubTitle':_0x13de0a['name'],'equiSpecialSource':_0x13de0a['source'],'equiSpecialPage':_0x13de0a[_0x779678(0x15a)]}),_0x4c5bf9=await _0x582d62[_0x779678(0x132)]();if(_0x4c5bf9==null)return _0x4c5931[_0x779678(0x128)]=!![],null;return _0x4c5bf9;}[_0x386757(0x151)](_0x587b07,_0x50bd6a){const _0x3c3eb3=_0x386757;return DataConverterBackground[_0x3c3eb3(0x123)](_0x587b07,_0x50bd6a);}async[_0x386757(0x162)](_0x56c60a,_0x5730b0,_0x467e65){const _0x326549=_0x386757;await DataConverter[_0x326549(0x11e)](MiscUtil['get'](this['_actor'],_0x326549(0x145),_0x326549(0x145),_0x326549(0x111)),_0x56c60a[_0x326549(0x117)],_0x5730b0,_0x467e65);if(_0x467e65[_0x326549(0x128)])return;await DataConverter[_0x326549(0x16d)](MiscUtil['get'](this[_0x326549(0x172)],'data',_0x326549(0x145),'traits',_0x326549(0x12f)),_0x56c60a[_0x326549(0x124)],_0x5730b0,_0x467e65);if(_0x467e65['isCancelled'])return;_0x467e65['isCancelled']=await DataConverter[_0x326549(0x15f)](MiscUtil[_0x326549(0x156)](this[_0x326549(0x172)],'data',_0x326549(0x145),'traits',_0x326549(0x138)),_0x56c60a[_0x326549(0x167)],_0x5730b0);}async['_pImportEntry_pFillDetails'](_0x3c14c7,_0xa8e82c,_0x291048){const _0x4cf4b6=_0x386757;if(_0x3c14c7['_foundryIsSkipImportCharacteristics'])return;if(_0x3c14c7[_0x4cf4b6(0x16f)])return Charactermancer_Background_Characteristics[_0x4cf4b6(0x169)](_0xa8e82c,_0x3c14c7[_0x4cf4b6(0x16f)]);await Charactermancer_Background_Characteristics['pFillActorCharacteristicsData'](_0x3c14c7[_0x4cf4b6(0x15d)],_0xa8e82c,_0x291048);}async['_pImportEntry_pFillItems'](_0x544966,_0x5f4fe4,_0x487d18){const _0x3b5a05=_0x386757;_0x487d18[_0x3b5a05(0x12c)]=[];const _0x3f6863=(_0x544966[_0x3b5a05(0x15d)]||[])[_0x3b5a05(0x11b)](_0x46709c=>_0x46709c['data']&&_0x46709c[_0x3b5a05(0x145)][_0x3b5a05(0x160)]);_0x3f6863['length']&&_0x3f6863[_0x3b5a05(0x12a)](_0x13a712=>{const _0x49154b=_0x3b5a05,_0x10a32b=MiscUtil['copy'](_0x13a712);if(_0x10a32b[_0x49154b(0x13b)])_0x10a32b[_0x49154b(0x13b)][_0x49154b(0x168)](/^.*?:\s*/,'');_0x487d18['items']['push'](DataConverter['getItemActorPassive'](_0x13a712,{'mode':'player','img':_0x49154b(0x13e)+SharedConsts['MODULE_NAME']+_0x49154b(0x115),'fvttType':_0x49154b(0x14a),'source':_0x544966[_0x49154b(0x118)],'actor':this[_0x49154b(0x172)]}));});if(_0x487d18[_0x3b5a05(0x12c)][_0x3b5a05(0x120)])await UtilActors[_0x3b5a05(0x154)](this[_0x3b5a05(0x172)],_0x487d18[_0x3b5a05(0x12c)]);}}export{ImportListBackground};
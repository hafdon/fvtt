'use strict';const _0xc70a=['Name','filter','pWaitForUserInput','PG_BACKGROUNDS','startingEquipment','languages','SOURCE_TYP_CUSTOM','update','Import\x20Backgrounds','skillProficiencies','absorbFnGetData','_pImportEntry_pFillProficiencies','constructor','/media/icon/mighty-force.svg','_actor','isToken','DataSourceUrl','_isPreviewable','pImportEntry','items','URL_TO_HASH_BUILDER','sourceJsonToAbv','\x22\x20(from\x20\x22','forEach','currency','Item','name','3452546fIuSHk','mutateForFilters','getData','sourceJsonToFull','pGetHomebrewSources','background','length','_pImportEntry_pFillItems','copy','MODULE_NAME','sourceClassName','data','pFillActorToolData','Upload\x20File','_pImportEntry_pImportToDirectoryGeneric_pGetImportableData','isRadio','_content','Background','67589MaSbEj','get','source','_list','getBackgroundItem','push','_skillDisplay','sourceShort','_pImportEntry_pImportToDirectoryGeneric','1fItRMP','entries','pFillActorLanguageData','610559ewACXs','_pImportEntry_pImportToActor','_initCreateSheetItemHook','toolProficiencies','1678338abHRLn','_normalisedTime','pFillActorSkillData','isTemp','absorbFnBindListenersRadio','TASK_EXIT_CANCELLED','pGetSources','pAddActorItems','map','pImportEquipmentItemEntries','traits','Custom\x20URL','skills','SRD','Source','page','feat','Skills','14341zuDTXz','_pageFilter','SOURCE_TYP_BREW','languageProficiencies','_pImportEntry_pImportToActor_pImportStartingEquipment','render','backgrounds','1724625jXeVQF','init','isCancelled','_page','DATA_URL_BACKGROUNDS','11vpCttn','replace','767746UPrZmR','isFeature','absorbFnBindListeners'];const _0x66c9=function(_0x497f29,_0x29c771){_0x497f29=_0x497f29-0xa2;let _0xc70aad=_0xc70a[_0x497f29];return _0xc70aad;};const _0x58b0a4=_0x66c9;(function(_0x3b084f,_0x5f378c){const _0x9a1f25=_0x66c9;while(!![]){try{const _0x30218c=parseInt(_0x9a1f25(0x100))*-parseInt(_0x9a1f25(0xa3))+parseInt(_0x9a1f25(0xa7))+-parseInt(_0x9a1f25(0xc5))*-parseInt(_0x9a1f25(0xf7))+parseInt(_0x9a1f25(0xc7))+parseInt(_0x9a1f25(0xc0))+parseInt(_0x9a1f25(0xb9))+-parseInt(_0x9a1f25(0xe5));if(_0x30218c===_0x5f378c)break;else _0x3b084f['push'](_0x3b084f['shift']());}catch(_0x1226da){_0x3b084f['push'](_0x3b084f['shift']());}}}(_0xc70a,0xd3490));import{ImportList}from'./ImportList.js';import{Vetools}from'./Vetools.js';import{LGT}from'./Util.js';import{UtilActors}from'./UtilActors.js';import{DataConverter}from'./DataConverter.js';import{SharedConsts}from'../shared/SharedConsts.js';import{Config}from'./Config.js';import{UtilList2}from'./UtilList2.js';import{UtilApplications}from'./UtilApplications.js';import{ImportListCharacter}from'./ImportListCharacter.js';import{DataConverterBackground}from'./DataConverterBackground.js';import{Charactermancer_StartingEquipment}from'./UtilCharactermancerEquipment.js';class ImportListBackground extends ImportListCharacter{static[_0x58b0a4(0xc1)](){const _0x4fb811=_0x58b0a4;this[_0x4fb811(0xa5)]({'prop':_0x4fb811(0xea),'importerName':_0x4fb811(0xf6)});}constructor(_0x528f06){const _0x1f5766=_0x58b0a4;_0x528f06=_0x528f06||{},super({'title':_0x1f5766(0xd2)},_0x528f06,{'props':[_0x1f5766(0xea)],'titleSearch':_0x1f5766(0xbf),'sidebarTab':_0x1f5766(0xdd),'gameProp':_0x1f5766(0xdd),'defaultFolderPath':['Backgrounds'],'folderType':_0x1f5766(0xe3),'pageFilter':new PageFilterBackgrounds(),'isActorRadio':!![],'page':UrlUtil[_0x1f5766(0xcd)],'isPreviewable':!![],'isDedupable':!![]});}async[_0x58b0a4(0xad)](){const _0x33fd2e=_0x58b0a4;return[new ImportList[(_0x33fd2e(0xda))](Config['get']('ui','isStreamerMode')?_0x33fd2e(0xb4):'5etools',Vetools[_0x33fd2e(0xc4)],{'filterTypes':[ImportList['SOURCE_TYP_OFFICIAL_ALL']],'isDefault':!![]}),new ImportList['DataSourceUrl'](_0x33fd2e(0xb2),'',{'filterTypes':[ImportList['SOURCE_TYP_CUSTOM']]}),new ImportList['DataSourceFile'](_0x33fd2e(0xf2),{'filterTypes':[ImportList[_0x33fd2e(0xd0)]]}),...(await Vetools[_0x33fd2e(0xe9)](_0x33fd2e(0xea)))['map'](({name:_0x4d00af,url:_0x388579})=>new ImportList[(_0x33fd2e(0xda))](_0x4d00af,_0x388579,{'filterTypes':[ImportList[_0x33fd2e(0xbb)]]}))];}[_0x58b0a4(0xe7)](){const _0x391864=_0x58b0a4,_0x26ac5f={'isPreviewable':this[_0x391864(0xdb)],'titleButtonRun':this['_titleButtonRun'],'titleSearch':this['_titleSearch'],'cols':[{'name':_0x391864(0xca),'width':0x4,'field':_0x391864(0xe4)},{'name':_0x391864(0xb8),'width':0x6,'field':_0x391864(0xb3)},{'name':_0x391864(0xb5),'width':0x1,'field':_0x391864(0xf9),'titleProp':'sourceLong','displayProp':_0x391864(0xfe),'classNameProp':_0x391864(0xef),'rowClassName':'text-center'}],'rows':this['_content'][_0x391864(0xaf)]((_0x962c30,_0x537c63)=>{const _0xba9c43=_0x391864;return this[_0xba9c43(0xba)][_0xba9c43(0xd6)][_0xba9c43(0xe6)](_0x962c30),{'name':_0x962c30['name'],'skills':_0x962c30['_skillDisplay'],'source':_0x962c30[_0xba9c43(0xf9)],'sourceShort':Parser[_0xba9c43(0xdf)](_0x962c30[_0xba9c43(0xf9)]),'sourceLong':Parser[_0xba9c43(0xe8)](_0x962c30['source']),'sourceClassName':Parser['sourceJsonToColor'](_0x962c30[_0xba9c43(0xf9)]),'ix':_0x537c63};})};return this[_0x391864(0xd8)]&&(_0x26ac5f[_0x391864(0xf4)]=!![]),_0x26ac5f;}['_activateListeners_absorbListItems'](){const _0x565d4f=_0x58b0a4;this[_0x565d4f(0xfa)]['doAbsorbItems'](this[_0x565d4f(0xf5)],{'fnGetName':_0x4f70ef=>_0x4f70ef[_0x565d4f(0xe4)],'fnGetValues':_0x43fb9c=>({'source':_0x43fb9c[_0x565d4f(0xf9)],'skills':_0x43fb9c[_0x565d4f(0xfd)],'normalisedTime':_0x43fb9c[_0x565d4f(0xa8)],'normalisedRange':_0x43fb9c['_normalisedRange'],'hash':UrlUtil[_0x565d4f(0xde)][this[_0x565d4f(0xc3)]](_0x43fb9c)}),'fnGetData':UtilList2[_0x565d4f(0xd4)],'fnBindListeners':_0x5d9190=>this['_actor']?UtilList2[_0x565d4f(0xab)](this['_list'],_0x5d9190):UtilList2[_0x565d4f(0xc9)](this[_0x565d4f(0xfa)],_0x5d9190)});}async[_0x58b0a4(0xdc)](_0x54897e,_0xc1d85){const _0x16bbd5=_0x58b0a4;_0xc1d85=_0xc1d85||{},console['log'](...LGT,'Importing\x20background\x20\x22'+_0x54897e[_0x16bbd5(0xe4)]+_0x16bbd5(0xe0)+Parser[_0x16bbd5(0xdf)](_0x54897e['source'])+'\x22)');if(_0xc1d85[_0x16bbd5(0xaa)])return this[_0x16bbd5(0xff)](_0x54897e,_0xc1d85);else{if(this['_actor'])return this[_0x16bbd5(0xa4)](_0x54897e,_0xc1d85);else return this[_0x16bbd5(0xff)](_0x54897e,_0xc1d85);}}async['_pImportEntry_pImportToActor'](_0x7070a2,_0xa18ca0){const _0x4b14ed=_0x58b0a4,_0x1ac851={'data':{'details':{'background':_0x7070a2[_0x4b14ed(0xe4)]}}},_0x33b188=new ImportListCharacter['ImportEntryOpts']();await this[_0x4b14ed(0xd5)](_0x7070a2,_0x1ac851['data'],_0x33b188);if(_0x33b188[_0x4b14ed(0xc2)])return{'status':UtilApplications[_0x4b14ed(0xac)]};await this[_0x4b14ed(0xec)](_0x7070a2,_0x1ac851,_0x33b188);const _0x4e44f0=await this['_pImportEntry_pImportToActor_pImportStartingEquipment'](_0x7070a2,_0x33b188);if(_0x33b188[_0x4b14ed(0xc2)])return{'status':UtilApplications[_0x4b14ed(0xac)]};if(_0x4e44f0?.[_0x4b14ed(0xf0)]?.[_0x4b14ed(0xe2)])MiscUtil['set'](_0x1ac851,_0x4b14ed(0xf0),'currency',_0x4e44f0['data'][_0x4b14ed(0xe2)]);this['_actor'][_0x4b14ed(0xd1)](_0x1ac851),await Charactermancer_StartingEquipment[_0x4b14ed(0xb0)](this[_0x4b14ed(0xd8)],_0x4e44f0);if(this['_actor'][_0x4b14ed(0xd9)])this[_0x4b14ed(0xd8)]['sheet'][_0x4b14ed(0xbe)]();return{'imported':{'name':_0x7070a2[_0x4b14ed(0xe4)],'actor':this['_actor']},'status':UtilApplications['TASK_EXIT_COMPLETE']};}async[_0x58b0a4(0xbd)](_0x137412,_0x2c0391){const _0x595ac7=_0x58b0a4;if(!_0x137412['startingEquipment'])return;const _0x2cc173={'defaultData':_0x137412[_0x595ac7(0xce)]},_0x7eda30=new Charactermancer_StartingEquipment({'actor':this['_actor'],'startingEquipment':_0x2cc173,'appSubTitle':_0x137412[_0x595ac7(0xe4)],'equiSpecialSource':_0x137412[_0x595ac7(0xf9)],'equiSpecialPage':_0x137412[_0x595ac7(0xb6)]}),_0x3b8dd5=await _0x7eda30[_0x595ac7(0xcc)]();if(_0x3b8dd5==null)return _0x2c0391[_0x595ac7(0xc2)]=!![],null;return _0x3b8dd5;}[_0x58b0a4(0xf3)](_0x527460,_0x4c27d1){const _0x277f38=_0x58b0a4;return DataConverterBackground[_0x277f38(0xfb)](_0x527460,_0x4c27d1);}async[_0x58b0a4(0xd5)](_0x3aa13d,_0x48b9b6,_0x20866f){const _0x16afaa=_0x58b0a4;await DataConverter[_0x16afaa(0xa9)](MiscUtil[_0x16afaa(0xf8)](this[_0x16afaa(0xd8)],_0x16afaa(0xf0),_0x16afaa(0xf0),'skills'),_0x3aa13d[_0x16afaa(0xd3)],_0x48b9b6,_0x20866f);if(_0x20866f[_0x16afaa(0xc2)])return;await DataConverter[_0x16afaa(0xa2)](MiscUtil['get'](this[_0x16afaa(0xd8)],_0x16afaa(0xf0),_0x16afaa(0xf0),'traits',_0x16afaa(0xcf)),_0x3aa13d[_0x16afaa(0xbc)],_0x48b9b6,_0x20866f);if(_0x20866f[_0x16afaa(0xc2)])return;_0x20866f[_0x16afaa(0xc2)]=await DataConverter[_0x16afaa(0xf1)](MiscUtil[_0x16afaa(0xf8)](this[_0x16afaa(0xd8)],_0x16afaa(0xf0),_0x16afaa(0xf0),_0x16afaa(0xb1),'toolProf'),_0x3aa13d[_0x16afaa(0xa6)],_0x48b9b6);}async[_0x58b0a4(0xec)](_0x4ca667,_0x558e7b,_0x59e75b){const _0xe6e9e3=_0x58b0a4;_0x59e75b[_0xe6e9e3(0xdd)]=[];const _0x2d252d=(_0x4ca667[_0xe6e9e3(0x101)]||[])[_0xe6e9e3(0xcb)](_0x462fc9=>_0x462fc9['data']&&_0x462fc9[_0xe6e9e3(0xf0)][_0xe6e9e3(0xc8)]);_0x2d252d['length']&&_0x2d252d[_0xe6e9e3(0xe1)](_0x37a601=>{const _0x3ff104=_0xe6e9e3,_0x4b31ff=MiscUtil[_0x3ff104(0xed)](_0x37a601);if(_0x4b31ff['name'])_0x4b31ff[_0x3ff104(0xe4)][_0x3ff104(0xc6)](/^.*?:\s*/,'');_0x59e75b[_0x3ff104(0xdd)][_0x3ff104(0xfc)](DataConverter['getItemActorPassive'](_0x37a601,{'mode':'player','img':'modules/'+SharedConsts[_0x3ff104(0xee)]+_0x3ff104(0xd7),'fvttType':_0x3ff104(0xb7),'source':_0x4ca667[_0x3ff104(0xf9)],'actor':this[_0x3ff104(0xd8)]}));});if(_0x59e75b[_0xe6e9e3(0xdd)][_0xe6e9e3(0xeb)])await UtilActors[_0xe6e9e3(0xae)](this[_0xe6e9e3(0xd8)],_0x59e75b[_0xe6e9e3(0xdd)]);}}export{ImportListBackground};
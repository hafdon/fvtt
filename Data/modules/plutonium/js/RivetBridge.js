const _0x2abf=['_handlePacket','entity','collection','PG_RACES','isTemp','PG_PSIONICS','rolledBy','doShowImportedNotification','pImportEntry','error','type','trim','roll','detail','PG_BESTIARY','rivet.receive-text','TASK_EXIT_FAILED','Plutonium\x20does\x20not\x20yet\x20support\x20entities\x20from\x20\x22','settings','PG_ITEMS','keydown','PG_FEATS','addEventListener','label','log','PG_CONDITIONS_DISEASES','val','PG_OPT_FEATURES','remove','page','Received\x20Rivet\x20message\x20(JSON)','textarea.rivet-transfer','last','userId','notifications','parse','PG_VARIANTRULES','_handleRollMessage','targetActorId','rivet.receive','get','Unhandled\x20Rivet\x20message\x20with\x20type\x20\x22','PG_SPELLS','dice','PG_TABLES','data'];(function(_0x167887,_0x2abffd){const _0x478101=function(_0x2cb8dc){while(--_0x2cb8dc){_0x167887['push'](_0x167887['shift']());}};_0x478101(++_0x2abffd);}(_0x2abf,0x18b));const _0x4781=function(_0x167887,_0x2abffd){_0x167887=_0x167887-0x0;let _0x478101=_0x2abf[_0x167887];return _0x478101;};const _0x17b4fd=_0x4781;'use strict';import{ImportListFeat}from'./ImportListFeat.js';import{ImportListCreature}from'./ImportListCreature.js';import{ImportListSpell}from'./ImportListSpell.js';import{ImportListItem}from'./ImportListItem.js';import{ImportListRace}from'./ImportListRace.js';import{ImportListClass}from'./ImportListClass.js';import{ImportListBackground}from'./ImportListBackground.js';import{ImportListVariantRule}from'./ImportListVariantRule.js';import{ImportListRollableTable}from'./ImportListRollableTable.js';import{ImportListPsionic}from'./ImportListPsionic.js';import{ImportListOptionalFeature}from'./ImportListOptionalFeature.js';import{ImportListConditionDisease}from'./ImportListConditionDisease.js';import{ImportListVehicle}from'./ImportListVehicle.js';import{Config}from'./Config.js';import{LGT}from'./Util.js';import{UtilApplications}from'./UtilApplications.js';import{ActorCharactermancerSourceSelector}from'./ActorCharactermancer.js';class RivetBridge{static['init'](){const _0x1275a7=_0x4781;window[_0x1275a7('0x29')](_0x1275a7('0xc'),_0x2cb8dc=>{const _0x21b1f6=_0x1275a7;console[_0x21b1f6('0x2b')](...LGT,_0x21b1f6('0x3')),this[_0x21b1f6('0x13')](_0x2cb8dc[_0x21b1f6('0x20')]);}),window['addEventListener'](_0x1275a7('0x22'),()=>{const _0x7f5beb=_0x1275a7;console[_0x7f5beb('0x2b')](...LGT,'Received\x20Rivet\x20message\x20(text)');const _0x3d307d=$(_0x7f5beb('0x4')),_0x53d256=_0x3d307d[_0x7f5beb('0x5')]()[_0x7f5beb('0x2d')]();_0x3d307d[_0x7f5beb('0x1')](),this[_0x7f5beb('0x13')](JSON[_0x7f5beb('0x8')](_0x53d256));}),document[_0x1275a7('0x29')](_0x1275a7('0x27'),async _0x2ad6a1=>{});}static[_0x17b4fd('0x13')](_0x521281){const _0x2228f2=_0x17b4fd;switch(_0x521281[_0x2228f2('0x1d')]){case _0x2228f2('0x1f'):return this[_0x2228f2('0xa')](_0x521281);case _0x2228f2('0x14'):return this['_pHandleEntityMessage'](_0x521281);default:ui[_0x2228f2('0x7')]['error'](_0x2228f2('0xe')+_0x521281[_0x2228f2('0x1d')]+'\x22!\x20You\x20may\x20need\x20to\x20update\x20your\x20extension.');}}static['_handleRollMessage'](_0x7c905e){const _0xf713d7=_0x17b4fd,_0x1d96f4=_0x7c905e[_0xf713d7('0x12')];if(!_0x7c905e[_0xf713d7('0x25')]['isSendRolls'])return;const _0x266942=new Roll(_0x1d96f4[_0xf713d7('0x10')]),_0x3064a6=[];if(_0x7c905e[_0xf713d7('0x25')]['isWhisper'])_0x3064a6['push'](game[_0xf713d7('0x6')]);_0x266942['toMessage']({'speaker':{'alias':_0x1d96f4[_0xf713d7('0x19')]},'flavor':_0x1d96f4[_0xf713d7('0x2a')],'rollMode':_0xf713d7('0x1f'),'whisper':_0x3064a6});}static async['_pHandleEntityMessage'](_0x5f4324){const _0x3dfe20=_0x17b4fd,_0x447ecb=_0x5f4324['data'],_0x347145=(Config[_0x3dfe20('0xd')]('rivet',_0x3dfe20('0xb'))||'')[_0x3dfe20('0x1e')](),_0x125502=_0x347145?Actor[_0x3dfe20('0x15')]['get'](_0x347145):'',_0x134994=(()=>{const _0xd27c59=_0x3dfe20;switch(_0x447ecb[_0xd27c59('0x2')]){case UrlUtil[_0xd27c59('0x28')]:return new ImportListFeat({'actor':_0x125502});case UrlUtil[_0xd27c59('0x21')]:return new ImportListCreature({});case UrlUtil[_0xd27c59('0xf')]:return new ImportListSpell({'actor':_0x125502});case UrlUtil[_0xd27c59('0x26')]:return new ImportListItem({'actor':_0x125502});case UrlUtil[_0xd27c59('0x16')]:return new ImportListRace({'actor':_0x125502});case UrlUtil['PG_BACKGROUNDS']:return new ImportListBackground({'actor':_0x125502});case UrlUtil[_0xd27c59('0x9')]:return new ImportListVariantRule({});case UrlUtil[_0xd27c59('0x11')]:return new ImportListRollableTable({});case UrlUtil[_0xd27c59('0x18')]:return new ImportListPsionic({'actor':_0x125502});case UrlUtil[_0xd27c59('0x0')]:return new ImportListOptionalFeature({'actor':_0x125502});case UrlUtil[_0xd27c59('0x2c')]:return new ImportListConditionDisease({'actor':_0x125502});case UrlUtil['PG_VEHICLES']:return new ImportListVehicle({'actor':_0x125502});default:return null;}})();if(!_0x134994)return ui[_0x3dfe20('0x7')][_0x3dfe20('0x1c')](_0x3dfe20('0x24')+_0x447ecb['page']+'\x22!\x20You\x20may\x20need\x20to\x20update\x20your\x20extension.');try{await _0x134994['pInit']();const _0x11ea33={};if(_0x447ecb['isTemp'])_0x11ea33[_0x3dfe20('0x17')]=!![];const _0x122811=await _0x134994[_0x3dfe20('0x1b')](_0x447ecb[_0x3dfe20('0x14')],_0x11ea33);UtilApplications[_0x3dfe20('0x1a')](_0x122811);}catch(_0x28a3ea){UtilApplications[_0x3dfe20('0x1a')]({'entity':_0x447ecb,'status':UtilApplications[_0x3dfe20('0x23')]}),setTimeout(()=>{throw _0x28a3ea;});}}}export{RivetBridge};
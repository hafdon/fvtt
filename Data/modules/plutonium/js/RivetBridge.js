'use strict';const _0x2aa1=['rivet.receive-text','1fGoIUp','doShowImportedNotification','isSendRolls','dice','PG_ITEMS','get','PG_BESTIARY','17093hvdYkb','15711jddwDd','roll','8ObSFvm','478wjEHZd','trim','PG_TABLES','PG_CONDITIONS_DISEASES','3985LJarjc','remove','PG_FEATS','page','val','\x22!\x20You\x20may\x20need\x20to\x20update\x20your\x20extension.','Received\x20Rivet\x20message\x20(text)','pImportEntry','import','textarea.rivet-transfer','_handleRollMessage','isTemp','631zAjYUs','user','13rEPXLa','role','rolledBy','data','PG_OPT_FEATURES','PG_RACES','227569glndbX','4OgVvsK','pInit','init','collection','label','error','log','PG_BACKGROUNDS','isWhisper','push','type','entity','rivet.receive','detail','42226TJWUWV','763005yAAxfa','_handlePacket','parse'];const _0xbda9=function(_0x3c39d3,_0x13d3a0){_0x3c39d3=_0x3c39d3-0x73;let _0x2aa188=_0x2aa1[_0x3c39d3];return _0x2aa188;};const _0x35f6bd=_0xbda9;(function(_0x54f888,_0x42dc0c){const _0x18da7e=_0xbda9;while(!![]){try{const _0x1db19d=parseInt(_0x18da7e(0x7d))*-parseInt(_0x18da7e(0xa6))+-parseInt(_0x18da7e(0x91))*parseInt(_0x18da7e(0x9f))+-parseInt(_0x18da7e(0x82))*-parseInt(_0x18da7e(0x89))+-parseInt(_0x18da7e(0xa5))+-parseInt(_0x18da7e(0x8c))*-parseInt(_0x18da7e(0x8a))+-parseInt(_0x18da7e(0x9d))*parseInt(_0x18da7e(0x8d))+parseInt(_0x18da7e(0x7e));if(_0x1db19d===_0x42dc0c)break;else _0x54f888['push'](_0x54f888['shift']());}catch(_0x7bab20){_0x54f888['push'](_0x54f888['shift']());}}}(_0x2aa1,0x260f2));import{ImportListFeat}from'./ImportListFeat.js';import{ImportListCreature}from'./ImportListCreature.js';import{ImportListSpell}from'./ImportListSpell.js';import{ImportListItem}from'./ImportListItem.js';import{ImportListRace}from'./ImportListRace.js';import{ImportListClass}from'./ImportListClass.js';import{ImportListBackground}from'./ImportListBackground.js';import{ImportListVariantRule}from'./ImportListVariantRule.js';import{ImportListRollableTable}from'./ImportListRollableTable.js';import{ImportListPsionic}from'./ImportListPsionic.js';import{ImportListOptionalFeature}from'./ImportListOptionalFeature.js';import{ImportListConditionDisease}from'./ImportListConditionDisease.js';import{ImportListVehicle}from'./ImportListVehicle.js';import{Config}from'./Config.js';import{LGT}from'./Util.js';import{UtilApplications}from'./UtilApplications.js';import{ActorCharactermancerSourceSelector}from'./ActorCharactermancer.js';class RivetBridge{static[_0x35f6bd(0xa8)](){const _0xee0ec4=_0x35f6bd;window['addEventListener'](_0xee0ec4(0x7b),_0x225ac4=>{const _0x4a13de=_0xee0ec4;console[_0x4a13de(0x75)](...LGT,'Received\x20Rivet\x20message\x20(JSON)'),this[_0x4a13de(0x7f)](_0x225ac4[_0x4a13de(0x7c)]);}),window['addEventListener'](_0xee0ec4(0x81),()=>{const _0x1b3489=_0xee0ec4;console['log'](...LGT,_0x1b3489(0x97));const _0xd72dda=$(_0x1b3489(0x9a)),_0x3e6a43=_0xd72dda['last']()[_0x1b3489(0x95)]();_0xd72dda[_0x1b3489(0x92)](),this[_0x1b3489(0x7f)](JSON[_0x1b3489(0x80)](_0x3e6a43));});}static['_handlePacket'](_0x4446b2){const _0x4f545a=_0x35f6bd;switch(_0x4446b2[_0x4f545a(0x79)]){case _0x4f545a(0x8b):return this[_0x4f545a(0x9b)](_0x4446b2);case _0x4f545a(0x7a):return this['_pHandleEntityMessage'](_0x4446b2);default:ui['notifications']['error']('Unhandled\x20Rivet\x20message\x20with\x20type\x20\x22'+_0x4446b2[_0x4f545a(0x79)]+'\x22!\x20You\x20may\x20need\x20to\x20update\x20your\x20extension.');}}static[_0x35f6bd(0x9b)](_0x40c1db){const _0x5c4939=_0x35f6bd,_0x56dc3a=_0x40c1db[_0x5c4939(0xa2)];if(!_0x40c1db['settings'][_0x5c4939(0x84)])return;const _0x7a6b21=new Roll(_0x56dc3a[_0x5c4939(0x85)]),_0x3fd69a=[];if(_0x40c1db['settings'][_0x5c4939(0x77)])_0x3fd69a[_0x5c4939(0x78)](game['userId']);_0x7a6b21['toMessage']({'speaker':{'alias':_0x56dc3a[_0x5c4939(0xa1)]},'flavor':_0x56dc3a[_0x5c4939(0x73)],'rollMode':_0x5c4939(0x8b),'whisper':_0x3fd69a});}static async['_pHandleEntityMessage'](_0xc4f808){const _0x2643fd=_0x35f6bd,_0x4e714f=Config[_0x2643fd(0x87)](_0x2643fd(0x99),'minimumRole');if(game[_0x2643fd(0x9e)][_0x2643fd(0xa0)]<_0x4e714f)return;const _0x13c521=_0xc4f808[_0x2643fd(0xa2)],_0x2fbe97=(Config['get']('rivet','targetActorId')||'')[_0x2643fd(0x8e)](),_0x3bdd86=_0x2fbe97?Actor[_0x2643fd(0xa9)]['get'](_0x2fbe97):'',_0x154822=(()=>{const _0x22ddd3=_0x2643fd;switch(_0x13c521[_0x22ddd3(0x94)]){case UrlUtil[_0x22ddd3(0x93)]:return new ImportListFeat({'actor':_0x3bdd86});case UrlUtil[_0x22ddd3(0x88)]:return new ImportListCreature({});case UrlUtil['PG_SPELLS']:return new ImportListSpell({'actor':_0x3bdd86});case UrlUtil[_0x22ddd3(0x86)]:return new ImportListItem({'actor':_0x3bdd86});case UrlUtil[_0x22ddd3(0xa4)]:return new ImportListRace({'actor':_0x3bdd86});case UrlUtil[_0x22ddd3(0x76)]:return new ImportListBackground({'actor':_0x3bdd86});case UrlUtil['PG_VARIANTRULES']:return new ImportListVariantRule({});case UrlUtil[_0x22ddd3(0x8f)]:return new ImportListRollableTable({});case UrlUtil['PG_PSIONICS']:return new ImportListPsionic({'actor':_0x3bdd86});case UrlUtil[_0x22ddd3(0xa3)]:return new ImportListOptionalFeature({'actor':_0x3bdd86});case UrlUtil[_0x22ddd3(0x90)]:return new ImportListConditionDisease({'actor':_0x3bdd86});case UrlUtil['PG_VEHICLES']:return new ImportListVehicle({});default:return null;}})();if(!_0x154822)return ui['notifications'][_0x2643fd(0x74)]('Plutonium\x20does\x20not\x20yet\x20support\x20entities\x20from\x20\x22'+_0x13c521['page']+_0x2643fd(0x96));try{await _0x154822[_0x2643fd(0xa7)]();const _0x14bf62={};if(_0x13c521['isTemp'])_0x14bf62[_0x2643fd(0x9c)]=!![];const _0xad38a4=await _0x154822[_0x2643fd(0x98)](_0x13c521[_0x2643fd(0x7a)],_0x14bf62);UtilApplications['doShowImportedNotification'](_0xad38a4);}catch(_0x3c1f93){UtilApplications[_0x2643fd(0x83)]({'entity':_0x13c521,'status':UtilApplications['TASK_EXIT_FAILED']}),setTimeout(()=>{throw _0x3c1f93;});}}}export{RivetBridge};
'use strict';const _0x43d9=['_pImportEntry_pImportToActor_pImportPackItem','srd','isSplitPacksActor','trim','getItemsFromHomebrew','type','importItem','sheet','_pImportEntry_getSheetItemsAmmo','_pImportEntry_pImportToActor','rarity','updateEmbeddedEntity','_vType','SOURCE_TYP_BREW',')\x20into\x20constituent\x20items:\x20','pGetItemItem','has','text-center','init','data','Item\x20\x22','\x22)\x20imported\x20with\x20errors!\x20','item','5etools-items','replace','packContents','page','toLowerCase','\x22\x20(from\x20\x22','push','isTemp','log','name','_list','_titleButtonRun','5etools','sourceLong','pGetSources','190957NvuwIW','Cost','Source','value','OwnedItem','Unhandled\x20pack\x20contents\x20type\x20\x22','quantity','_pImportEntry_pImportToDirectoryGeneric','SRD','Upload\x20File','9354331dIyVfR','consumable','7dyWKmf','_id','absorbFnBindListeners','populatePropertyAndTypeReference','itemFluff','sourceShort','205283asGhIe','URL_TO_HASH_BUILDER','sourceJsonToAbv','10574ordhfG','itemWeightToFull','_pImportEntry_pImportToActor_pAddItem','_isRadio','599ryCKND','wondrous','ascSortLower','getFolderPathMeta','doAbsorbItems','3003WNkoJV','fluff','DataSourceFile','Item','0-5','1709816DZcVCx','render','_pageFilter','uppercaseFirst','Import\x20Items','SOURCE_TYP_CUSTOM','toTitleCase','pGetItems','sourceJsonToFull','DataSourceUrl','getItemTypeName','Importing\x20item\x20\x22','_pImportEntry_pImportToDirectoryGeneric_pGetImportableData','PG_ITEMS','createEmbeddedEntity','_initCreateSheetItemHook','consumableType','pGetHomebrewSources','_page','weight','pInit','Wondrous\x20Item','1-5','Type','_actor','_titleSearch','typeText','constructor','enhanceItem','length','Rarity','pCacheAndGet','10YNZYiA','sortItems','join','_content','throwables','getData','itemValueToFull','16Bvlpwr','1340591vnVfuG','map','_fluffLookup','equipped','filterValues','stringify','mutateForFilters','Poison','1-4','isStreamerMode','source','ammoType','Name','ammo','pImportEntry','error','DataSourceSpecial','isToken','get','Error(s)\x20when\x20breaking\x20','items','valueMult','Unknown\x20Rarity'];const _0x4dc1=function(_0x5b57f4,_0x3a6a7b){_0x5b57f4=_0x5b57f4-0x1d2;let _0x43d996=_0x43d9[_0x5b57f4];return _0x43d996;};const _0x481f2c=_0x4dc1;(function(_0x31c70d,_0x42c63d){const _0x50e35f=_0x4dc1;while(!![]){try{const _0x7f7e20=parseInt(_0x50e35f(0x21e))*-parseInt(_0x50e35f(0x1db))+-parseInt(_0x50e35f(0x225))*parseInt(_0x50e35f(0x1f0))+-parseInt(_0x50e35f(0x226))+-parseInt(_0x50e35f(0x1fe))+parseInt(_0x50e35f(0x1f9))*-parseInt(_0x50e35f(0x1f4))+parseInt(_0x50e35f(0x1e7))*-parseInt(_0x50e35f(0x1ed))+parseInt(_0x50e35f(0x1e5));if(_0x7f7e20===_0x42c63d)break;else _0x31c70d['push'](_0x31c70d['shift']());}catch(_0xa955d9){_0x31c70d['push'](_0x31c70d['shift']());}}}(_0x43d9,0xf18d0));import{ImportList}from'./ImportList.js';import{Vetools}from'./Vetools.js';import{LGT}from'./Util.js';import{DataConverterItem}from'./DataConverterItem.js';import{Config}from'./Config.js';import{UtilList2}from'./UtilList2.js';import{UtilApplications}from'./UtilApplications.js';class ImportListItem extends ImportList{static[_0x481f2c(0x24f)](){const _0x43fc3d=_0x481f2c;this[_0x43fc3d(0x20d)]({'prop':_0x43fc3d(0x253),'importerName':_0x43fc3d(0x1fc)});}constructor(_0xba602c){const _0x467424=_0x481f2c;_0xba602c=_0xba602c||{},super({'title':_0x467424(0x202)},_0xba602c,{'namespace':_0x467424(0x253),'titleSearch':_0x467424(0x23a),'sidebarTab':_0x467424(0x23a),'gameProp':'items','defaultFolderPath':['Items'],'folderType':'Item','fnListSort':PageFilterItems[_0x467424(0x21f)],'pageFilter':new PageFilterItems(),'page':UrlUtil['PG_ITEMS'],'isPreviewable':!![],'isDedupable':!![]}),this[_0x467424(0x228)]=null;}async[_0x481f2c(0x1da)](){const _0x5689ea=_0x481f2c;return this[_0x5689ea(0x219)][_0x5689ea(0x1da)]();}static async[_0x481f2c(0x1da)](){const _0x598cb5=_0x481f2c,_0x1cdba9={'pPostLoad':async _0x1e12ba=>{const _0x2c5b1c=_0x4dc1;return Renderer[_0x2c5b1c(0x253)][_0x2c5b1c(0x241)](_0x1e12ba);}};return[new ImportList[(_0x598cb5(0x236))](Config[_0x598cb5(0x238)]('ui',_0x598cb5(0x22f))?_0x598cb5(0x1e3):_0x598cb5(0x1d8),async()=>(await Vetools[_0x598cb5(0x205)]())['item'],{'cacheKey':_0x598cb5(0x254),'filterTypes':[ImportList['SOURCE_TYP_OFFICIAL_ALL']],'isDefault':!![]}),new ImportList['DataSourceUrl']('Custom\x20URL','',{..._0x1cdba9,'filterTypes':[ImportList[_0x598cb5(0x203)]]}),new ImportList[(_0x598cb5(0x1fb))](_0x598cb5(0x1e4),{..._0x1cdba9,'filterTypes':[ImportList[_0x598cb5(0x203)]]}),...(await Vetools[_0x598cb5(0x20f)](_0x598cb5(0x253)))['map'](({name:_0x35d443,url:_0x26c76d})=>new ImportList[(_0x598cb5(0x207))](_0x35d443,_0x26c76d,{..._0x1cdba9,'filterTypes':[ImportList[_0x598cb5(0x24a)]]}))];}[_0x481f2c(0x223)](){const _0x59fa96=_0x481f2c;return{'isPreviewable':this['_isPreviewable'],'titleButtonRun':this[_0x59fa96(0x1d7)],'titleSearch':this[_0x59fa96(0x217)],'cols':[{'name':_0x59fa96(0x232),'width':0x3,'field':_0x59fa96(0x1d5)},{'name':'Type','width':'3-2','field':_0x59fa96(0x242)},{'name':_0x59fa96(0x1dc),'width':_0x59fa96(0x22e),'field':'cost','rowClassName':_0x59fa96(0x24e)},{'name':'Weight','width':_0x59fa96(0x22e),'field':_0x59fa96(0x211),'rowClassName':_0x59fa96(0x24e)},{'name':'A.','width':_0x59fa96(0x1fd),'field':'attunement','rowClassName':_0x59fa96(0x24e)},{'name':_0x59fa96(0x21c),'width':_0x59fa96(0x214),'field':'rarity'},{'name':_0x59fa96(0x1dd),'width':0x1,'field':_0x59fa96(0x230),'titleProp':_0x59fa96(0x1d9),'displayProp':_0x59fa96(0x1ec),'classNameProp':'sourceClassName','rowClassName':_0x59fa96(0x24e)}],'rows':this[_0x59fa96(0x221)]['map']((_0x2d135c,_0x55c4b0)=>{const _0x583bf7=_0x59fa96;return this[_0x583bf7(0x200)][_0x583bf7(0x219)][_0x583bf7(0x22c)](_0x2d135c),_0x2d135c[_0x583bf7(0x249)]=_0x2d135c['_typeListText'][_0x583bf7(0x220)](',\x20')[_0x583bf7(0x201)](),{'name':_0x2d135c['name'],'type':_0x2d135c[_0x583bf7(0x249)],'cost':_0x2d135c[_0x583bf7(0x1de)]||_0x2d135c[_0x583bf7(0x23b)]?Parser[_0x583bf7(0x224)](_0x2d135c,{'isShortForm':!![]})[_0x583bf7(0x255)](/ +/g,'\u00a0'):'—','weight':Parser[_0x583bf7(0x1f1)](_0x2d135c,!![])||'—','rarity':(_0x2d135c[_0x583bf7(0x247)]||'Unknown')[_0x583bf7(0x204)](),'attunement':_0x2d135c['_attunementCategory']==='No'?'':'×','source':_0x2d135c[_0x583bf7(0x230)],'sourceShort':Parser[_0x583bf7(0x1ef)](_0x2d135c[_0x583bf7(0x230)]),'sourceLong':Parser['sourceJsonToFull'](_0x2d135c[_0x583bf7(0x230)]),'sourceClassName':Parser['sourceJsonToColor'](_0x2d135c[_0x583bf7(0x230)]),'ix':_0x55c4b0};})};}['_activateListeners_absorbListItems'](){const _0x427736=_0x481f2c;this[_0x427736(0x1d6)][_0x427736(0x1f8)](this[_0x427736(0x221)],{'fnGetName':_0x1bad14=>_0x1bad14[_0x427736(0x1d5)],'fnGetValues':_0x27c2cd=>({'source':_0x27c2cd[_0x427736(0x230)],'type':_0x27c2cd[_0x427736(0x249)],'cost':_0x27c2cd[_0x427736(0x1de)]||0x0,'rarity':_0x27c2cd[_0x427736(0x247)],'attunement':_0x27c2cd['_attunementCategory']!=='No','weight':Parser['weightValueToNumber'](_0x27c2cd[_0x427736(0x211)]),'hash':UrlUtil['URL_TO_HASH_BUILDER'][this[_0x427736(0x210)]](_0x27c2cd)}),'fnGetData':UtilList2['absorbFnGetData'],'fnBindListeners':_0x94da60=>this[_0x427736(0x1f3)]?UtilList2['absorbFnBindListenersRadio'](this[_0x427736(0x1d6)],_0x94da60):UtilList2[_0x427736(0x1e9)](this['_list'],_0x94da60)});}async[_0x481f2c(0x212)](){const _0xe3353b=_0x481f2c;await super[_0xe3353b(0x212)](),this[_0xe3353b(0x228)]={};const _0x1db570=await Vetools['pGetItemFluff']();_0x1db570[_0xe3353b(0x1eb)]['forEach'](_0x3bdae1=>(this[_0xe3353b(0x228)][_0x3bdae1[_0xe3353b(0x230)]]=this['_fluffLookup'][_0x3bdae1[_0xe3353b(0x230)]]||{})[_0x3bdae1['name']]=_0x3bdae1),await Renderer[_0xe3353b(0x253)][_0xe3353b(0x1ea)]();}['getFolderPathMeta'](){const _0x39e7d9=_0x481f2c;return{...super[_0x39e7d9(0x1f7)](),'rarity':{'label':'Rarity','getter':_0x18c352=>(!_0x18c352[_0x39e7d9(0x247)]||_0x18c352[_0x39e7d9(0x247)]==='Unknown'?_0x39e7d9(0x23c):_0x18c352['rarity'])['toTitleCase']()},'type':{'label':_0x39e7d9(0x215),'getter':_0x268304=>{const _0x10fc0c=_0x39e7d9;if(_0x268304[_0x10fc0c(0x242)])return Renderer['item'][_0x10fc0c(0x208)](_0x268304[_0x10fc0c(0x242)])[_0x10fc0c(0x204)]();else{if(_0x268304['typeText'])return _0x268304[_0x10fc0c(0x218)];else{if(_0x268304[_0x10fc0c(0x1f5)])return _0x10fc0c(0x213);else{if(_0x268304['poison'])return _0x10fc0c(0x22d);else return'Unknown\x20Type';}}}}}};}async[_0x481f2c(0x234)](_0x3a1167,_0x5459db){const _0x470ecb=_0x481f2c;_0x5459db=_0x5459db||{},console[_0x470ecb(0x1d4)](...LGT,_0x470ecb(0x209)+_0x3a1167['name']+_0x470ecb(0x259)+Parser[_0x470ecb(0x1ef)](_0x3a1167['source'])+'\x22)');const _0x2610a2=_0x3a1167[_0x470ecb(0x1fa)]||MiscUtil[_0x470ecb(0x238)](this['_fluffLookup'],_0x3a1167[_0x470ecb(0x230)],_0x3a1167['name']),_0x20e852={'fluff':_0x2610a2};if(_0x5459db['quantity']!=null)_0x20e852[_0x470ecb(0x1e1)]=_0x5459db['quantity'];if(_0x5459db[_0x470ecb(0x1d3)])return this[_0x470ecb(0x1e2)](_0x3a1167,_0x5459db,_0x20e852);else{if(this[_0x470ecb(0x216)])return this['_pImportEntry_pImportToActor'](_0x3a1167,_0x5459db,_0x20e852);else return this[_0x470ecb(0x1e2)](_0x3a1167,_0x5459db,_0x20e852);}}async[_0x481f2c(0x246)](_0x381b59,_0x58f8fb,_0x15b2f4){const _0x501377=_0x481f2c;_0x15b2f4={..._0x15b2f4||{}},_0x15b2f4[_0x501377(0x22a)]=_0x58f8fb[_0x501377(0x22a)],_0x15b2f4['sheetItemsAmmo']=this['_pImportEntry_getSheetItemsAmmo'](_0x381b59);if(_0x381b59[_0x501377(0x256)]&&Config[_0x501377(0x238)](_0x501377(0x243),_0x501377(0x23f)))await this[_0x501377(0x23d)](_0x381b59,_0x58f8fb,_0x15b2f4);else{const _0x2c2299=await DataConverterItem[_0x501377(0x24c)](_0x381b59,_0x15b2f4);await this[_0x501377(0x1f2)](_0x2c2299);}if(this['_actor'][_0x501377(0x237)])this['_actor'][_0x501377(0x244)][_0x501377(0x1ff)]();return{'imported':{'name':_0x381b59['name'],'actor':this[_0x501377(0x216)]},'status':UtilApplications['TASK_EXIT_COMPLETE']};}async[_0x481f2c(0x23d)](_0x570c37,_0x2383cf,_0xeeccaa){const _0x3bb72b=_0x481f2c,_0x27636a=[],_0x3dd103=await Promise['all'](_0x570c37[_0x3bb72b(0x256)][_0x3bb72b(0x227)](async _0x2d4942=>{const _0x2e7518=_0x3bb72b,_0x476e0b=_0x2d4942[_0x2e7518(0x1e1)]||0x1;if(_0x2d4942['item']||typeof _0x2d4942==='string'){let [_0x166cd0,_0x12f501]=(_0x2d4942[_0x2e7518(0x253)]||_0x2d4942)['split']('|');if(!_0x12f501)_0x12f501=SRC_DMG;const _0x418e79=UrlUtil[_0x2e7518(0x1ee)][UrlUtil[_0x2e7518(0x20b)]]({'name':_0x166cd0,'source':_0x12f501}),_0x285ee5=await Renderer['hover'][_0x2e7518(0x21d)](UrlUtil[_0x2e7518(0x20b)],_0x12f501,_0x418e79);return DataConverterItem[_0x2e7518(0x24c)](_0x285ee5,{'filterValues':_0x2383cf[_0x2e7518(0x22a)],..._0xeeccaa,'quantity':_0x476e0b});}else{if(_0x2d4942['special']){const _0x3b331d={'name':_0x2d4942['special'][_0x2e7518(0x204)](),'type':'G','source':_0x570c37[_0x2e7518(0x230)],'page':_0x570c37[_0x2e7518(0x257)],'srd':_0x570c37[_0x2e7518(0x23e)]};return Renderer[_0x2e7518(0x253)][_0x2e7518(0x21a)](_0x3b331d),DataConverterItem[_0x2e7518(0x24c)](_0x3b331d,{'filterValues':_0x2383cf[_0x2e7518(0x22a)],..._0xeeccaa,'quantity':_0x476e0b});}else _0x27636a[_0x2e7518(0x1d2)](_0x2e7518(0x1e0)+JSON[_0x2e7518(0x22b)](_0x2d4942)+'\x22');}}));for(const _0x586bec of _0x3dd103['filter'](Boolean)){await this[_0x3bb72b(0x1f2)](_0x586bec);}_0x27636a[_0x3bb72b(0x21b)]&&(ui['notifications']['error'](_0x3bb72b(0x251)+_0x570c37[_0x3bb72b(0x1d5)]+'\x22\x20(from\x20\x22'+Parser[_0x3bb72b(0x1ef)](_0x570c37['source'])+_0x3bb72b(0x252)+VeCt['STR_SEE_CONSOLE']),console[_0x3bb72b(0x235)](...LGT,_0x3bb72b(0x239)+_0x570c37['name']+'\x20('+_0x570c37[_0x3bb72b(0x230)]+_0x3bb72b(0x24b)+_0x27636a[_0x3bb72b(0x220)](';\x20')));}async[_0x481f2c(0x1f2)](_0x19155d){const _0x272c02=_0x481f2c,_0xc72447=_0x19155d?.[_0x272c02(0x250)]?.[_0x272c02(0x229)],_0x1b10f7=await this[_0x272c02(0x216)][_0x272c02(0x20c)](_0x272c02(0x1df),_0x19155d,{});if(!_0x1b10f7?.[_0x272c02(0x250)]?.[_0x272c02(0x229)]&&_0xc72447)await this[_0x272c02(0x216)][_0x272c02(0x248)](_0x272c02(0x1df),{'_id':_0x1b10f7[_0x272c02(0x1e8)],'data':{'equipped':!![]}});const _0xafc4e4=new Set((Config[_0x272c02(0x238)](_0x272c02(0x243),_0x272c02(0x222))||[])[_0x272c02(0x227)](_0x31709a=>_0x31709a[_0x272c02(0x240)]()['toLowerCase']()));_0xafc4e4[_0x272c02(0x24d)]((_0x19155d[_0x272c02(0x1d5)]||'')[_0x272c02(0x258)]()[_0x272c02(0x240)]())&&await this['_actor'][_0x272c02(0x248)]('OwnedItem',{'_id':_0x1b10f7[_0x272c02(0x1e8)],'data':{'consume':{'type':_0x272c02(0x233),'target':_0x1b10f7[_0x272c02(0x1e8)],'amount':0x1}}});}[_0x481f2c(0x20a)](_0x19833e,_0x585bfb){const _0x4a5ea1=_0x481f2c;return DataConverterItem[_0x4a5ea1(0x24c)](_0x19833e,_0x585bfb);}[_0x481f2c(0x245)](_0x26bf29){const _0x4b3e98=_0x481f2c;if(!_0x26bf29[_0x4b3e98(0x231)])return null;if(!this[_0x4b3e98(0x216)])return null;return(this['_actor'][_0x4b3e98(0x250)]['items']||[])['filter'](_0xec9ed8=>_0xec9ed8[_0x4b3e98(0x242)]===_0x4b3e98(0x1e6)&&_0xec9ed8['data'][_0x4b3e98(0x20e)]==='ammo');}static['sortEntries'](_0x14eb9f,_0x330711){const _0x1402cc=_0x481f2c;if(_0x14eb9f[_0x1402cc(0x231)]&&!_0x330711[_0x1402cc(0x231)])return 0x1;if(!_0x14eb9f[_0x1402cc(0x231)]&&_0x330711['ammoType'])return-0x1;return SortUtil[_0x1402cc(0x1f6)](_0x14eb9f[_0x1402cc(0x1d5)],_0x330711['name'])||SortUtil[_0x1402cc(0x1f6)](Parser[_0x1402cc(0x206)](_0x14eb9f[_0x1402cc(0x230)]),Parser['sourceJsonToFull'](_0x330711[_0x1402cc(0x230)]));}}export{ImportListItem};
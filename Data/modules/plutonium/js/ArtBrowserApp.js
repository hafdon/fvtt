'use strict';const _0x4a8a=['<button\x20class=\x22artr__btn-lg\x20artr__btn-lg--search-controls\x22\x20title=\x22Open\x20','_preInit_addTileButton','dataTransfer','_activateListeners_pHandleDownloadAssets','getData','_doCancelPackDownload','find','Failed\x20to\x20load\x20image!\x20','appendTo','unshift','isGM','Drag-Drop\x20Images\x20as\x20Scenes','_pGetDownloadModes','artBrowser','_handleCustomDrop','\x20-\x20Tiles','_preInit_addNotesButton','push','set','_URL_CORS_ANYWHERE','MODULE_LOCATION','get','\x20-\x20Tokens','Art\x20Browser','artDirectoryPath','_ID_HIDE_TOKEN_BUTTON','uri','_preInit_getInnerToolMeta','_pCopyImageToLocalViaCorsAnywhere','preInit','_onClickLayer','html','title','maximize','backendEndpoint','https://cors-anywhere.herokuapp.com/','823512arUPPo','target','type','pInit','5087FFKfFP','append','_preInit_addMainButton','_handleConfigUpdate_toggleButton','readyState','currentTarget','plutonium.configUpdate','text','blob','host','activateListeners','info','setApplicationTitle','getPosCanvasSpace','artBrowserCopyToLocal','buttonDisplay','/template/ArtBrowserApp.handlebars','some','.artr__item__lnk-fullsize','pHandleButtonClick','\x0a\x09\x09</style>','RenderTexture','length','<span\x20class=\x22fas\x20fa-bookmark\x22></span>','onreadystatechange','_preInit_handleOpenClick','_ID_HIDE_MAIN_BUTTON','plutonium__art__hide-token-button','Plutonium\x20','.artr__search','stringify','draw','close','getMaxWindowWidth','user','834928dlTQBk','46seICci','catch','_handleConfigUpdate_toggleMainButton','onload','1396465yvBcxh','Error\x20during\x20request\x20(','plutonium__art__hide-main-button','_handleConfigUpdate_toggleTileButton','__bound__handleInstanceConfigUpdate','controls','drop','backend\x20mod','19NInsAE','app','<style\x20id=\x22','655326aKAFEB','_handleConfigUpdate_toggleNotesButton','.window-content','_preInit_addSubmenuButton','_handleConfigUpdate','_pPingImage','tokenSize','pct','getSceneControlButtons','tools','C_ART_IMAGE_MODE_TOKEN','split','initialize','init','stopPropagation','_textDownloadMode','scale','canvas','_handleInstanceConfigUpdate_cycleImportModeButton','artBrowserCancelDownloadPack','notes','status','C_ART_IMAGE_MODE_TILE','_ART_SCENE_CONTROLS_NAME','#board','open','width','round','progress','Sprite','_preInit_addTokenButton','path','bringToFront','data','C_ART_IMAGE_MODE_SCENE','plutonium__art__hide-tile-button','last','application/json','json','warn','notifications','Could\x20not\x20directly\x20load\x20image\x20from\x20','\x0a\x09\x09\x09\x09#controls\x20.scene-control[data-control=\x22ve-art__btn-scene\x22]\x20{\x0a\x09\x09\x09\x09\x09display:\x20none\x20!important;\x0a\x09\x09\x09\x09}\x0a\x09\x09\x09','render','body','_$btnCycleImportMode','_pLoadImage','_handleInstanceConfigUpdate','then','artBrowserDownloadPack','replace','_jsonDownloadMode','_pLoadImageViaCorsAnywhere','importImagesAs','_BLOCKED_HOSTS','\x20-\x20Notes','dragstart','fas\x20fa-palette','toBlob','_pLoadImageViaBackend','source','create','STR_SEE_CONSOLE','remove','error','80833GIGjZQ','naturalHeight','_ID_HIDE_NOTES_BUTTON','_BASE_TITLE','icons/svg/book.svg','_isDownloadingPack','click','bind','TokenLayer','onerror','renderer','\x22>\x0a\x09\x09\x09','_INSTANCE','C_ART_IMAGE_MODE_NOTE','P_GET_BACKEND_VERSION','closest','CORS\x20Anywhere\x20(remote\x20server)','name','_ID_HIDE_TILE_BUTTON','\x0a\x09\x09\x09\x09#controls\x20.scene-control[data-canvas-layer=\x22TokenLayer\x22]\x20.control-tool[data-tool=\x22ve-art__btn-scene\x22]\x20{\x0a\x09\x09\x09\x09\x09display:\x20none\x20!important;\x0a\x09\x09\x09\x09}\x0a\x09\x09\x09','_pDownloadPack','<span\x20class=\x22fas\x20fa-user\x22></span>','\x0a\x09\x09\x09\x09#controls\x20.scene-control[data-canvas-layer=\x22TilesLayer\x22]\x20.control-tool[data-tool=\x22ve-art__btn-scene\x22]\x20{\x0a\x09\x09\x09\x09\x09display:\x20none\x20!important;\x0a\x09\x09\x09\x09}\x0a\x09\x09\x09','addEventListener','9822sXjQaG','1lwhVRz','addClass','POST','post','\x20-\x20Scenes','plutonium__art__hide-notes-button','control'];const _0xb37a=function(_0x57b95d,_0x48c015){_0x57b95d=_0x57b95d-0x1c7;let _0x4a8a02=_0x4a8a[_0x57b95d];return _0x4a8a02;};const _0x4bbdd2=_0xb37a;(function(_0x1af929,_0x45d76f){const _0x2cde40=_0xb37a;while(!![]){try{const _0x103173=parseInt(_0x2cde40(0x222))+parseInt(_0x2cde40(0x226))*parseInt(_0x2cde40(0x256))+-parseInt(_0x2cde40(0x259))+-parseInt(_0x2cde40(0x1f6))*parseInt(_0x2cde40(0x24a))+-parseInt(_0x2cde40(0x1f7))*-parseInt(_0x2cde40(0x1de))+-parseInt(_0x2cde40(0x249))+parseInt(_0x2cde40(0x24e));if(_0x103173===_0x45d76f)break;else _0x1af929['push'](_0x1af929['shift']());}catch(_0x2fcc6a){_0x1af929['push'](_0x1af929['shift']());}}}(_0x4a8a,0x6f2e5));import{SharedConsts}from'../shared/SharedConsts.js';import{Util,LGT}from'./Util.js';import{Config}from'./Config.js';import{UtilCanvas}from'./UtilCanvas.js';import{ArtBrowser}from'../art-js/ArtBrowser.js';import{UtilApplications}from'./UtilApplications.js';class ArtBrowserApp extends Application{static[_0x4bbdd2(0x21b)](){const _0x40843f=_0x4bbdd2;Hooks['on'](_0x40843f(0x261),_0x3b4fb3=>{const _0x518814=_0x40843f;if(!game[_0x518814(0x248)][_0x518814(0x208)])return;this[_0x518814(0x228)](_0x3b4fb3),this[_0x518814(0x1ff)](_0x3b4fb3),this[_0x518814(0x277)](_0x3b4fb3),this[_0x518814(0x20e)](_0x3b4fb3);});}static[_0x4bbdd2(0x23f)](){const _0x50550f=_0x4bbdd2;if(ArtBrowserApp['_INSTANCE']){ArtBrowserApp[_0x50550f(0x1ea)][_0x50550f(0x1c8)](!![]),ArtBrowserApp[_0x50550f(0x1ea)][_0x50550f(0x21f)](),UtilApplications[_0x50550f(0x279)](ArtBrowserApp['_INSTANCE']);return;}ArtBrowserApp[_0x50550f(0x1ea)]=new ArtBrowserApp(),ArtBrowserApp['_INSTANCE'][_0x50550f(0x1c8)](!![]);}static[_0x4bbdd2(0x228)](_0x4553b8){const _0x2442fe=_0x4bbdd2,_0x140a18=_0x4553b8[_0x2442fe(0x204)](_0x4a906f=>_0x4a906f['name']===ArtBrowserApp['_ART_SCENE_CONTROLS_NAME']);if(_0x140a18)return;_0x4553b8[_0x2442fe(0x20f)]({'name':ArtBrowserApp['_ART_SCENE_CONTROLS_NAME'],'title':_0x2442fe(0x215),'icon':'fas\x20fa-palette','tools':[{'name':ArtBrowserApp[_0x2442fe(0x270)],'title':_0x2442fe(0x215),'icon':_0x2442fe(0x1d6),'onClick':()=>ui[_0x2442fe(0x281)][_0x2442fe(0x231)]('Hi!\x20You\x20shouldn\x27t\x20be\x20able\x20to\x20click\x20this,\x20something\x20has\x20gone\x20wrong.'),'button':!![]}],'activeTool':_0x2442fe(0x272)});}static[_0x4bbdd2(0x219)](_0x546ac8){const _0x5e3cc4=_0x4bbdd2;return{'name':ArtBrowserApp[_0x5e3cc4(0x270)],'title':_0x5e3cc4(0x215),'icon':'fas\x20fa-palette','onClick':()=>{const _0x14b26f=_0x5e3cc4;Config[_0x14b26f(0x210)](_0x14b26f(0x20b),_0x14b26f(0x1d2),_0x546ac8),ArtBrowserApp[_0x14b26f(0x23f)]();},'button':!![]};}static[_0x4bbdd2(0x1ff)](_0xe8b8e5){const _0x2264a9=_0x4bbdd2;this['_preInit_addSubmenuButton'](_0xe8b8e5,'tiles',Config[_0x2264a9(0x26f)]);}static['_preInit_addTokenButton'](_0x2edde0){const _0x227791=_0x4bbdd2;this[_0x227791(0x25c)](_0x2edde0,'token',Config['C_ART_IMAGE_MODE_TOKEN']);}static[_0x4bbdd2(0x20e)](_0x1d175){const _0x52db98=_0x4bbdd2;this[_0x52db98(0x25c)](_0x1d175,_0x52db98(0x26d),Config[_0x52db98(0x1eb)]);}static[_0x4bbdd2(0x25c)](_0x44eef8,_0x1fbd6b,_0x1797dc){const _0x5e7d03=_0x4bbdd2,_0x260a79=_0x44eef8['find'](_0x23ada1=>_0x23ada1[_0x5e7d03(0x1ef)]===_0x1fbd6b),_0x3a2213=_0x260a79[_0x5e7d03(0x262)][_0x5e7d03(0x237)](_0x5906ff=>_0x5906ff[_0x5e7d03(0x1ef)]===ArtBrowserApp[_0x5e7d03(0x270)]);if(_0x3a2213)return;_0x260a79['tools']['push'](this[_0x5e7d03(0x219)](_0x1797dc));}static async[_0x4bbdd2(0x1f2)](_0x510322){const _0x2b713f=_0x4bbdd2;await fetch(Config[_0x2b713f(0x220)],{'method':_0x2b713f(0x1fa),'headers':{'Content-Type':'application/json'},'body':JSON[_0x2b713f(0x244)]({'type':_0x2b713f(0x1ce),'json':_0x510322,'directoryPath':Config[_0x2b713f(0x213)]('artBrowser',_0x2b713f(0x216))})});}static[_0x4bbdd2(0x266)](){const _0x2caa4f=_0x4bbdd2,_0x2be655=ui[_0x2caa4f(0x253)][_0x2caa4f(0x21c)][_0x2caa4f(0x1e5)](ui[_0x2caa4f(0x253)]);ui[_0x2caa4f(0x253)]['_onClickLayer']=function(_0x281e9b){const _0x3a0f0e=_0x2caa4f;if(_0x281e9b[_0x3a0f0e(0x22b)]['dataset'][_0x3a0f0e(0x1fd)]===ArtBrowserApp['_ART_SCENE_CONTROLS_NAME']){ArtBrowserApp[_0x3a0f0e(0x23f)]();return;}_0x2be655(_0x281e9b);},ui[_0x2caa4f(0x253)][_0x2caa4f(0x265)](),$(document[_0x2caa4f(0x1c9)])['on'](_0x2caa4f(0x1d5),_0x2caa4f(0x238),_0x4fe05b=>{const _0xcd7e31=_0x2caa4f;_0x4fe05b[_0xcd7e31(0x267)]();}),$(_0x2caa4f(0x271))[0x0][_0x2caa4f(0x1f5)](_0x2caa4f(0x254),this[_0x2caa4f(0x20c)][_0x2caa4f(0x1e5)](this)),game['socket']['on'](_0x2caa4f(0x275),_0x5270ca=>{const _0x56bf2b=_0x2caa4f;if(_0x5270ca[_0x56bf2b(0x224)]!=='plutoniumDownloadPackImage')return;if(!ArtBrowserApp[_0x56bf2b(0x1ea)])return;if(!ArtBrowserApp[_0x56bf2b(0x1ea)]['_isDownloadingPack'])return;SceneNavigation['_onLoadProgress'](_0x5270ca[_0x56bf2b(0x22d)],_0x5270ca[_0x56bf2b(0x260)]);}),Hooks['on']('plutonium.configUpdate',()=>this[_0x2caa4f(0x25d)]()),this[_0x2caa4f(0x25d)]();}constructor(){const _0x555655=_0x4bbdd2;super({'title':ArtBrowserApp[_0x555655(0x1e1)],'template':SharedConsts[_0x555655(0x212)]+_0x555655(0x236),'height':Util['getMaxWindowHeight'](),'width':Math['max'](0x30c,Util[_0x555655(0x247)]()/0x2),'resizable':!![]}),this[_0x555655(0x1e3)]=![],this[_0x555655(0x1ca)]=null,this['__bound__handleInstanceConfigUpdate']=null;}static[_0x4bbdd2(0x25d)](){const _0x53bf4b=_0x4bbdd2;this['_handleConfigUpdate_toggleTokenButton'](),this['_handleConfigUpdate_toggleTileButton'](),this['_handleConfigUpdate_toggleNotesButton'](),this[_0x53bf4b(0x24c)]();}static['_handleConfigUpdate_toggleButton']({mode:_0x4eaaf0,id:_0x3bb946,css:_0x2a8acf}){const _0x82433e=_0x4bbdd2,_0xa012ff=Config[_0x82433e(0x213)](_0x82433e(0x20b),_0x82433e(0x235)),_0x509d00=$('#'+_0x3bb946);if(_0xa012ff[_0x4eaaf0])return _0x509d00[_0x82433e(0x1dc)]();if(_0x509d00[_0x82433e(0x23c)])return;$(_0x82433e(0x258)+_0x3bb946+_0x82433e(0x1e9)+_0x2a8acf+_0x82433e(0x23a))[_0x82433e(0x206)](document[_0x82433e(0x1c9)]);}static['_handleConfigUpdate_toggleTokenButton'](){const _0x5040c1=_0x4bbdd2;this['_handleConfigUpdate_toggleButton']({'mode':Config[_0x5040c1(0x263)],'id':Config[_0x5040c1(0x263)],'css':_0x5040c1(0x1f1)});}static[_0x4bbdd2(0x251)](){const _0x5d8b5b=_0x4bbdd2;this['_handleConfigUpdate_toggleButton']({'mode':Config[_0x5d8b5b(0x26f)],'id':ArtBrowserApp[_0x5d8b5b(0x1f0)],'css':_0x5d8b5b(0x1f4)});}static[_0x4bbdd2(0x25a)](){const _0x3cc5a4=_0x4bbdd2;this['_handleConfigUpdate_toggleButton']({'mode':Config[_0x3cc5a4(0x1eb)],'id':ArtBrowserApp[_0x3cc5a4(0x1e0)],'css':'\x0a\x09\x09\x09\x09#controls\x20.scene-control[data-canvas-layer=\x22NotesLayer\x22]\x20.control-tool[data-tool=\x22ve-art__btn-scene\x22]\x20{\x0a\x09\x09\x09\x09\x09display:\x20none\x20!important;\x0a\x09\x09\x09\x09}\x0a\x09\x09\x09'});}static['_handleConfigUpdate_toggleMainButton'](){const _0x3ddc4b=_0x4bbdd2;this[_0x3ddc4b(0x229)]({'mode':Config[_0x3ddc4b(0x27b)],'id':ArtBrowserApp[_0x3ddc4b(0x240)],'css':_0x3ddc4b(0x1c7)});}['_handleInstanceConfigUpdate'](){const _0x555b32=_0x4bbdd2;this[_0x555b32(0x26b)]();}[_0x4bbdd2(0x26b)](){const _0x486163=_0x4bbdd2,_0x567a61=Config[_0x486163(0x213)]('artBrowser',_0x486163(0x1d2))||0x0;switch(_0x567a61){case Config['C_ART_IMAGE_MODE_TOKEN']:this[_0x486163(0x1ca)][_0x486163(0x21d)]('<span\x20class=\x22fas\x20fa-cubes\x22></span>')['title']('Drag-Drop\x20Images\x20as\x20Tiles'),UtilApplications[_0x486163(0x232)](this,ArtBrowserApp['_BASE_TITLE']+_0x486163(0x20d));break;case Config[_0x486163(0x26f)]:this[_0x486163(0x1ca)][_0x486163(0x21d)](_0x486163(0x1f3))[_0x486163(0x21e)]('Drag-Drop\x20Images\x20as\x20Tokens'),UtilApplications['setApplicationTitle'](this,ArtBrowserApp[_0x486163(0x1e1)]+_0x486163(0x214));break;case Config[_0x486163(0x1eb)]:this['_$btnCycleImportMode'][_0x486163(0x21d)](_0x486163(0x23d))[_0x486163(0x21e)]('Drag-Drop\x20Images\x20as\x20Notes'),UtilApplications[_0x486163(0x232)](this,ArtBrowserApp[_0x486163(0x1e1)]+_0x486163(0x1d4));break;case Config[_0x486163(0x27b)]:this[_0x486163(0x1ca)][_0x486163(0x21d)]('<span\x20class=\x22fas\x20fa-map\x22></span>')[_0x486163(0x21e)](_0x486163(0x209)),UtilApplications[_0x486163(0x232)](this,ArtBrowserApp[_0x486163(0x1e1)]+_0x486163(0x1fb));break;default:throw new Error('Unhandled\x20drop\x20mode\x20\x22'+_0x567a61+'\x22');}}['getData'](){const _0x584e27=_0x4bbdd2;return{'owner':!![],'entity':{'name':_0x584e27(0x215)}};}[_0x4bbdd2(0x230)](_0x475dc9){const _0x29202e=_0x4bbdd2,_0x35f580=this;this['__bound__handleInstanceConfigUpdate']=this[_0x29202e(0x1cc)][_0x29202e(0x1e5)](this),Hooks['on'](_0x29202e(0x22c),this[_0x29202e(0x252)]),_0x475dc9[_0x29202e(0x1ed)](_0x29202e(0x25b))[_0x29202e(0x1f8)]('p-0')['addClass']('artb__window-outer');const _0x57b5c6=new ArtBrowser(_0x475dc9);_0x57b5c6[_0x29202e(0x20a)]=async function(){const _0x476048=_0x29202e,_0x4ebc95=[this[_0x476048(0x268)],this[_0x476048(0x1d0)]];return await Config[_0x476048(0x1ec)]&&_0x4ebc95[_0x476048(0x207)]({'name':'Foundry\x20Assets','isMultipleFilesOnly':!![],'pDownloadAsMultipleFiles':(_0x45a09a,_0x2a6778,_0x271e4a)=>_0x35f580[_0x476048(0x201)](_0x45a09a,_0x2a6778,_0x271e4a)}),_0x4ebc95;},_0x57b5c6[_0x29202e(0x225)]()[_0x29202e(0x1cd)](()=>{const _0x337a06=_0x29202e,_0x779c83=_0x475dc9[_0x337a06(0x204)](_0x337a06(0x243)),_0x43115e=$('<button\x20class=\x22artr__btn-lg\x20artr__btn-lg--search-controls\x20mr-1\x22\x20title=\x22Cancel\x20running\x20downloads\x22><span\x20class=\x22fas\x20fa-stop\x22></span></button>')['click'](()=>ArtBrowserApp[_0x337a06(0x203)]());this['_$btnCycleImportMode']=$('<button\x20class=\x22artr__btn-lg\x20artr__btn-lg--search-controls\x20mr-1\x22><span\x20class=\x22fas\x20fa-spinner\x22></span></button>')[_0x337a06(0x1e4)](()=>{const _0x21bae4=_0x337a06,_0x40b836=Config[_0x21bae4(0x213)](_0x21bae4(0x20b),'importImagesAs')||0x0,_0x502f4a=_0x40b836===Config['C_ART_IMAGE_MODE_SCENE']?Config[_0x21bae4(0x263)]:_0x40b836+0x1;Config[_0x21bae4(0x210)]('artBrowser',_0x21bae4(0x1d2),_0x502f4a);});const _0x320488=$(_0x337a06(0x1fe)+(Config[_0x337a06(0x213)]('ui','isStreamerMode')?'':_0x337a06(0x242))+'Config\x20window\x22><span\x20class=\x22fas\x20fa-cogs\x22></span></button>')[_0x337a06(0x1e4)](_0x3e6b31=>Config[_0x337a06(0x239)](_0x3e6b31,_0x337a06(0x20b)));$$`<div class="flex-v-center h-100">
					<div class="artr__search__divider mx-2"></div>
					<div class="flex-v-center">${_0x43115e}</div>
					<div class="flex-v-center">${this['_$btnCycleImportMode']}</div>
					<div class="flex-v-center">${_0x320488}</div>
				</div>`['appendTo'](_0x779c83),this[_0x337a06(0x252)]();});}static async[_0x4bbdd2(0x203)](){const _0x547ecb=_0x4bbdd2;await fetch(Config[_0x547ecb(0x220)],{'method':_0x547ecb(0x1fa),'headers':{'Content-Type':_0x547ecb(0x27e)},'body':JSON[_0x547ecb(0x244)]({'type':_0x547ecb(0x26c)})});}async[_0x4bbdd2(0x201)](_0x3ea603,_0x2704d5,_0xc07986){const _0xdb5f98=_0x4bbdd2;try{ArtBrowserApp[_0xdb5f98(0x1ea)][_0xdb5f98(0x1e3)]=!![],await ArtBrowserApp['_pDownloadPack'](_0x3ea603);}catch(_0x45f8f3){ArtBrowserApp[_0xdb5f98(0x1ea)][_0xdb5f98(0x1e3)]=![];}_0x2704d5+0x1===_0xc07986&&(ArtBrowserApp[_0xdb5f98(0x1ea)][_0xdb5f98(0x1e3)]=![],ui[_0xdb5f98(0x281)][_0xdb5f98(0x231)]('Download\x20complete!\x20Images\x20will\x20be\x20available\x20in\x20your\x20\x22User\x20Data\x22\x20directory.'));}static[_0x4bbdd2(0x20c)](_0x4d856c){const _0x492403=_0x4bbdd2;let _0x35fd19;try{const _0xd7266d=_0x4d856c[_0x492403(0x200)][_0x492403(0x202)](_0x492403(0x27e));if(!_0xd7266d)return;_0x35fd19=JSON['parse'](_0xd7266d);}catch(_0x3e7db9){ui[_0x492403(0x281)][_0x492403(0x1dd)](_0x492403(0x205)+VeCt[_0x492403(0x1db)]),setTimeout(()=>{throw _0x3e7db9;});}if(!_0x35fd19||_0x35fd19[_0x492403(0x224)]!=='ve-Art')return;return this['_pDoLoadAndPlaceImage'](_0x4d856c,_0x35fd19)[_0x492403(0x24b)](_0x1db30f=>{const _0x1434be=_0x492403;ui['notifications']['error'](_0x1434be(0x205)+VeCt[_0x1434be(0x1db)]),setTimeout(()=>{throw _0x1db30f;});}),![];}static async['_pDoLoadAndPlaceImage'](_0x77d2fc,_0x333615){const _0x3f103d=_0x4bbdd2,_0x3d0648=Config['get'](_0x3f103d(0x20b),_0x3f103d(0x1d2))||0x0;let _0x4dfab2=_0x333615[_0x3f103d(0x218)],_0x6aa26d,_0x552f87,_0x52d69c;if(await this[_0x3f103d(0x25e)](_0x4dfab2))_0x6aa26d=await this[_0x3f103d(0x1cb)](_0x4dfab2);else{const _0x4ea2a4=await Config[_0x3f103d(0x1ec)];console[_0x3f103d(0x280)](...LGT,_0x3f103d(0x282)+_0x4dfab2+'\x20--\x20falling\x20back\x20on\x20alternate\x20loader:\x20'+(_0x4ea2a4?_0x3f103d(0x255):_0x3f103d(0x1ee))+'.');try{if(_0x4ea2a4){const {url:_0x44b4b8,image:_0x51caf9}=await this['_pLoadImageViaBackend'](_0x4dfab2);_0x4dfab2=_0x44b4b8,_0x6aa26d=_0x51caf9;}else{const {url:_0x2ecb1c,image:_0x2e4754}=await this[_0x3f103d(0x1d1)](_0x4dfab2);_0x4dfab2=_0x2ecb1c,_0x6aa26d=_0x2e4754;}}catch(_0x508c25){console['error'](...LGT,'Failed\x20to\x20load\x20image!',_0x508c25),ui['notifications']['error']('Failed\x20to\x20load\x20image!\x20'+VeCt[_0x3f103d(0x1db)]);return;}}const _0x24d76a=()=>{const _0x40d890=_0x3f103d;let _0x4148f3=_0x4dfab2[_0x40d890(0x264)]('/')[_0x40d890(0x27d)]();try{_0x4148f3=decodeURIComponent(_0x4148f3),_0x4148f3=_0x4148f3[_0x40d890(0x264)]('.')[0x0],_0x4148f3=_0x4148f3[_0x40d890(0x1cf)](/_/g,'\x20')[_0x40d890(0x1cf)](/\s+/g,'\x20')[_0x40d890(0x1cf)](/\d+\s*[xX*]\s*\d+/g,'');}catch(_0x3d60f9){}return _0x4148f3;};_0x552f87=_0x6aa26d['naturalWidth'],_0x52d69c=_0x6aa26d[_0x3f103d(0x1df)];let _0x1ae3d0=Config[_0x3f103d(0x213)](_0x3f103d(0x20b),_0x3f103d(0x269));switch(_0x3d0648){case Config[_0x3f103d(0x263)]:{const _0x40b838=UtilCanvas['getPosCanvasSpace'](_0x77d2fc,'TilesLayer');Tile[_0x3f103d(0x1da)]({'img':encodeURL(_0x4dfab2),'width':Math['round'](_0x552f87*_0x1ae3d0),'height':Math[_0x3f103d(0x274)](_0x52d69c*_0x1ae3d0),'hidden':![],'scale':_0x1ae3d0,'x':_0x40b838['x'],'y':_0x40b838['y']});break;}case Config[_0x3f103d(0x26f)]:{const _0x360f6d=UtilCanvas[_0x3f103d(0x233)](_0x77d2fc,_0x3f103d(0x1e6)),_0x560420=Config[_0x3f103d(0x213)](_0x3f103d(0x20b),_0x3f103d(0x25f))||0x1;Token[_0x3f103d(0x1da)]({'name':'-','x':_0x360f6d['x'],'y':_0x360f6d['y'],'img':encodeURL(_0x4dfab2),'width':_0x560420,'height':_0x560420,'scale':0x1});break;}case Config[_0x3f103d(0x1eb)]:{const _0x31113a=UtilCanvas[_0x3f103d(0x233)](_0x77d2fc,'NotesLayer'),_0x3e6c79=await JournalEntry[_0x3f103d(0x1da)]({'name':_0x24d76a(),'img':encodeURL(_0x4dfab2)});Note['create']({'entryId':_0x3e6c79['id'],'icon':_0x3f103d(0x1e2),'iconSize':0x28,'text':'','x':_0x31113a['x'],'y':_0x31113a['y']});break;}case Config['C_ART_IMAGE_MODE_SCENE']:{const _0x5f5361={'name':_0x24d76a(),'active':!![],'navigation':!![],'img':encodeURL(_0x4dfab2),'width':Math[_0x3f103d(0x274)](_0x552f87*_0x1ae3d0),'height':Math[_0x3f103d(0x274)](_0x52d69c*_0x1ae3d0)},_0xb7ad1e=await Scene[_0x3f103d(0x1da)](_0x5f5361,{'renderSheet':!![]});canvas[_0x3f103d(0x245)]();break;}}}static async['_pPingImage'](_0xadce42){const _0x2a8ef9=_0x4bbdd2;let _0x4a17d6;try{_0x4a17d6=new URL(_0xadce42);}catch(_0x406cd2){}if(_0x4a17d6&&ArtBrowserApp[_0x2a8ef9(0x1d3)][_0x4a17d6[_0x2a8ef9(0x22f)]])return![];try{const _0x14d5c6=await fetch(_0xadce42);return await _0x14d5c6[_0x2a8ef9(0x22e)](),!![];}catch(_0x1b635f){if(_0x4a17d6)ArtBrowserApp[_0x2a8ef9(0x1d3)][_0x4a17d6['host']]=!![];return![];}}static['_pLoadImage'](_0x434f19){return new Promise((_0x5e1e48,_0x4e5879)=>{const _0x12ae22=_0xb37a,_0x101c9e=new Image();_0x101c9e[_0x12ae22(0x1e7)]=_0x19047d=>_0x4e5879(_0x19047d),_0x101c9e[_0x12ae22(0x24d)]=()=>_0x5e1e48(_0x101c9e),_0x101c9e['src']=_0x434f19;});}static async['_pCopyImageToLocalViaBackend'](_0x798ac8){const _0x11f664=_0x4bbdd2,_0x28dd27=await fetch(Config[_0x11f664(0x220)],{'method':_0x11f664(0x1fa),'headers':{'Content-Type':_0x11f664(0x27e)},'body':JSON[_0x11f664(0x244)]({'type':_0x11f664(0x234),'url':_0x798ac8,'directoryPath':Config['get'](_0x11f664(0x20b),_0x11f664(0x216))})}),_0x1afdc7=await _0x28dd27[_0x11f664(0x27f)]();return _0x1afdc7[_0x11f664(0x278)];}static async[_0x4bbdd2(0x1d8)](_0x2f9f5e){const _0x23bab6=_0x4bbdd2,_0x42cfe0=await this['_pCopyImageToLocalViaBackend'](_0x2f9f5e),_0x28f388=await this[_0x23bab6(0x1cb)](_0x42cfe0);return{'url':_0x42cfe0,'image':_0x28f388};}static async[_0x4bbdd2(0x21a)](_0x34b6a1){const _0x12aa9b=_0x4bbdd2,_0x36e9fe=''+ArtBrowserApp[_0x12aa9b(0x211)]+_0x34b6a1,_0x1b832a=async _0x573bab=>{const _0x47acce=_0x12aa9b,_0x122ff2=Config[_0x47acce(0x213)](_0x47acce(0x20b),_0x47acce(0x216)),_0x13d896=_0x34b6a1['split']('/')[_0x47acce(0x27d)]()+'.webp',_0x3af84e=(_0x122ff2+'/'+_0x13d896)[_0x47acce(0x1cf)](/\/+/g,'/'),_0x2eeeb0=new FormData();return _0x2eeeb0[_0x47acce(0x227)](_0x47acce(0x223),_0x122ff2),_0x2eeeb0[_0x47acce(0x227)]('upload',_0x573bab,_0x13d896),_0x2eeeb0[_0x47acce(0x227)](_0x47acce(0x1d9),_0x47acce(0x27a)),await new Promise((_0x4e0ca2,_0x37d98b)=>{const _0x22f81d=_0x47acce,_0x1ebe5a=new XMLHttpRequest();_0x1ebe5a[_0x22f81d(0x272)](_0x22f81d(0x1f9),'/upload',!![]),_0x1ebe5a[_0x22f81d(0x23e)]=()=>{const _0x376133=_0x22f81d;if(_0x1ebe5a[_0x376133(0x22a)]!==0x4)return;if(_0x1ebe5a[_0x376133(0x26e)]<0xc8||_0x1ebe5a[_0x376133(0x26e)]>=0x190)_0x37d98b(new Error(_0x376133(0x24f)+_0x1ebe5a[_0x376133(0x26e)]+')'));_0x4e0ca2();},_0x1ebe5a['send'](_0x2eeeb0);}),_0x3af84e;},_0x31dbae=await loadTexture(_0x36e9fe),_0x5730a7=new PIXI[(_0x12aa9b(0x276))](_0x31dbae),_0x387c7b=PIXI[_0x12aa9b(0x23b)][_0x12aa9b(0x1da)](_0x5730a7[_0x12aa9b(0x273)],_0x5730a7['height']);canvas['app'][_0x12aa9b(0x1e8)][_0x12aa9b(0x1c8)](_0x5730a7,_0x387c7b);const _0x6327f=new PIXI[(_0x12aa9b(0x276))](_0x387c7b),_0x335ff4=await new Promise((_0x1538d2,_0x306aab)=>{const _0x2d8b15=_0x12aa9b;canvas[_0x2d8b15(0x257)]['renderer']['extract'][_0x2d8b15(0x26a)](_0x6327f)[_0x2d8b15(0x1d7)](async _0x466bfa=>{try{const _0x5528ea=await _0x1b832a(_0x466bfa);_0x1538d2(_0x5528ea);}catch(_0x5bbd40){_0x306aab(_0x5bbd40);}},'image/webp',0x1);});return _0x387c7b['destroy'](!![]),_0x335ff4;}static async[_0x4bbdd2(0x1d1)](_0x26fdd0){const _0x49dd26=_0x4bbdd2,_0x162e03=await this[_0x49dd26(0x21a)](_0x26fdd0),_0x2e13f9=await this[_0x49dd26(0x1cb)](_0x162e03);return{'url':_0x162e03,'image':_0x2e13f9};}async[_0x4bbdd2(0x246)](..._0x3e0c57){const _0x4e7658=_0x4bbdd2;await super['close'](..._0x3e0c57),Hooks['off'](_0x4e7658(0x22c),this['__bound__handleInstanceConfigUpdate']),ArtBrowserApp[_0x4e7658(0x1ea)]=null;}}ArtBrowserApp[_0x4bbdd2(0x1d3)]={},ArtBrowserApp[_0x4bbdd2(0x1ea)]=null,ArtBrowserApp[_0x4bbdd2(0x217)]=_0x4bbdd2(0x241),ArtBrowserApp[_0x4bbdd2(0x1f0)]=_0x4bbdd2(0x27c),ArtBrowserApp[_0x4bbdd2(0x1e0)]=_0x4bbdd2(0x1fc),ArtBrowserApp[_0x4bbdd2(0x240)]=_0x4bbdd2(0x250),ArtBrowserApp[_0x4bbdd2(0x211)]=_0x4bbdd2(0x221),ArtBrowserApp[_0x4bbdd2(0x270)]='ve-art__btn-scene',ArtBrowserApp[_0x4bbdd2(0x1e1)]=_0x4bbdd2(0x215);export{ArtBrowserApp};
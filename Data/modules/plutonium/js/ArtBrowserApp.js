'use strict';const _0x3702=['getData','_preInit_addTokenButton','max','_doCancelPackDownload','_ART_SCENE_CONTROLS_NAME','_ID_HIDE_NOTES_BUTTON','backendEndpoint','_activateListeners_pHandleDownloadAssets','control','stringify','open','<style\x20id=\x22','_preInit_addMainButton','https://cors-anywhere.herokuapp.com/','_preInit_handleOpenClick','_pDownloadPack','maximize','pct','_handleConfigUpdate_toggleTokenButton','Could\x20not\x20directly\x20load\x20image\x20from\x20','title','isGM','uri','<button\x20class=\x22artr__btn-lg\x20artr__btn-lg--search-controls\x20mr-1\x22><span\x20class=\x22fas\x20fa-spinner\x22></span></button>','status','off','json','artBrowserCancelDownloadPack','last','getSceneControlButtons','type','_handleConfigUpdate_toggleMainButton','controls','_onClickLayer','\x0a\x09\x09</style>','token','artBrowserDownloadPack','_pLoadImageViaBackend','_$btnCycleImportMode','get','onerror','\x20-\x20Tokens','push','308776HxxxqW','C_ART_IMAGE_MODE_NOTE','<button\x20class=\x22artr__btn-lg\x20artr__btn-lg--search-controls\x20mr-1\x22\x20title=\x22Cancel\x20running\x20downloads\x22><span\x20class=\x22fas\x20fa-stop\x22></span></button>','C_ART_IMAGE_MODE_SCENE','Error\x20during\x20request\x20(','appendTo','extract','artDirectoryPath','closest','application/json','704576bpOMYA','#board','currentTarget','ve-art__btn-scene','fas\x20fa-palette','_isDownloadingPack','_handleInstanceConfigUpdate','unshift','name','toBlob','POST','plutoniumDownloadPackImage','artBrowser','progress','data','send','remove','Drag-Drop\x20Images\x20as\x20Tokens','tiles','.artr__item__lnk-fullsize','_INSTANCE','537649QTYedx','then','_handleInstanceConfigUpdate_cycleImportModeButton','Hi!\x20You\x20shouldn\x27t\x20be\x20able\x20to\x20click\x20this,\x20something\x20has\x20gone\x20wrong.','activateListeners','backend\x20mod','draw','<span\x20class=\x22fas\x20fa-bookmark\x22></span>','P_GET_BACKEND_VERSION','info','_pDoLoadAndPlaceImage','_ID_HIDE_MAIN_BUTTON','create','post','preInit','close','_preInit_addSubmenuButton','split','replace','buttonDisplay','plutonium__art__hide-token-button','ve-Art','path','<span\x20class=\x22fas\x20fa-user\x22></span>','find','/template/ArtBrowserApp.handlebars','Art\x20Browser','error','__bound__handleInstanceConfigUpdate','_URL_CORS_ANYWHERE','_preInit_getInnerToolMeta','html','getPosCanvasSpace','pHandleButtonClick','_pGetDownloadModes','upload','length','image/webp','422226iZWoHF','Plutonium\x20','round','_ID_HIDE_TILE_BUTTON','dragstart','canvas','addClass','CORS\x20Anywhere\x20(remote\x20server)','_handleConfigUpdate_toggleNotesButton','_preInit_addTileButton','notes','\x0a\x09\x09\x09\x09#controls\x20.scene-control[data-canvas-layer=\x22TokenLayer\x22]\x20.control-tool[data-tool=\x22ve-art__btn-scene\x22]\x20{\x0a\x09\x09\x09\x09\x09display:\x20none\x20!important;\x0a\x09\x09\x09\x09}\x0a\x09\x09\x09','_pLoadImage','src','Failed\x20to\x20load\x20image!\x20','socket','text','_handleConfigUpdate_toggleButton','\x20-\x20Notes','onreadystatechange','\x0a\x09\x09\x09\x09#controls\x20.scene-control[data-control=\x22ve-art__btn-scene\x22]\x20{\x0a\x09\x09\x09\x09\x09display:\x20none\x20!important;\x0a\x09\x09\x09\x09}\x0a\x09\x09\x09','C_ART_IMAGE_MODE_TILE','readyState','click','host','_ID_HIDE_TOKEN_BUTTON','p-0','tokenSize','artBrowserCopyToLocal','_BASE_TITLE','795245aPQBmw','_preInit_addNotesButton','/upload','source','body','\x22>\x0a\x09\x09\x09','plutonium__art__hide-tile-button','_BLOCKED_HOSTS','bind','Sprite','\x20-\x20Scenes','getMaxWindowWidth','TokenLayer','Unhandled\x20drop\x20mode\x20\x22','1001741crEFiL','plutonium__art__hide-main-button','169651LXfBFQ','\x20--\x20falling\x20back\x20on\x20alternate\x20loader:\x20','addEventListener','<button\x20class=\x22artr__btn-lg\x20artr__btn-lg--search-controls\x22\x20title=\x22Open\x20','C_ART_IMAGE_MODE_TOKEN','bringToFront','\x0a\x09\x09\x09\x09#controls\x20.scene-control[data-canvas-layer=\x22NotesLayer\x22]\x20.control-tool[data-tool=\x22ve-art__btn-scene\x22]\x20{\x0a\x09\x09\x09\x09\x09display:\x20none\x20!important;\x0a\x09\x09\x09\x09}\x0a\x09\x09\x09','catch','notifications','drop','STR_SEE_CONSOLE','tools','naturalWidth','_handleConfigUpdate_toggleTileButton','app','stopPropagation','set','append','plutonium.configUpdate','importImagesAs','_handleCustomDrop','Drag-Drop\x20Images\x20as\x20Scenes','user','.webp','icons/svg/book.svg','setApplicationTitle','_pCopyImageToLocalViaCorsAnywhere','_handleConfigUpdate','renderer','_textDownloadMode','TilesLayer','\x0a\x09\x09\x09\x09#controls\x20.scene-control[data-canvas-layer=\x22TilesLayer\x22]\x20.control-tool[data-tool=\x22ve-art__btn-scene\x22]\x20{\x0a\x09\x09\x09\x09\x09display:\x20none\x20!important;\x0a\x09\x09\x09\x09}\x0a\x09\x09\x09'];const _0x5558=function(_0x5a2004,_0x2af568){_0x5a2004=_0x5a2004-0x1c4;let _0x370261=_0x3702[_0x5a2004];return _0x370261;};const _0x1c2d97=_0x5558;(function(_0x413943,_0x84ae6e){const _0x1427e0=_0x5558;while(!![]){try{const _0x95416f=parseInt(_0x1427e0(0x246))+-parseInt(_0x1427e0(0x1f1))+-parseInt(_0x1427e0(0x23c))+-parseInt(_0x1427e0(0x281))+parseInt(_0x1427e0(0x1ef))+parseInt(_0x1427e0(0x25b))+-parseInt(_0x1427e0(0x1e1));if(_0x95416f===_0x84ae6e)break;else _0x413943['push'](_0x413943['shift']());}catch(_0x5bf5f0){_0x413943['push'](_0x413943['shift']());}}}(_0x3702,0x85ce4));import{SharedConsts}from'../shared/SharedConsts.js';import{Util,LGT}from'./Util.js';import{Config}from'./Config.js';import{UtilCanvas}from'./UtilCanvas.js';import{ArtBrowser}from'../art-js/ArtBrowser.js';import{UtilApplications}from'./UtilApplications.js';class ArtBrowserApp extends Application{static[_0x1c2d97(0x269)](){const _0x13dfa5=_0x1c2d97;Hooks['on'](_0x13dfa5(0x22e),_0x57c8eb=>{const _0x405c03=_0x13dfa5;if(!game[_0x405c03(0x207)][_0x405c03(0x226)])return;this['_preInit_addMainButton'](_0x57c8eb),this[_0x405c03(0x1cc)](_0x57c8eb),this[_0x405c03(0x212)](_0x57c8eb),this[_0x405c03(0x1e2)](_0x57c8eb);});}static['_preInit_handleOpenClick'](){const _0x35aee8=_0x1c2d97;if(ArtBrowserApp[_0x35aee8(0x25a)]){ArtBrowserApp[_0x35aee8(0x25a)]['render'](!![]),ArtBrowserApp[_0x35aee8(0x25a)][_0x35aee8(0x221)](),UtilApplications[_0x35aee8(0x1f6)](ArtBrowserApp[_0x35aee8(0x25a)]);return;}ArtBrowserApp['_INSTANCE']=new ArtBrowserApp(),ArtBrowserApp['_INSTANCE']['render'](!![]);}static[_0x1c2d97(0x21d)](_0x185d39){const _0x350c44=_0x1c2d97,_0x1f687a=_0x185d39[_0x350c44(0x273)](_0xa1ecf8=>_0xa1ecf8[_0x350c44(0x24e)]===ArtBrowserApp['_ART_SCENE_CONTROLS_NAME']);if(_0x1f687a)return;_0x185d39[_0x350c44(0x23b)]({'name':ArtBrowserApp[_0x350c44(0x215)],'title':_0x350c44(0x275),'icon':_0x350c44(0x24a),'tools':[{'name':ArtBrowserApp[_0x350c44(0x215)],'title':_0x350c44(0x275),'icon':_0x350c44(0x24a),'onClick':()=>ui['notifications'][_0x350c44(0x264)](_0x350c44(0x25e)),'button':!![]}],'activeTool':'open'});}static[_0x1c2d97(0x279)](_0x224e7e){const _0x84c1c1=_0x1c2d97;return{'name':ArtBrowserApp[_0x84c1c1(0x215)],'title':_0x84c1c1(0x275),'icon':_0x84c1c1(0x24a),'onClick':()=>{const _0x5c5125=_0x84c1c1;Config[_0x5c5125(0x201)](_0x5c5125(0x252),_0x5c5125(0x204),_0x224e7e),ArtBrowserApp[_0x5c5125(0x21f)]();},'button':!![]};}static[_0x1c2d97(0x1cc)](_0x15f99b){const _0x2abed0=_0x1c2d97;this['_preInit_addSubmenuButton'](_0x15f99b,_0x2abed0(0x258),Config[_0x2abed0(0x1d8)]);}static[_0x1c2d97(0x212)](_0x3e3fdf){const _0x47a068=_0x1c2d97;this['_preInit_addSubmenuButton'](_0x3e3fdf,_0x47a068(0x234),Config[_0x47a068(0x1f5)]);}static[_0x1c2d97(0x1e2)](_0xc0cd0b){const _0x83ea26=_0x1c2d97;this[_0x83ea26(0x26b)](_0xc0cd0b,_0x83ea26(0x1cd),Config[_0x83ea26(0x23d)]);}static[_0x1c2d97(0x26b)](_0x136634,_0x289deb,_0x210ccc){const _0x20cfa0=_0x1c2d97,_0xc41928=_0x136634['find'](_0x2af3bc=>_0x2af3bc[_0x20cfa0(0x24e)]===_0x289deb),_0x43e7ed=_0xc41928[_0x20cfa0(0x1fc)]['some'](_0x135053=>_0x135053[_0x20cfa0(0x24e)]===ArtBrowserApp[_0x20cfa0(0x215)]);if(_0x43e7ed)return;_0xc41928[_0x20cfa0(0x1fc)][_0x20cfa0(0x23b)](this[_0x20cfa0(0x279)](_0x210ccc));}static async[_0x1c2d97(0x220)](_0x26bdd8){const _0x5d255e=_0x1c2d97;await fetch(Config['backendEndpoint'],{'method':_0x5d255e(0x268),'headers':{'Content-Type':'application/json'},'body':JSON[_0x5d255e(0x21a)]({'type':_0x5d255e(0x235),'json':_0x26bdd8,'directoryPath':Config[_0x5d255e(0x238)](_0x5d255e(0x252),_0x5d255e(0x243))})});}static['init'](){const _0x30da1d=_0x1c2d97,_0x431ea8=ui[_0x30da1d(0x231)]['_onClickLayer'][_0x30da1d(0x1e9)](ui[_0x30da1d(0x231)]);ui[_0x30da1d(0x231)][_0x30da1d(0x232)]=function(_0x5ed6fd){const _0x4cea7c=_0x30da1d;if(_0x5ed6fd[_0x4cea7c(0x248)]['dataset'][_0x4cea7c(0x219)]===ArtBrowserApp[_0x4cea7c(0x215)]){ArtBrowserApp['_preInit_handleOpenClick']();return;}_0x431ea8(_0x5ed6fd);},ui[_0x30da1d(0x231)]['initialize'](),$(document[_0x30da1d(0x1e5)])['on'](_0x30da1d(0x1c7),_0x30da1d(0x259),_0x4362a5=>{const _0x501430=_0x30da1d;_0x4362a5[_0x501430(0x200)]();}),$(_0x30da1d(0x247))[0x0][_0x30da1d(0x1f3)](_0x30da1d(0x1fa),this[_0x30da1d(0x205)]['bind'](this)),game[_0x30da1d(0x1d2)]['on'](_0x30da1d(0x253),_0x17d916=>{const _0x2f0334=_0x30da1d;if(_0x17d916[_0x2f0334(0x22f)]!==_0x2f0334(0x251))return;if(!ArtBrowserApp[_0x2f0334(0x25a)])return;if(!ArtBrowserApp[_0x2f0334(0x25a)][_0x2f0334(0x24b)])return;SceneNavigation['_onLoadProgress'](_0x17d916[_0x2f0334(0x1d3)],_0x17d916[_0x2f0334(0x222)]);}),Hooks['on'](_0x30da1d(0x203),()=>this[_0x30da1d(0x20c)]()),this['_handleConfigUpdate']();}constructor(){const _0x10f8df=_0x1c2d97;super({'title':ArtBrowserApp[_0x10f8df(0x1e0)],'template':SharedConsts['MODULE_LOCATION']+_0x10f8df(0x274),'height':Util['getMaxWindowHeight'](),'width':Math[_0x10f8df(0x213)](0x258,Util[_0x10f8df(0x1ec)]()/0x2),'resizable':!![]}),this['_isDownloadingPack']=![],this[_0x10f8df(0x237)]=null,this['__bound__handleInstanceConfigUpdate']=null;}static[_0x1c2d97(0x20c)](){const _0x544449=_0x1c2d97;this[_0x544449(0x223)](),this[_0x544449(0x1fe)](),this[_0x544449(0x1cb)](),this[_0x544449(0x230)]();}static[_0x1c2d97(0x1d4)]({mode:_0x2e1300,id:_0x3ed639,css:_0x1cdc0d}){const _0x11d148=_0x1c2d97,_0x1e83c6=Config[_0x11d148(0x238)](_0x11d148(0x252),_0x11d148(0x26e)),_0x341ed9=$('#'+_0x3ed639);if(_0x1e83c6[_0x2e1300])return _0x341ed9[_0x11d148(0x256)]();if(_0x341ed9[_0x11d148(0x27f)])return;$(_0x11d148(0x21c)+_0x3ed639+_0x11d148(0x1e6)+_0x1cdc0d+_0x11d148(0x233))['appendTo'](document[_0x11d148(0x1e5)]);}static[_0x1c2d97(0x223)](){const _0x38e8b0=_0x1c2d97;this[_0x38e8b0(0x1d4)]({'mode':Config[_0x38e8b0(0x1f5)],'id':Config['C_ART_IMAGE_MODE_TOKEN'],'css':_0x38e8b0(0x1ce)});}static[_0x1c2d97(0x1fe)](){const _0x15ca23=_0x1c2d97;this[_0x15ca23(0x1d4)]({'mode':Config[_0x15ca23(0x1d8)],'id':ArtBrowserApp['_ID_HIDE_TILE_BUTTON'],'css':_0x15ca23(0x210)});}static['_handleConfigUpdate_toggleNotesButton'](){const _0x5ceb20=_0x1c2d97;this[_0x5ceb20(0x1d4)]({'mode':Config['C_ART_IMAGE_MODE_NOTE'],'id':ArtBrowserApp[_0x5ceb20(0x216)],'css':_0x5ceb20(0x1f7)});}static[_0x1c2d97(0x230)](){const _0x4cb591=_0x1c2d97;this[_0x4cb591(0x1d4)]({'mode':Config[_0x4cb591(0x23f)],'id':ArtBrowserApp[_0x4cb591(0x266)],'css':_0x4cb591(0x1d7)});}[_0x1c2d97(0x24c)](){const _0x124ce7=_0x1c2d97;this[_0x124ce7(0x25d)]();}[_0x1c2d97(0x25d)](){const _0x5d5dd6=_0x1c2d97,_0x4d836e=Config[_0x5d5dd6(0x238)](_0x5d5dd6(0x252),_0x5d5dd6(0x204))||0x0;switch(_0x4d836e){case Config[_0x5d5dd6(0x1f5)]:this['_$btnCycleImportMode'][_0x5d5dd6(0x27a)]('<span\x20class=\x22fas\x20fa-cubes\x22></span>')[_0x5d5dd6(0x225)]('Drag-Drop\x20Images\x20as\x20Tiles'),UtilApplications[_0x5d5dd6(0x20a)](this,ArtBrowserApp[_0x5d5dd6(0x1e0)]+'\x20-\x20Tiles');break;case Config[_0x5d5dd6(0x1d8)]:this[_0x5d5dd6(0x237)][_0x5d5dd6(0x27a)](_0x5d5dd6(0x272))[_0x5d5dd6(0x225)](_0x5d5dd6(0x257)),UtilApplications[_0x5d5dd6(0x20a)](this,ArtBrowserApp['_BASE_TITLE']+_0x5d5dd6(0x23a));break;case Config[_0x5d5dd6(0x23d)]:this['_$btnCycleImportMode'][_0x5d5dd6(0x27a)](_0x5d5dd6(0x262))['title']('Drag-Drop\x20Images\x20as\x20Notes'),UtilApplications['setApplicationTitle'](this,ArtBrowserApp[_0x5d5dd6(0x1e0)]+_0x5d5dd6(0x1d5));break;case Config['C_ART_IMAGE_MODE_SCENE']:this[_0x5d5dd6(0x237)][_0x5d5dd6(0x27a)]('<span\x20class=\x22fas\x20fa-map\x22></span>')[_0x5d5dd6(0x225)](_0x5d5dd6(0x206)),UtilApplications[_0x5d5dd6(0x20a)](this,ArtBrowserApp[_0x5d5dd6(0x1e0)]+_0x5d5dd6(0x1eb));break;default:throw new Error(_0x5d5dd6(0x1ee)+_0x4d836e+'\x22');}}['getData'](){return{'owner':!![],'entity':{'name':'Art\x20Browser'}};}[_0x1c2d97(0x25f)](_0x2d4167){const _0x2811b7=_0x1c2d97,_0x260480=this;this[_0x2811b7(0x277)]=this[_0x2811b7(0x24c)]['bind'](this),Hooks['on']('plutonium.configUpdate',this[_0x2811b7(0x277)]),_0x2d4167[_0x2811b7(0x244)]('.window-content')[_0x2811b7(0x1c9)](_0x2811b7(0x1dd))[_0x2811b7(0x1c9)]('artb__window-outer');const _0x175f1c=new ArtBrowser(_0x2d4167);_0x175f1c[_0x2811b7(0x27d)]=async function(){const _0x27657e=_0x2811b7,_0x19dbf4=[this[_0x27657e(0x20e)],this['_jsonDownloadMode']];return await Config[_0x27657e(0x263)]&&_0x19dbf4[_0x27657e(0x24d)]({'name':'Foundry\x20Assets','isMultipleFilesOnly':!![],'pDownloadAsMultipleFiles':(_0x578182,_0x5f0e1c,_0x3c568a)=>_0x260480['_activateListeners_pHandleDownloadAssets'](_0x578182,_0x5f0e1c,_0x3c568a)}),_0x19dbf4;},_0x175f1c['pInit']()[_0x2811b7(0x25c)](()=>{const _0x50c6a7=_0x2811b7,_0x297d29=_0x2d4167[_0x50c6a7(0x273)]('.artr__search'),_0xa5d9b6=$(_0x50c6a7(0x23e))[_0x50c6a7(0x1da)](()=>ArtBrowserApp[_0x50c6a7(0x214)]());this[_0x50c6a7(0x237)]=$(_0x50c6a7(0x228))[_0x50c6a7(0x1da)](()=>{const _0x45afc0=_0x50c6a7,_0x177827=Config[_0x45afc0(0x238)](_0x45afc0(0x252),_0x45afc0(0x204))||0x0,_0x4aec03=_0x177827===Config[_0x45afc0(0x23f)]?Config[_0x45afc0(0x1f5)]:_0x177827+0x1;Config[_0x45afc0(0x201)]('artBrowser',_0x45afc0(0x204),_0x4aec03);});const _0x484218=$(_0x50c6a7(0x1f4)+(Config[_0x50c6a7(0x238)]('ui','isStreamerMode')?'':_0x50c6a7(0x1c4))+'Config\x20window\x22><span\x20class=\x22fas\x20fa-cogs\x22></span></button>')[_0x50c6a7(0x1da)](_0x12fe7d=>Config[_0x50c6a7(0x27c)](_0x12fe7d,_0x50c6a7(0x252)));$$`<div class="flex-v-center h-100">
					<div class="artr__search__divider mx-2"></div>
					<div class="flex-v-center">${_0xa5d9b6}</div>
					<div class="flex-v-center">${this['_$btnCycleImportMode']}</div>
					<div class="flex-v-center">${_0x484218}</div>
				</div>`[_0x50c6a7(0x241)](_0x297d29),this[_0x50c6a7(0x277)]();});}static async[_0x1c2d97(0x214)](){const _0x4322eb=_0x1c2d97;await fetch(Config[_0x4322eb(0x217)],{'method':'post','headers':{'Content-Type':_0x4322eb(0x245)},'body':JSON[_0x4322eb(0x21a)]({'type':_0x4322eb(0x22c)})});}async[_0x1c2d97(0x218)](_0x1528ca,_0x436d9d,_0x48f835){const _0x495c59=_0x1c2d97;try{ArtBrowserApp['_INSTANCE'][_0x495c59(0x24b)]=!![],await ArtBrowserApp[_0x495c59(0x220)](_0x1528ca);}catch(_0x325837){ArtBrowserApp[_0x495c59(0x25a)][_0x495c59(0x24b)]=![];}_0x436d9d+0x1===_0x48f835&&(ArtBrowserApp[_0x495c59(0x25a)][_0x495c59(0x24b)]=![],ui['notifications']['info']('Download\x20complete!\x20Images\x20will\x20be\x20available\x20in\x20your\x20\x22User\x20Data\x22\x20directory.'));}static[_0x1c2d97(0x205)](_0x35cbf3){const _0x338612=_0x1c2d97;let _0x3c6579;try{const _0x211982=_0x35cbf3['dataTransfer'][_0x338612(0x211)](_0x338612(0x245));if(!_0x211982)return;_0x3c6579=JSON['parse'](_0x211982);}catch(_0x4a6bb2){ui[_0x338612(0x1f9)][_0x338612(0x276)](_0x338612(0x1d1)+VeCt[_0x338612(0x1fb)]),setTimeout(()=>{throw _0x4a6bb2;});}if(!_0x3c6579||_0x3c6579[_0x338612(0x22f)]!==_0x338612(0x270))return;return this[_0x338612(0x265)](_0x35cbf3,_0x3c6579)[_0x338612(0x1f8)](_0x3273c2=>{const _0xe60882=_0x338612;ui[_0xe60882(0x1f9)][_0xe60882(0x276)](_0xe60882(0x1d1)+VeCt[_0xe60882(0x1fb)]),setTimeout(()=>{throw _0x3273c2;});}),![];}static async['_pDoLoadAndPlaceImage'](_0x26f4af,_0x53cadd){const _0x12bc53=_0x1c2d97,_0x3f26d5=Config[_0x12bc53(0x238)](_0x12bc53(0x252),'importImagesAs')||0x0;let _0x1c299c=_0x53cadd[_0x12bc53(0x227)],_0x31acc1,_0x4206c9,_0x2c4847;if(await this['_pPingImage'](_0x1c299c))_0x31acc1=await this[_0x12bc53(0x1cf)](_0x1c299c);else{const _0x103c28=await Config[_0x12bc53(0x263)];console['warn'](...LGT,_0x12bc53(0x224)+_0x1c299c+_0x12bc53(0x1f2)+(_0x103c28?_0x12bc53(0x260):_0x12bc53(0x1ca))+'.');try{if(_0x103c28){const {url:_0x54ca3b,image:_0x325097}=await this['_pLoadImageViaBackend'](_0x1c299c);_0x1c299c=_0x54ca3b,_0x31acc1=_0x325097;}else{const {url:_0x5d8383,image:_0x48504b}=await this['_pLoadImageViaCorsAnywhere'](_0x1c299c);_0x1c299c=_0x5d8383,_0x31acc1=_0x48504b;}}catch(_0x56af0c){console[_0x12bc53(0x276)](...LGT,'Failed\x20to\x20load\x20image!',_0x56af0c),ui[_0x12bc53(0x1f9)]['error'](_0x12bc53(0x1d1)+VeCt[_0x12bc53(0x1fb)]);return;}}const _0x39c340=()=>{const _0x5ada00=_0x12bc53;let _0x1a07f3=_0x1c299c[_0x5ada00(0x26c)]('/')['last']();try{_0x1a07f3=decodeURIComponent(_0x1a07f3),_0x1a07f3=_0x1a07f3[_0x5ada00(0x26c)]('.')[0x0],_0x1a07f3=_0x1a07f3['replace'](/_/g,'\x20')[_0x5ada00(0x26d)](/\s+/g,'\x20')[_0x5ada00(0x26d)](/\d+\s*[xX*]\s*\d+/g,'');}catch(_0x5d2284){}return _0x1a07f3;};_0x4206c9=_0x31acc1[_0x12bc53(0x1fd)],_0x2c4847=_0x31acc1['naturalHeight'];let _0x2e5857=Config[_0x12bc53(0x238)](_0x12bc53(0x252),'scale');switch(_0x3f26d5){case Config[_0x12bc53(0x1f5)]:{const _0x5e6eea=UtilCanvas[_0x12bc53(0x27b)](_0x26f4af,_0x12bc53(0x20f));Tile[_0x12bc53(0x267)]({'img':encodeURL(_0x1c299c),'width':Math[_0x12bc53(0x1c5)](_0x4206c9*_0x2e5857),'height':Math['round'](_0x2c4847*_0x2e5857),'hidden':![],'scale':_0x2e5857,'x':_0x5e6eea['x'],'y':_0x5e6eea['y']});break;}case Config['C_ART_IMAGE_MODE_TILE']:{const _0x5931a0=UtilCanvas[_0x12bc53(0x27b)](_0x26f4af,_0x12bc53(0x1ed)),_0x4130a1=Config[_0x12bc53(0x238)](_0x12bc53(0x252),_0x12bc53(0x1de))||0x1;Token[_0x12bc53(0x267)]({'name':'-','x':_0x5931a0['x'],'y':_0x5931a0['y'],'img':encodeURL(_0x1c299c),'width':_0x4130a1,'height':_0x4130a1,'scale':0x1});break;}case Config[_0x12bc53(0x23d)]:{const _0x8a9680=UtilCanvas['getPosCanvasSpace'](_0x26f4af,'NotesLayer'),_0x26a937=await JournalEntry[_0x12bc53(0x267)]({'name':_0x39c340(),'img':encodeURL(_0x1c299c)});Note[_0x12bc53(0x267)]({'entryId':_0x26a937['id'],'icon':_0x12bc53(0x209),'iconSize':0x28,'text':'','x':_0x8a9680['x'],'y':_0x8a9680['y']});break;}case Config[_0x12bc53(0x23f)]:{const _0x57044e={'name':_0x39c340(),'active':!![],'navigation':!![],'img':encodeURL(_0x1c299c),'width':Math[_0x12bc53(0x1c5)](_0x4206c9*_0x2e5857),'height':Math[_0x12bc53(0x1c5)](_0x2c4847*_0x2e5857)},_0x5b8bcf=await Scene['create'](_0x57044e,{'renderSheet':!![]});canvas[_0x12bc53(0x261)]();break;}}}static async['_pPingImage'](_0xc1858d){const _0x561b62=_0x1c2d97;let _0x420bd1;try{_0x420bd1=new URL(_0xc1858d);}catch(_0x5a2bff){}if(_0x420bd1&&ArtBrowserApp[_0x561b62(0x1e8)][_0x420bd1[_0x561b62(0x1db)]])return![];try{const _0x2c29b4=await fetch(_0xc1858d);return await _0x2c29b4['blob'](),!![];}catch(_0x5a32ca){if(_0x420bd1)ArtBrowserApp[_0x561b62(0x1e8)][_0x420bd1['host']]=!![];return![];}}static[_0x1c2d97(0x1cf)](_0x3969bc){return new Promise((_0x5cad21,_0x4194ec)=>{const _0x67e145=_0x5558,_0x239875=new Image();_0x239875[_0x67e145(0x239)]=_0x19207e=>_0x4194ec(_0x19207e),_0x239875['onload']=()=>_0x5cad21(_0x239875),_0x239875[_0x67e145(0x1d0)]=_0x3969bc;});}static async['_pCopyImageToLocalViaBackend'](_0x5098c1){const _0x1e73cd=_0x1c2d97,_0x4c0ad7=await fetch(Config[_0x1e73cd(0x217)],{'method':_0x1e73cd(0x268),'headers':{'Content-Type':'application/json'},'body':JSON[_0x1e73cd(0x21a)]({'type':_0x1e73cd(0x1df),'url':_0x5098c1,'directoryPath':Config[_0x1e73cd(0x238)]('artBrowser',_0x1e73cd(0x243))})}),_0x5d7522=await _0x4c0ad7[_0x1e73cd(0x22b)]();return _0x5d7522[_0x1e73cd(0x271)];}static async[_0x1c2d97(0x236)](_0x563db2){const _0x1c0431=_0x1c2d97,_0x3e94f5=await this['_pCopyImageToLocalViaBackend'](_0x563db2),_0x4df6b1=await this[_0x1c0431(0x1cf)](_0x3e94f5);return{'url':_0x3e94f5,'image':_0x4df6b1};}static async[_0x1c2d97(0x20b)](_0x1721fb){const _0x540205=_0x1c2d97,_0x349f77=''+ArtBrowserApp['_URL_CORS_ANYWHERE']+_0x1721fb,_0x5ee0ca=async _0x5790b0=>{const _0x2717ca=_0x5558,_0x41ddb6=Config[_0x2717ca(0x238)](_0x2717ca(0x252),_0x2717ca(0x243)),_0x4a97d7=_0x1721fb[_0x2717ca(0x26c)]('/')[_0x2717ca(0x22d)]()+_0x2717ca(0x208),_0xb6f18e=(_0x41ddb6+'/'+_0x4a97d7)[_0x2717ca(0x26d)](/\/+/g,'/'),_0x3714e2=new FormData();return _0x3714e2[_0x2717ca(0x202)]('target',_0x41ddb6),_0x3714e2[_0x2717ca(0x202)](_0x2717ca(0x27e),_0x5790b0,_0x4a97d7),_0x3714e2['append'](_0x2717ca(0x1e4),_0x2717ca(0x254)),await new Promise((_0x56dbba,_0x2f3db0)=>{const _0x4fdf96=_0x2717ca,_0x10b9c1=new XMLHttpRequest();_0x10b9c1[_0x4fdf96(0x21b)](_0x4fdf96(0x250),_0x4fdf96(0x1e3),!![]),_0x10b9c1[_0x4fdf96(0x1d6)]=()=>{const _0x1a36f4=_0x4fdf96;if(_0x10b9c1[_0x1a36f4(0x1d9)]!==0x4)return;if(_0x10b9c1['status']<0xc8||_0x10b9c1[_0x1a36f4(0x229)]>=0x190)_0x2f3db0(new Error(_0x1a36f4(0x240)+_0x10b9c1[_0x1a36f4(0x229)]+')'));_0x56dbba();},_0x10b9c1[_0x4fdf96(0x255)](_0x3714e2);}),_0xb6f18e;},_0x152a85=await loadTexture(_0x349f77),_0x5db5e2=new PIXI[(_0x540205(0x1ea))](_0x152a85),_0x589c80=PIXI['RenderTexture'][_0x540205(0x267)](_0x5db5e2['width'],_0x5db5e2['height']);canvas[_0x540205(0x1ff)]['renderer']['render'](_0x5db5e2,_0x589c80);const _0x4090cd=new PIXI[(_0x540205(0x1ea))](_0x589c80),_0x434a72=await new Promise((_0x3655bf,_0x5638d6)=>{const _0x46767b=_0x540205;canvas[_0x46767b(0x1ff)][_0x46767b(0x20d)][_0x46767b(0x242)][_0x46767b(0x1c8)](_0x4090cd)[_0x46767b(0x24f)](async _0x227084=>{try{const _0x355aff=await _0x5ee0ca(_0x227084);_0x3655bf(_0x355aff);}catch(_0x510243){_0x5638d6(_0x510243);}},_0x46767b(0x280),0x1);});return _0x589c80['destroy'](!![]),_0x434a72;}static async['_pLoadImageViaCorsAnywhere'](_0xe7e0e2){const _0x2f2c87=_0x1c2d97,_0x1c1f73=await this[_0x2f2c87(0x20b)](_0xe7e0e2),_0x21b1a3=await this['_pLoadImage'](_0x1c1f73);return{'url':_0x1c1f73,'image':_0x21b1a3};}async[_0x1c2d97(0x26a)](..._0x5d306c){const _0x15f846=_0x1c2d97;await super[_0x15f846(0x26a)](..._0x5d306c),Hooks[_0x15f846(0x22a)](_0x15f846(0x203),this[_0x15f846(0x277)]),ArtBrowserApp[_0x15f846(0x25a)]=null;}}ArtBrowserApp[_0x1c2d97(0x1e8)]={},ArtBrowserApp[_0x1c2d97(0x25a)]=null,ArtBrowserApp[_0x1c2d97(0x1dc)]=_0x1c2d97(0x26f),ArtBrowserApp[_0x1c2d97(0x1c6)]=_0x1c2d97(0x1e7),ArtBrowserApp[_0x1c2d97(0x216)]='plutonium__art__hide-notes-button',ArtBrowserApp[_0x1c2d97(0x266)]=_0x1c2d97(0x1f0),ArtBrowserApp[_0x1c2d97(0x278)]=_0x1c2d97(0x21e),ArtBrowserApp[_0x1c2d97(0x215)]=_0x1c2d97(0x249),ArtBrowserApp[_0x1c2d97(0x1e0)]=_0x1c2d97(0x275);export{ArtBrowserApp};
const _0x4a99=['_LAST_MESSAGE_META','hasClass','395511GdJTqm','content','_doBindTrimmedTopEventHandlers','prependTo','_MODAL_STACK','isCompactChat','_ELEMENTS_WITH_FOCUS','JournalSheet.prototype._disableFields','_getEntity','\x22.\x20This\x20can\x20be\x20changed\x20in\x20the\x20Config.','_doAddToExistingMessages','setFlag','deleteChatMessage','set','_id','.mode\x20select','\x20Journal\x20Entry\x20(SHIFT\x20for\x20All\x20Entries)\x22\x20onclick=\x22window.PlutPatcher.TextEditor.handleToggleClick(event)\x22\x20type=\x22button\x22>','/mod-template/journal/sheet.handlebars','_data','text','_applyActiveEffects','_DID_PATCH','initBtnSortHandlers','Failed\x20to\x20refresh\x20token\x20\x22','Collapse','_isMetaMatch','handleToggleClick','BUTTON','<i\x20class=\x22fas\x20fa-link\x22></i>','replace','_HAS_PATCHED','_CACHED_CLASS','anchor','<i\x20class=\x22fa\x20fa-caret-square-left\x22></i>','copy','data-plut-is-expanded','isEnableUrlEmbeds','shiftKey','array','template','has','isUseExtendedActiveEffectsParser','<i\x20class=\x22fa\x20fa-caret-square-down\x22></i>','floor','1879306zEjsKw','handleConfigUpdate','position','z-index','hasFocus','_getMessageMeta','number','entityClass','_SPEAKER_TIMEOUT_MSEC','name','getAvailableEffectsLookup','button[data-plut-is-expanded]','author','val','splice','isFixDrawingFreehandMinDistance','push','style','nodeName','parent','OWNER','renderActiveEffectConfig','doApplyPatch','ready','duration','157ltxmXE','actor','Actor','closest','bringToFront','currentTarget','color','SRD','PLUT.Reset','_handleConfigUpdate','plutonium.configUpdate','sort','renderChatMessage','entities','\x22><img\x20src=\x22','chat','values','sight','refresh','split','MODULE_NAME','_$getExistingRender','reset','dragResistance','\x22\x20class=\x22jemb__img\x22></a></div>\x0a\x09\x09\x09</div>','#text','pGetUserString','isFastAnimations','$ele','\x22\x20title=\x22','Jquery','.message','maximize','GameKeyboard','placeables','TextEditor.enrichHTML','data','973475SJvvOG','isEscapeable','click','301385RggBZI','isDisplayActiveEffectAttributeKeyHelper','string','element','ENTITY_PERMISSIONS','Token.prototype._onUpdateTokenActor','blur','_handleExpandCollapse','owner','743931vTtvvq','render','TextEditor','forceClose','MODULE_LOCATION','alias','each','_doRemoveFromExistingMessages','_applyActiveEffects_mutValues','_getEntityEmbed','ACTIVE_EFFECT_MODES','blind','removeChild','isRemoveDisplays','concat','mousemove.','_onHookActiveEffectConfig','entityId','key','test','JournalEntry','default','settings','addItem','preventDefault','disabled','ve-hidden','attr','isDebug','6185CVBlWj','classList','_getEntryContextOptions','ascSort','map','find','childNodes','windows','chatmsg__trim-bottom','remove','_EVENT_NAMESPACE','close','header.message-header','update','sheetMode','_LAST_CONFIG_STATE','rivet','chatmsg__trim-top--inspecting','activeLayer','roll','isGM','586409dApzwI','Rivet\x20content\x20will\x20now\x20be\x20imported\x20to\x20Actor\x20\x22','mouseleave.','_onEscape','visible','stringify','OVERRIDE','info','localize','object','getFlag','LIBWRAPPER_MODE_WRAPPER','OBSERVER','journalEntries','ActiveEffectConfig','Expand','</div>\x0a\x09\x09\x09\x09','<div\x20class=\x22w-100\x20flex-col\x22>\x0a\x09\x09\x09\x09<div\x20class=\x22flex-v-center\x20mb-1\x20jemb__wrp-lnk\x22>','applyActiveEffect','_MAX_RECURSION_DEPTH','warn','isEnableContentEmbeds','contains','overrides','findIndex','\x0a\x09\x09\x09\x09<div\x20class=\x22w-100\x20jemb__wrp-content\x20','null','Token.prototype._onUpdate','<div\x20class=\x22veapp__list\x20h-100\x20mb-1\x22></div>','_getEntityPermissions','getKeyFromCustomKey','_handleConfigUpdate_displayDamageDealt_doUpdateDisplay','_plut_IsPopout','_doPatchJournalContextMenuOptions','<div\x20class=\x22mb-1\x20bold\x20veapp__msg-error\x22>Warning:\x20too\x20many\x20recursive\x20embeds!\x20Have\x20you\x20made\x20an\x20infinite\x20loop?</div>','value','mouseover.','_handled','changes','_getNextArgs','clone','_findNameNode','\x22><a\x20target=\x22_blank\x20w-100\x22\x20href=\x22','register','data.attributes.ac.value','Enter\x20iframe\x20or\x20URL','.animateMovement','_doHandleExistingMessage','releaseAll','<input\x20type=\x22search\x22\x20class=\x22search\x20w-100\x20form-control\x22\x20placeholder=\x22Find\x20keys...\x22>','trim','CanvasAnimation.animateLinear','total','<a\x20class=\x22entity-link\x20broken\x22><i\x20class=\x22fas\x20fa-unlink\x22></i>\x20','_CACHED_MOUSE_INTERACTION_MANAGER_OPTIONS','context','MODULE_TITLE','prepareData','user','get','notifications','_applyActiveEffects_getFullRollData','getActiveEffectType','isDisplayDamageDealt','FLAG_IFRAME_URL','max','removeAttribute','boolean','getRollData','Find\x20Active\x20Effect\x20Attribute\x20Key','_handleConfigUpdate_displayDamageDealt_doAddDisplay','toggle','_handleRenderChatMessage','prev','.module-header','collection','doRemovePatch','error','title','Token','handleHookApplyActiveEffect','Token.prototype._onUpdateBaseActor','path','next','priority','src','\x22\x20was\x20not\x20valid!','</div>\x0a\x09\x09\x09</div>','min','menu','mouseInteractionManager','JournalSheet','</a>','reduce','tokens','Drawing','_handleDeleteChatMessage','Could\x20not\x20determine\x20z-index\x20for\x20app\x20','-chat','chatmsg__trim-top','deepEquals','ChatMessage','init','startsWith','targetActorId','undefined','INPUT','CanvasAnimation','_doEnableToggleButtons','effects','options','defaultOptions','image','<button\x20class=\x22no-grow\x20no-shrink\x20text-center\x20p-0\x20m-0\x20mr-1\x20aeff__btn-search\x22\x20title=\x22Find\x20Active\x20Effect\x20Attribute\x20Key\x22><i\x20class=\x22fas\x20fa-search\x22></i></button>','_plutonium_xDispDamageDealt','filter','_controlled','_LAST_IS_ENABLED','fontSize','Text','entries','target','stopPropagation','bind','attributes','\x20<i>(you\x20do\x20not\x20have\x20sufficient\x20permissions\x20to\x20view\x20this\x20journal\x20entry)</i></a>','_sheetMode','_getBtnHtmlToggle','closeAllMenus','off','isAutoExpandContentEmbeds','permission','actors','\x20Journal\x20Entry\x20(SHIFT\x20for\x20All\x20Entries)','getElementsByTagName','sheetClass','timestamp','effect','SettingsConfig','length','Token.prototype.refresh','LIBWRAPPER_MODE_MIXED','Set\x20as\x20Rivet\x20Target','getAvailableEffects','Unhandled\x20custom\x20active\x20effect\x20key:\x20','addClass','html','<i\x20class=\x22fas\x20fa-hammer\x22></i>','.editor','Actor.prototype.applyActiveEffects','removeClass','.message[data-message-id=\x22','enrichHTML','forEach','jemb__btn-toggle','_createEntityLink','_doPatchActorContextMenuOptions'];const _0x5637=function(_0x45c2d5,_0x514037){_0x45c2d5=_0x45c2d5-0xd1;let _0x4a997a=_0x4a99[_0x45c2d5];return _0x4a997a;};const _0x1325cd=_0x5637;(function(_0xccd59a,_0x4e2aca){const _0x1b363a=_0x5637;while(!![]){try{const _0x1b050d=parseInt(_0x1b363a(0x176))+-parseInt(_0x1b363a(0x16d))+-parseInt(_0x1b363a(0x16a))+parseInt(_0x1b363a(0x1a8))+-parseInt(_0x1b363a(0x100))+-parseInt(_0x1b363a(0x145))*parseInt(_0x1b363a(0x193))+parseInt(_0x1b363a(0x12c));if(_0x1b050d===_0x4e2aca)break;else _0xccd59a['push'](_0xccd59a['shift']());}catch(_0xa04aa3){_0xccd59a['push'](_0xccd59a['shift']());}}}(_0x4a99,0x8aba6));import{SharedConsts}from'../shared/SharedConsts.js';import{Consts}from'./Consts.js';import{UtilApplications}from'./UtilApplications.js';import{Config}from'./Config.js';import{LGT,Util}from'./Util.js';import{libWrapper,UtilLibWrapper}from'./PatcherLibWrapper.js';import{Menu}from'./Menu.js';import{UtilActiveEffects}from'./UtilActiveEffects.js';class Patcher{static[_0x1325cd(0x20e)](){const _0xd799d9=_0x1325cd;Hooks['on'](_0xd799d9(0x1ba),Patcher[_0xd799d9(0x147)][_0xd799d9(0x1f8)][_0xd799d9(0xdc)](Patcher[_0xd799d9(0x147)])),this[_0xd799d9(0xfd)](),this['_doPatchJournalContextMenuOptions'](),Patcher[_0xd799d9(0x1f7)][_0xd799d9(0x20e)](),Patcher[_0xd799d9(0x178)][_0xd799d9(0x20e)](),Patcher[_0xd799d9(0x20d)][_0xd799d9(0x20e)](),Patcher[_0xd799d9(0xeb)][_0xd799d9(0x20e)](),Patcher['CanvasAnimation'][_0xd799d9(0x20e)](),Patcher[_0xd799d9(0x163)][_0xd799d9(0x20e)](),Patcher[_0xd799d9(0x166)][_0xd799d9(0x20e)](),Patcher[_0xd799d9(0x1b6)][_0xd799d9(0x20e)](),Patcher[_0xd799d9(0x147)][_0xd799d9(0x20e)](),Hooks['on'](_0xd799d9(0x14f),()=>this[_0xd799d9(0x14e)]()),this[_0xd799d9(0x14e)]();if(Config[_0xd799d9(0x1e3)](_0xd799d9(0x146),_0xd799d9(0x129)))(Actor['collection'][_0xd799d9(0x152)]||[])[_0xd799d9(0xfa)](_0x4be289=>_0x4be289[_0xd799d9(0x1e1)]());Hooks['on']('canvasReady',()=>{const _0x13bb11=_0xd799d9;Patcher[_0x13bb11(0x207)][_0x13bb11(0x12d)]();});}static[_0x1325cd(0x14e)](){const _0x484980=_0x1325cd;Patcher[_0x484980(0x1f7)][_0x484980(0x12d)](),Patcher[_0x484980(0x207)][_0x484980(0x12d)](),Patcher[_0x484980(0x20d)]['handleConfigUpdate'](),JournalSheet_Plutonium[_0x484980(0x12d)]();}static['_doPatchActorContextMenuOptions'](){const _0x56d77f=_0x1325cd,_0x3bf79b=ui['actors'][_0x56d77f(0x195)][_0x56d77f(0xdc)](ui[_0x56d77f(0xe5)]);ui['actors'][_0x56d77f(0x195)]=()=>{const _0x44ffb4=_0x56d77f,_0x2f277b=_0x3bf79b();return _0x2f277b[_0x44ffb4(0x13c)]({'name':_0x44ffb4(0xef),'icon':_0x44ffb4(0xf4),'condition':_0x869095=>{const _0x227bbb=_0x44ffb4,_0x5be093=ActorDirectory['collection'][_0x227bbb(0x1e3)](_0x869095[_0x227bbb(0x169)]('entityId'));return _0x5be093[_0x227bbb(0x175)];},'callback':_0x1c4823=>{const _0x173677=_0x44ffb4,_0x14aee2=ActorDirectory['collection']['get'](_0x1c4823['data']('entityId'));Config[_0x173677(0x10d)](_0x173677(0x1a3),_0x173677(0x210),_0x14aee2['id']),ui[_0x173677(0x1e4)][_0x173677(0x1af)](_0x173677(0x1a9)+_0x14aee2['id']+_0x173677(0x109));}}),_0x2f277b;};}static[_0x1325cd(0x1c9)](){const _0x426108=_0x1325cd,_0x5cc1f8=ui['journal']['_getEntryContextOptions'][_0x426108(0xdc)](ui['journal']);ui['journal'][_0x426108(0x195)]=()=>{const _0x481f57=_0x426108,_0x2778f8=_0x5cc1f8(),_0x32cd3c=_0x2778f8[_0x481f57(0x1c0)](_0x59c198=>_0x59c198[_0x481f57(0x135)]==='PERMISSION.Configure');if(!~_0x32cd3c)return _0x2778f8;return _0x2778f8[_0x481f57(0x13a)](_0x32cd3c+0x1,0x0,{'name':'Set\x20Embed\x20URL','icon':_0x481f57(0x11c),'condition':_0x2cecc4=>{const _0x1c627d=_0x481f57;if(!Config[_0x1c627d(0x1e3)](_0x1c627d(0x1b5),_0x1c627d(0x124)))return![];const _0x2e0537=JournalDirectory[_0x1c627d(0x1f3)][_0x1c627d(0x1e3)](_0x2cecc4['data']('entityId'));return _0x2e0537[_0x1c627d(0x175)];},'callback':async _0x11888f=>{const _0x5231f8=_0x481f57,_0x310601=JournalDirectory['collection']['get'](_0x11888f[_0x5231f8(0x169)](_0x5231f8(0x187))),_0x34371c=await _0x310601[_0x5231f8(0x1b2)](SharedConsts[_0x5231f8(0x159)],Consts[_0x5231f8(0x1e8)]);let _0x14d941=await InputUiUtil[_0x5231f8(0x15f)]({'title':_0x5231f8(0x1d5),'default':_0x34371c||''});if(_0x14d941==null)return;Object[_0x5231f8(0x155)](_0x310601['apps'])[_0x5231f8(0xfa)](_0xf4495=>{const _0x18d150=_0x5231f8;_0xf4495[_0x18d150(0x179)]?_0xf4495[_0x18d150(0x179)]():_0xf4495[_0x18d150(0x19e)]();});if(!_0x14d941)await _0x310601['setFlag'](SharedConsts[_0x5231f8(0x159)],Consts['FLAG_IFRAME_URL'],'');else{_0x14d941=_0x14d941[_0x5231f8(0x1da)]();if(_0x14d941[_0x5231f8(0x20f)]('<iframe'))_0x14d941=$(_0x14d941)[_0x5231f8(0x191)](_0x5231f8(0x1fd));!_0x14d941&&(ui[_0x5231f8(0x1e4)][_0x5231f8(0x1bc)]('URL/iframe\x20\x22'+_0x14d941+_0x5231f8(0x1fe)),await _0x310601[_0x5231f8(0x10b)](SharedConsts[_0x5231f8(0x159)],Consts[_0x5231f8(0x1e8)],'')),await _0x310601['setFlag'](SharedConsts[_0x5231f8(0x159)],Consts[_0x5231f8(0x1e8)],_0x14d941);}}}),_0x2778f8;};}}Patcher[_0x1325cd(0x1f7)]=class{static[_0x1325cd(0x20e)](){const _0x4df937=_0x1325cd;libWrapper[_0x4df937(0x1d3)](SharedConsts[_0x4df937(0x159)],_0x4df937(0xed),function(_0x401850,..._0x2873de){const _0x52d6f4=_0x4df937;if(Config['get'](_0x52d6f4(0x206),_0x52d6f4(0x1e7)))Patcher[_0x52d6f4(0x1f7)][_0x52d6f4(0x1c7)](this);return _0x401850(..._0x2873de);},UtilLibWrapper[_0x4df937(0x1b3)]),libWrapper[_0x4df937(0x1d3)](SharedConsts[_0x4df937(0x159)],_0x4df937(0x1c3),function(_0x57aec5,..._0x4eac79){const _0x1f7f77=_0x4df937;if(Config[_0x1f7f77(0x1e3)](_0x1f7f77(0x206),_0x1f7f77(0x1e7)))Patcher[_0x1f7f77(0x1f7)][_0x1f7f77(0x1c7)](this);return _0x57aec5(..._0x4eac79);},UtilLibWrapper[_0x4df937(0x1b3)]),libWrapper[_0x4df937(0x1d3)](SharedConsts[_0x4df937(0x159)],_0x4df937(0x172),function(_0x4ebc3d,..._0x7ef4b5){const _0x484433=_0x4df937;if(Config[_0x484433(0x1e3)](_0x484433(0x206),_0x484433(0x1e7)))Patcher[_0x484433(0x1f7)][_0x484433(0x1c7)](this);return _0x4ebc3d(..._0x7ef4b5);},UtilLibWrapper[_0x4df937(0x1b3)]),libWrapper[_0x4df937(0x1d3)](SharedConsts[_0x4df937(0x159)],_0x4df937(0x1f9),function(_0x1a8e6b,..._0x150825){const _0x32a672=_0x4df937;if(Config['get'](_0x32a672(0x206),'isDisplayDamageDealt'))Patcher[_0x32a672(0x1f7)][_0x32a672(0x1c7)](this);return _0x1a8e6b(..._0x150825);},UtilLibWrapper[_0x4df937(0x1b3)]);}static['handleConfigUpdate'](){this['_handleConfigUpdate_displayDamageDealt_doRefreshTokens']();}static['_handleConfigUpdate_displayDamageDealt_doRefreshTokens'](_0x19e33f){const _0x209265=_0x1325cd;_0x19e33f=_0x19e33f||{};const _0x4e1325=MiscUtil[_0x209265(0x1e3)](canvas,_0x209265(0x206),_0x209265(0x167))||[];for(const _0x418034 of _0x4e1325){try{_0x19e33f[_0x209265(0x183)]&&_0x418034['_plutonium_xDispDamageDealt']&&(_0x418034[_0x209265(0x182)](_0x418034[_0x209265(0xd3)]),_0x418034[_0x209265(0xd3)]=null),_0x418034[_0x209265(0x157)]();}catch(_0x2350aa){console[_0x209265(0x1bc)](...LGT,_0x209265(0x117)+_0x418034[_0x209265(0x10e)]+'\x22!',_0x2350aa);}}}static[_0x1325cd(0x1c7)](_0xe3510c){const _0x27547f=_0x1325cd;this[_0x27547f(0x1ee)](_0xe3510c);const _0x28861c=MiscUtil[_0x27547f(0x1e3)](_0xe3510c[_0x27547f(0x146)],_0x27547f(0x169),_0x27547f(0x169),_0x27547f(0xdd),'hp',_0x27547f(0x1e9))||0x0,_0x501645=MiscUtil[_0x27547f(0x1e3)](_0xe3510c[_0x27547f(0x146)],_0x27547f(0x169),'data',_0x27547f(0xdd),'hp',_0x27547f(0x1cb))||0x0,_0x16f314=Math[_0x27547f(0x200)](_0x28861c,Math[_0x27547f(0x1e9)](0x0,_0x28861c-_0x501645));_0xe3510c['_plutonium_xDispDamageDealt'][_0x27547f(0x113)]=''+_0x16f314,_0xe3510c[_0x27547f(0xd3)][_0x27547f(0x1ac)]=!!_0x16f314;if(_0x501645<=Math[_0x27547f(0x12b)](_0x28861c/0x2))_0xe3510c[_0x27547f(0xd3)][_0x27547f(0x13d)]['fill']=0xff0000;else _0xe3510c[_0x27547f(0xd3)][_0x27547f(0x13d)]['fill']=0xffffff;}static['_handleConfigUpdate_displayDamageDealt_doAddDisplay'](_0x59387a){const _0x24c61c=_0x1325cd;if(_0x59387a['_plutonium_xDispDamageDealt']&&_0x59387a[_0x24c61c(0xd3)][_0x24c61c(0x13f)])return;_0x59387a[_0x24c61c(0xd3)]&&!_0x59387a['_plutonium_xDispDamageDealt']['parent']&&(_0x59387a[_0x24c61c(0x182)](_0x59387a[_0x24c61c(0xd3)]),_0x59387a[_0x24c61c(0xd3)]=null),_0x59387a[_0x24c61c(0xd3)]=new PIXI[(_0x24c61c(0xd8))]('',CONFIG['canvasTextStyle'][_0x24c61c(0x1d0)]()),_0x59387a[_0x24c61c(0xd3)][_0x24c61c(0x13d)][_0x24c61c(0xd7)]=0x18,_0x59387a[_0x24c61c(0xd3)][_0x24c61c(0x120)]['set'](0x1,0x1),_0x59387a['_plutonium_xDispDamageDealt'][_0x24c61c(0x12e)][_0x24c61c(0x10d)](_0x59387a['w']-0x3,_0x59387a['h']-0x1),_0x59387a['addChild'](_0x59387a[_0x24c61c(0xd3)]);}},Patcher['Drawing']=class{static['handleConfigUpdate'](){const _0x348c3e=_0x1325cd;if(!MiscUtil['get'](canvas,_0x348c3e(0x202),'options'))return;if(Config['get']('ui',_0x348c3e(0x13b))){if(Patcher['Drawing'][_0x348c3e(0x1de)]==null)Patcher[_0x348c3e(0x207)][_0x348c3e(0x1de)]=canvas[_0x348c3e(0x202)][_0x348c3e(0x216)];canvas[_0x348c3e(0x202)][_0x348c3e(0x216)][_0x348c3e(0x15c)]=0x1;}else{if(Patcher[_0x348c3e(0x207)][_0x348c3e(0x1de)]!=null)canvas['mouseInteractionManager'][_0x348c3e(0x216)]=Patcher[_0x348c3e(0x207)]['_CACHED_MOUSE_INTERACTION_MANAGER_OPTIONS'];}}},Patcher[_0x1325cd(0x207)][_0x1325cd(0x1de)]=null,Patcher[_0x1325cd(0x178)]=class{static[_0x1325cd(0x20e)](){const _0x5e229a=_0x1325cd;libWrapper[_0x5e229a(0x1d3)](SharedConsts['MODULE_NAME'],_0x5e229a(0x168),function(_0x53f686,..._0x332b3c){const _0x530ea3=_0x5e229a;if(!Config['get'](_0x530ea3(0x1b5),_0x530ea3(0x1bd)))return _0x53f686(..._0x332b3c);return Patcher['TextEditor'][_0x530ea3(0xf9)](_0x53f686,..._0x332b3c);},UtilLibWrapper[_0x5e229a(0x1b3)]),libWrapper['register'](SharedConsts[_0x5e229a(0x159)],_0x5e229a(0x107),function(_0x313d55,..._0x336404){const _0x54a3b6=_0x5e229a,_0x2e41d2=_0x313d55(..._0x336404);if(!Config[_0x54a3b6(0x1e3)](_0x54a3b6(0x1b5),_0x54a3b6(0x1bd)))return _0x2e41d2;return Patcher[_0x54a3b6(0x178)][_0x54a3b6(0x214)](..._0x336404),_0x2e41d2;},UtilLibWrapper[_0x5e229a(0x1b3)]);}static[_0x1325cd(0xf9)](_0x16d94b,_0x5bd51f,_0x3d8311,_0x4cbfb6=0x0){const _0x1541d3=_0x1325cd;_0x3d8311=_0x3d8311||{},_0x5bd51f=_0x16d94b(_0x5bd51f,_0x3d8311);if(!_0x3d8311[_0x1541d3(0x152)])return _0x5bd51f;return _0x5bd51f=_0x5bd51f[_0x1541d3(0x11d)](/@Embed(JournalEntry)\[([^\]]+)](?:{([^}]+)})?/g,(..._0x530295)=>this[_0x1541d3(0x17f)](_0x3d8311,_0x4cbfb6,..._0x530295)),_0x5bd51f;}static[_0x1325cd(0x17f)](_0x37e322,_0x3e8908,_0x1af8bf,_0x508a79,_0x32bc96,_0x21b88d){const _0x179825=_0x1325cd,_0x1b38ca=CONFIG[_0x508a79],_0x5be47b=_0x1b38ca[_0x179825(0x133)][_0x179825(0x1f3)],_0x45733a=this['_getEntity'](_0x5be47b,_0x32bc96);if(!_0x45733a)return _0x179825(0x1dd)+(_0x21b88d||_0x32bc96)+_0x179825(0x204);if(this['_getEntityPermissions'](_0x45733a)<CONST[_0x179825(0x171)][_0x179825(0x1b4)])return _0x179825(0x1dd)+(_0x21b88d||_0x32bc96)+_0x179825(0xde);const _0xde5c7a=TextEditor[_0x179825(0xfc)](_0x1af8bf,_0x508a79,_0x32bc96,_0x21b88d)['outerHTML'],_0xeb4fac=Config[_0x179825(0x1e3)]('journalEntries',_0x179825(0xe3));if(_0x45733a['sheet'][_0x179825(0xdf)]===_0x179825(0xd1)){const _0x32c8ec=_0x45733a['data']['img'];return _0x179825(0x1b9)+_0xde5c7a+this['_getBtnHtmlToggle'](_0xeb4fac)+'</div>\x0a\x09\x09\x09\x09<div\x20class=\x22flex-vh-center\x20jemb__wrp-content\x20'+(_0xeb4fac?'':_0x179825(0x190))+_0x179825(0x1d2)+_0x32c8ec+_0x179825(0x153)+_0x32c8ec+_0x179825(0x15d);}else{const _0x91dd2f=_0x3e8908===Patcher[_0x179825(0x178)]['_MAX_RECURSION_DEPTH'],_0x5eaf7b=_0x91dd2f?_0x45733a[_0x179825(0x169)]['content']:TextEditor[_0x179825(0xf9)](_0x45733a[_0x179825(0x169)][_0x179825(0x101)],_0x37e322,_0x3e8908+0x1);return _0x179825(0x1b9)+_0xde5c7a+this[_0x179825(0xe0)](_0xeb4fac)+_0x179825(0x1b8)+(_0x91dd2f?_0x179825(0x1ca):'')+_0x179825(0x1c1)+(_0xeb4fac?'':_0x179825(0x190))+'\x22>'+_0x5eaf7b+_0x179825(0x1ff);}}static[_0x1325cd(0x1c5)](_0x2b64b1){const _0x62fd0b=_0x1325cd;if(game[_0x62fd0b(0x1e2)][_0x62fd0b(0x1a7)])return CONST[_0x62fd0b(0x171)][_0x62fd0b(0x140)];return Math[_0x62fd0b(0x1e9)](_0x2b64b1['data'][_0x62fd0b(0xe4)][game[_0x62fd0b(0x1e2)][_0x62fd0b(0x10e)]],_0x2b64b1[_0x62fd0b(0x169)][_0x62fd0b(0xe4)][_0x62fd0b(0x18b)]);}static[_0x1325cd(0x108)](_0x5d5a0e,_0x11acd8){const _0x2e763f=_0x1325cd;let _0x39bd21=null;if(/^[a-zA-Z0-9]{16}$/[_0x2e763f(0x189)](_0x11acd8))_0x39bd21=_0x5d5a0e[_0x2e763f(0x1e3)](_0x11acd8);if(!_0x39bd21)_0x39bd21=_0x5d5a0e[_0x2e763f(0x152)][_0x2e763f(0x198)](_0x30a9f1=>_0x30a9f1['data'][_0x2e763f(0x135)]===_0x11acd8);return _0x39bd21;}static[_0x1325cd(0x11a)](_0x7ac4f5){const _0xd88359=_0x1325cd,_0x4f850c=$(_0x7ac4f5[_0xd88359(0x14a)]),_0x4456a6=_0x4f850c[_0xd88359(0x191)](_0xd88359(0x123))==='1';if(_0x7ac4f5['shiftKey']){_0x7ac4f5[_0xd88359(0x18e)]();const _0x235d4b=_0x4f850c[_0xd88359(0x148)](_0xd88359(0xf5));_0x235d4b[_0xd88359(0x198)](_0xd88359(0x137))[_0xd88359(0x17c)]((_0x3a090c,_0x4d614a)=>this[_0xd88359(0x174)]($(_0x4d614a),_0x4456a6));return;}this[_0xd88359(0x174)](_0x4f850c,_0x4456a6);}static[_0x1325cd(0x174)](_0x2add6a,_0x56b195){const _0x59d1d2=_0x1325cd,_0x2745d7=_0x2add6a[_0x59d1d2(0x13f)]()[_0x59d1d2(0x1fb)]();_0x2745d7['toggleClass'](_0x59d1d2(0x190),_0x56b195),_0x2add6a['attr'](_0x59d1d2(0x123),_0x56b195?'0':'1')[_0x59d1d2(0xf3)](_0x56b195?_0x59d1d2(0x121):_0x59d1d2(0x12a))[_0x59d1d2(0x1f6)]((_0x56b195?_0x59d1d2(0x1b7):_0x59d1d2(0x118))+_0x59d1d2(0xe6));}static[_0x1325cd(0xe0)](_0x20302f){const _0x1033fc=_0x1325cd;return'<button\x20class=\x22btn\x20btn-xxs\x20btn-5et\x20btn-default\x20flex-vh-center\x20mx-1\x20jemb__btn-toggle\x22\x20data-plut-is-expanded=\x22'+(_0x20302f?0x1:0x0)+_0x1033fc(0x162)+(_0x20302f?_0x1033fc(0x118):_0x1033fc(0x1b7))+_0x1033fc(0x110)+(_0x20302f?'<i\x20class=\x22fa\x20fa-caret-square-down\x22></i>':_0x1033fc(0x121))+'</button>';}static[_0x1325cd(0x214)](_0xf6fa59){const _0xf507d3=_0x1325cd;for(let _0x340033 of _0xf6fa59[_0xf507d3(0xe7)](_0xf507d3(0x11b))){if(_0x340033[_0xf507d3(0x194)][_0xf507d3(0x1be)](_0xf507d3(0xfb)))_0x340033[_0xf507d3(0x1ea)]('disabled');}}},Patcher['TextEditor'][_0x1325cd(0x1bb)]=0x45,Patcher[_0x1325cd(0x20d)]=class{static['handleConfigUpdate'](){const _0x158444=_0x1325cd;if(Patcher[_0x158444(0x20d)][_0x158444(0x1a2)]==null||Patcher['ChatMessage'][_0x158444(0x1a2)]!==Config[_0x158444(0x1e3)]('ui',_0x158444(0x105))){Patcher[_0x158444(0x20d)][_0x158444(0x1a2)]=Config[_0x158444(0x1e3)]('ui','isCompactChat');if(Patcher['ChatMessage'][_0x158444(0x1a2)])this[_0x158444(0x10a)]();else this['_doRemoveFromExistingMessages']();}}static[_0x1325cd(0x10a)](){const _0x20c251=_0x1325cd,_0x4f80bb=ui['chat'][_0x20c251(0x170)][_0x20c251(0x198)]('.message');_0x4f80bb[_0x20c251(0x17c)]((_0xabe883,_0x273143)=>{const _0x20c2d6=_0x20c251,_0x22abf1=$(_0x273143),_0x3255d3=ChatMessage['collection'][_0x20c2d6(0x1e3)](_0x273143['dataset']['messageId']);this[_0x20c2d6(0x1f0)](_0x3255d3,_0x22abf1,!![]);});}static[_0x1325cd(0x17d)](){const _0x305147=_0x1325cd,_0x3ae486=ui['chat'][_0x305147(0x170)]['find'](_0x305147(0x164));_0x3ae486['each']((_0x4e83d7,_0x102609)=>{const _0x3febfe=_0x305147;_0x102609['classList'][_0x3febfe(0x19c)]('chatmsg__trim-top'),_0x102609[_0x3febfe(0x194)]['remove'](_0x3febfe(0x19b)),$(_0x102609)[_0x3febfe(0xe2)](_0x3febfe(0x185)+Patcher['ChatMessage']['_EVENT_NAMESPACE'])['off'](_0x3febfe(0x1cc)+Patcher[_0x3febfe(0x20d)][_0x3febfe(0x19d)])[_0x3febfe(0xe2)](_0x3febfe(0x1aa)+Patcher[_0x3febfe(0x20d)][_0x3febfe(0x19d)]);});}static[_0x1325cd(0x20e)](){const _0x10dfd3=_0x1325cd;Hooks['on'](_0x10dfd3(0x151),(_0xa9b8ad,_0x5587b8)=>{const _0x35070f=_0x10dfd3;if(!Config['get']('ui',_0x35070f(0x105)))return;this[_0x35070f(0x1f0)](_0xa9b8ad,_0x5587b8);}),Hooks['on'](_0x10dfd3(0x10c),(..._0x143cc9)=>{const _0x2df4b1=_0x10dfd3;if(!Config[_0x2df4b1(0x1e3)]('ui',_0x2df4b1(0x105)))return;this['_handleDeleteChatMessage'](..._0x143cc9);});}static[_0x1325cd(0x1f0)](_0x22249f,_0x31f9d4,_0x102502){const _0x30ecaa=_0x1325cd;if(!_0x102502){const _0x1c0ca3=this[_0x30ecaa(0x15a)](_0x22249f);if(_0x1c0ca3&&_0x1c0ca3[_0x30ecaa(0xec)])return this['_doHandleExistingMessage'](_0x22249f,_0x31f9d4,_0x1c0ca3);}if(!this['_isMetaMatch'](_0x22249f)){Patcher[_0x30ecaa(0x20d)]['_LAST_MESSAGE_META']=this[_0x30ecaa(0x131)](_0x22249f,_0x31f9d4);return;}Patcher[_0x30ecaa(0x20d)]['_LAST_MESSAGE_META'][_0x30ecaa(0x161)][_0x30ecaa(0xf2)]('chatmsg__trim-bottom');const _0x510420=this[_0x30ecaa(0x131)](_0x22249f,_0x31f9d4);_0x510420[_0x30ecaa(0x161)][_0x30ecaa(0xf2)](_0x30ecaa(0x20b)),this['_doBindTrimmedTopEventHandlers'](_0x510420[_0x30ecaa(0x161)]),Patcher['ChatMessage'][_0x30ecaa(0xfe)]=_0x510420;}static['_getMessageMeta'](_0x2e4f45,_0x1df773){const _0x3f4ca4=_0x1325cd,_0x42bb00=_0x1df773['find'](_0x3f4ca4(0x19f));return{'$ele':_0x1df773,'$header':_0x42bb00,'chatMessage':_0x2e4f45};}static[_0x1325cd(0x15a)](_0x20e7d1){const _0x53b70e=_0x1325cd;return ui[_0x53b70e(0x154)][_0x53b70e(0x170)][_0x53b70e(0x198)](_0x53b70e(0xf8)+_0x20e7d1['id']+'\x22]');}static[_0x1325cd(0x1d7)](_0x968d38,_0x1c8eda,_0x33f4b6){const _0x17ebc4=_0x1325cd;if(_0x33f4b6[_0x17ebc4(0xff)](_0x17ebc4(0x19b)))_0x1c8eda[_0x17ebc4(0xf2)](_0x17ebc4(0x19b));_0x33f4b6['hasClass']('chatmsg__trim-top')&&(_0x1c8eda[_0x17ebc4(0xf2)](_0x17ebc4(0x20b)),this['_doBindTrimmedTopEventHandlers'](_0x1c8eda));}static[_0x1325cd(0x119)](_0x38f495){const _0x417389=_0x1325cd;if(!Patcher[_0x417389(0x20d)][_0x417389(0xfe)])return![];const {chatMessage:_0x268b40}=Patcher[_0x417389(0x20d)][_0x417389(0xfe)];if(_0x268b40[_0x417389(0x169)][_0x417389(0xe9)]<_0x38f495['data'][_0x417389(0xe9)]-Patcher[_0x417389(0x20d)]['_SPEAKER_TIMEOUT_MSEC'])return![];if(_0x268b40[_0x417389(0x1e2)]?.['id']!==_0x38f495[_0x417389(0x1e2)]?.['id'])return![];if(_0x268b40[_0x417389(0x1e2)]?.[_0x417389(0x14b)]!==_0x38f495[_0x417389(0x1e2)]?.[_0x417389(0x14b)])return![];if(_0x268b40[_0x417389(0x138)]?.['id']!==_0x38f495[_0x417389(0x138)]?.['id'])return![];if(_0x268b40[_0x417389(0x17b)]!==_0x38f495['alias'])return![];if(!CollectionUtil[_0x417389(0x20c)](_0x268b40['data']?.['whisper'],_0x38f495[_0x417389(0x169)]?.['whisper']))return![];if(_0x268b40['data']?.['blind']!==_0x38f495[_0x417389(0x169)]?.[_0x417389(0x181)])return![];return!![];}static[_0x1325cd(0x208)](_0x51a032){const _0x295c9f=_0x1325cd,_0x5962b1=ui['chat']['element'][_0x295c9f(0x198)](_0x295c9f(0xf8)+_0x51a032['id']+'\x22]'),_0xc629f2=_0x5962b1[_0x295c9f(0x1f1)](),_0x38041a=_0x5962b1[_0x295c9f(0x1fb)]();_0x38041a[_0x295c9f(0xec)]&&(!_0x5962b1[_0x295c9f(0xff)](_0x295c9f(0x20b))&&_0x5962b1[_0x295c9f(0xff)](_0x295c9f(0x19b))&&_0x38041a[_0x295c9f(0xf7)](_0x295c9f(0x20b)));_0xc629f2[_0x295c9f(0xec)]&&(_0x5962b1[_0x295c9f(0xff)]('chatmsg__trim-top')&&!_0x5962b1['hasClass'](_0x295c9f(0x19b))&&_0xc629f2[_0x295c9f(0xf7)](_0x295c9f(0x19b)));if(Patcher['ChatMessage'][_0x295c9f(0xfe)]){const {chatMessage:_0x1b08b3}=Patcher['ChatMessage'][_0x295c9f(0xfe)];if(_0x1b08b3===_0x51a032)Patcher[_0x295c9f(0x20d)][_0x295c9f(0xfe)]=null;}}static[_0x1325cd(0x102)](_0x5bfdc7){const _0x261e29=_0x1325cd;_0x5bfdc7['on'](_0x261e29(0x185)+Patcher[_0x261e29(0x20d)]['_EVENT_NAMESPACE'],_0x584064=>{const _0x1f061f=_0x261e29;if(!_0x584064['shiftKey'])return;_0x5bfdc7[_0x1f061f(0xf2)]('chatmsg__trim-top--inspecting');})['on'](_0x261e29(0x1cc)+Patcher[_0x261e29(0x20d)]['_EVENT_NAMESPACE'],_0x7d6e2c=>{const _0x379292=_0x261e29;if(!_0x7d6e2c[_0x379292(0x125)])return;_0x5bfdc7[_0x379292(0xf2)](_0x379292(0x1a4));})['on'](_0x261e29(0x1aa)+Patcher[_0x261e29(0x20d)][_0x261e29(0x19d)],()=>{const _0x6a8140=_0x261e29;_0x5bfdc7[_0x6a8140(0xf7)](_0x6a8140(0x1a4));});}},Patcher[_0x1325cd(0x20d)]['_LAST_CONFIG_STATE']=null,Patcher[_0x1325cd(0x20d)][_0x1325cd(0x134)]=0x7530,Patcher[_0x1325cd(0x20d)][_0x1325cd(0xfe)]=null,Patcher[_0x1325cd(0x20d)][_0x1325cd(0x19d)]=SharedConsts[_0x1325cd(0x159)]+_0x1325cd(0x20a),Patcher['SettingsConfig']=class{static[_0x1325cd(0x20e)](){Hooks['on']('renderSettingsConfig',(_0x48a207,_0x5104bd)=>{const _0x4a5088=_0x5637;if(!Config[_0x4a5088(0x1e3)]('ui','isStreamerMode'))return;const _0x3c27b6=_0x5104bd[_0x4a5088(0x198)](_0x4a5088(0x1f2))[_0x4a5088(0x1e3)]();for(const _0x36b7ec of _0x3c27b6){const _0x37a7c4=this[_0x4a5088(0x1d1)](_0x36b7ec);if(!_0x37a7c4)continue;_0x37a7c4['data']=_0x4a5088(0x14c);break;}});}static[_0x1325cd(0x1d1)](_0x61032c){const _0x398fee=_0x1325cd;if(!_0x61032c)return null;if(_0x61032c[_0x398fee(0x13e)]===_0x398fee(0x15e)){const _0x409135=(_0x61032c[_0x398fee(0x169)]||'')[_0x398fee(0x1da)]();if(_0x409135===SharedConsts[_0x398fee(0x1e0)])return _0x61032c;return null;}for(let _0x53004f=0x0;_0x53004f<_0x61032c[_0x398fee(0x199)][_0x398fee(0xec)];++_0x53004f){const _0x4acb98=_0x61032c[_0x398fee(0x199)][_0x53004f],_0x1734ea=this[_0x398fee(0x1d1)](_0x4acb98);if(_0x1734ea)return _0x1734ea;}}},Patcher[_0x1325cd(0x213)]=class{static['init'](){const _0x43c7e6=_0x1325cd;libWrapper[_0x43c7e6(0x1d3)](SharedConsts[_0x43c7e6(0x159)],_0x43c7e6(0x1db),function(_0x313794,_0x397863,_0x176951,..._0x52c084){const _0x42e8c8=_0x43c7e6;return Config[_0x42e8c8(0x1e3)](_0x42e8c8(0x206),_0x42e8c8(0x160))&&(_0x176951&&_0x176951[_0x42e8c8(0x144)]&&_0x176951[_0x42e8c8(0x135)]&&_0x176951['name']['endsWith'](_0x42e8c8(0x1d6))&&(_0x176951[_0x42e8c8(0x144)]=0x1)),_0x313794(_0x397863,_0x176951,..._0x52c084);},UtilLibWrapper['LIBWRAPPER_MODE_WRAPPER']);}},Patcher[_0x1325cd(0x163)]=class{static[_0x1325cd(0x20e)](){const _0x5c7684=_0x1325cd;libWrapper[_0x5c7684(0x1d3)](SharedConsts['MODULE_NAME'],'$.prototype.animate',function(_0x1bdd1b,..._0x5e86d1){const _0x477b19=_0x5c7684;return _0x1bdd1b(...Patcher[_0x477b19(0x163)][_0x477b19(0x1cf)](..._0x5e86d1));},UtilLibWrapper[_0x5c7684(0x1b3)]);}static['_getNextArgs'](..._0x408d84){const _0x1a664f=_0x1325cd;let _0x4807a7=[..._0x408d84];if(Config[_0x1a664f(0x1e3)]('ui',_0x1a664f(0x160)))for(let _0x3552c2=0x0;_0x3552c2<_0x4807a7['length'];++_0x3552c2){const _0x22fbc6=_0x4807a7[_0x3552c2];if(typeof _0x22fbc6==='object'&&_0x22fbc6[_0x1a664f(0x144)]!=null){if(_0x22fbc6[_0x1a664f(0x144)]>0x21)_0x22fbc6[_0x1a664f(0x144)]=0x21;break;}else{if(typeof _0x22fbc6===_0x1a664f(0x132)){if(_0x22fbc6>0x21)_0x4807a7[_0x3552c2]=0x21;break;}}}return _0x4807a7;}},Patcher[_0x1325cd(0x166)]=class{static[_0x1325cd(0x20e)](){const _0x447483=_0x1325cd;ui[_0x447483(0x18c)][_0x447483(0x177)](),libWrapper[_0x447483(0x1d3)](SharedConsts[_0x447483(0x159)],'game.keyboard._onEscape',function(_0x54a93d,_0x1efb38,_0x219baa,_0x509514){const _0x1439a5=_0x447483;if(!Config[_0x1439a5(0x1e3)]('ui','isFixEscapeKey')){if(UiUtil[_0x1439a5(0x104)]&&UiUtil[_0x1439a5(0x104)][_0x1439a5(0xec)])return;return _0x54a93d(_0x1efb38,_0x219baa,_0x509514);}return Patcher[_0x1439a5(0x166)][_0x1439a5(0x1ab)][_0x1439a5(0xdc)](this)(_0x1efb38,_0x219baa,_0x509514);},UtilLibWrapper[_0x447483(0xee)]);}static[_0x1325cd(0x1ab)](_0x556037,_0x43e307,_0x4e83c9){const _0x5bba1a=_0x1325cd;if(UiUtil[_0x5bba1a(0x104)]&&UiUtil['_MODAL_STACK'][_0x5bba1a(0xec)])return;if(_0x43e307)return;if(_0x4e83c9[_0x5bba1a(0x130)]&&Patcher[_0x5bba1a(0x166)][_0x5bba1a(0x106)][_0x5bba1a(0x128)](_0x556037['target'][_0x5bba1a(0x13e)])){_0x556037[_0x5bba1a(0xda)][_0x5bba1a(0x173)]();return;}if(canvas[_0x5bba1a(0x143)])canvas[_0x5bba1a(0x156)]['saveFog']();if(ui[_0x5bba1a(0x1df)]&&ui[_0x5bba1a(0x1df)][_0x5bba1a(0x201)][_0x5bba1a(0xec)])ui['context'][_0x5bba1a(0x19e)]();else{if(Menu[_0x5bba1a(0xe1)]())return;else{if(canvas[_0x5bba1a(0x143)]&&Object['keys'](canvas[_0x5bba1a(0x1a5)][_0x5bba1a(0xd5)])[_0x5bba1a(0xec)])_0x556037['preventDefault'](),canvas[_0x5bba1a(0x1a5)][_0x5bba1a(0x1d8)]();else{if(Object[_0x5bba1a(0x155)](ui['windows'])[_0x5bba1a(0xd4)](_0x3cb562=>(_0x3cb562[_0x5bba1a(0x16b)]==null||_0x3cb562[_0x5bba1a(0x16b)]===!![])&&!_0x3cb562[_0x5bba1a(0x1c8)])[_0x5bba1a(0xec)]){const _0x4d9432=Object[_0x5bba1a(0xd9)](ui[_0x5bba1a(0x19a)])[_0x5bba1a(0xd4)](([_0x49fe36,_0x1180bf])=>(_0x1180bf[_0x5bba1a(0x16b)]==null||_0x1180bf[_0x5bba1a(0x16b)]===!![])&&!_0x1180bf[_0x5bba1a(0x1c8)])['map'](([_0x151e71,_0x5c628a])=>{const _0x1daf51=_0x5bba1a,_0x1617d6=Number(((_0x5c628a[_0x1daf51(0x170)][0x0]||{})[_0x1daf51(0x13d)]||{})[_0x1daf51(0x12f)]||-0x1);if(isNaN(_0x1617d6)||!~_0x1617d6)console[_0x1daf51(0x1bc)](_0x1daf51(0x209)+_0x151e71);return{'appId':_0x151e71,'zIndex':isNaN(_0x1617d6)?-0x1:_0x1617d6};})[_0x5bba1a(0x150)]((_0x32921d,_0x5b4350)=>SortUtil[_0x5bba1a(0x196)](_0x5b4350['zIndex'],_0x32921d['zIndex']));ui[_0x5bba1a(0x19a)][_0x4d9432[0x0]['appId']][_0x5bba1a(0x19e)]();}else ui[_0x5bba1a(0x201)][_0x5bba1a(0x1ef)]();}}}this[_0x5bba1a(0x1cd)]['add'](_0x4e83c9[_0x5bba1a(0x188)]);}},Patcher[_0x1325cd(0x166)][_0x1325cd(0x106)]=new Set([_0x1325cd(0x212),'TEXTAREA']),Patcher[_0x1325cd(0x1b6)]=class{static[_0x1325cd(0x20e)](){const _0x1986a1=_0x1325cd;Hooks['on'](_0x1986a1(0x141),(_0x30b87e,_0xb1ee14,_0xc19191)=>{const _0x49517e=_0x1986a1;this[_0x49517e(0x186)](_0x30b87e,_0xb1ee14,_0xc19191);});}static[_0x1325cd(0x186)](_0x57103f,_0x139876,_0x5877fc){const _0x54e5b2=_0x1325cd;if(!Config[_0x54e5b2(0x1e3)]('ui',_0x54e5b2(0x16e)))return;_0x139876[_0x54e5b2(0x198)]('.changes-list\x20.effect-change')['each']((_0xe426ae,_0x1fe06a)=>{const _0x34fb7=_0x54e5b2,_0x394a97=$(_0x1fe06a),_0x35fb9f=_0x394a97['find']('.key\x20input'),_0x3fe5b7=_0x394a97[_0x34fb7(0x198)](_0x34fb7(0x10f)),_0x22f1f8=_0x394a97[_0x34fb7(0x198)]('.value\x20input');$(_0x34fb7(0xd2))[_0x34fb7(0x16c)](_0x521638=>{const _0x271215=_0x34fb7;_0x521638['preventDefault'](),_0x521638[_0x271215(0xdb)]();const _0x3f7fc2=UtilActiveEffects[_0x271215(0xf0)](_0x57103f[_0x271215(0x1b1)][_0x271215(0x13f)],_0x5877fc),{$modalInner:_0x5168fd,doClose:_0x36be60}=UiUtil['getShowModal']({'title':_0x271215(0x1ed),'isWidth100':!![],'isHeight100':!![],'isUncappedHeight':!![]}),_0x1452b8=$(_0x271215(0x1d9)),_0x2fa57b=$('<button\x20class=\x22btn-5et\x20veapp__btn-list-reset\x22\x20name=\x22btn-reset\x22>'+game['i18n'][_0x271215(0x1b0)](_0x271215(0x14d))+'</button>')[_0x271215(0x16c)](()=>_0x12c304[_0x271215(0x15b)]()),_0x1345c1=$$`<div class="flex-v-stretch input-group input-group--bottom mb-1">
							<button class="btn-5et col-4-5 sort" data-sort="name">Name</button>
							<button class="btn-5et col-2-5 sort" data-sort="value">Current Value</button>
							<button class="btn-5et col-2-5 sort" data-sort="baseValue" title="The underlying value, without any current effects/etc. applied.">Current Base Value</button>
							<button class="btn-5et col-2-5 sort" data-sort="default">Default Value</button>
						</div>`,_0x173799=$(_0x271215(0x1c4)),_0x12c304=new List({'isUseJquery':!![],'$iptSearch':_0x1452b8,'$wrpList':_0x173799});SortUtil[_0x271215(0x116)](_0x1345c1,_0x12c304),_0x3f7fc2[_0x271215(0xfa)]((_0x226724,_0x5582f9)=>{const _0x3bd1e0=_0x271215,_0x1089a1=MiscUtil['get'](_0x57103f[_0x3bd1e0(0x1b1)][_0x3bd1e0(0x13f)]['data'][_0x3bd1e0(0x169)],..._0x226724[_0x3bd1e0(0x1fa)][_0x3bd1e0(0x158)]('.')),_0x1c015f=MiscUtil[_0x3bd1e0(0x1e3)](_0x57103f[_0x3bd1e0(0x1b1)]['parent'][_0x3bd1e0(0x112)][_0x3bd1e0(0x169)],..._0x226724[_0x3bd1e0(0x1fa)]['split']('.')),_0x3d6ed6=$$`<label class="flex w-100 veapp__list-row clickable veapp__list-row-hoverable">
								<span class="col-4-5 px-2">${_0x226724[_0x3bd1e0(0x1fa)]}</span>
								<span class="col-2-5 text-center code">${JSON[_0x3bd1e0(0x1ad)](_0x1089a1)}</span>
								<span class="col-2-5 text-center code">${JSON[_0x3bd1e0(0x1ad)](_0x1c015f)}</span>
								<span class="col-2-5 text-center code">${JSON[_0x3bd1e0(0x1ad)](_0x226724['default'])}</span>
							</label>`[_0x3bd1e0(0x16c)](()=>{const _0x4d378f=_0x3bd1e0,_0x4a328e=_0x226724[_0x4d378f(0x18b)]==null?_0x226724[_0x4d378f(0x18b)]:typeof _0x226724[_0x4d378f(0x18b)]==='object'?JSON[_0x4d378f(0x1ad)](_0x226724[_0x4d378f(0x18b)]):_0x226724[_0x4d378f(0x18b)];_0x35fb9f[_0x4d378f(0x139)](_0x226724[_0x4d378f(0x1fa)]),_0x3fe5b7[_0x4d378f(0x139)](''+CONST[_0x4d378f(0x180)][_0x4d378f(0x1ae)]);if(!(_0x22f1f8[_0x4d378f(0x139)]()||'')[_0x4d378f(0x1da)]())_0x22f1f8[_0x4d378f(0x139)](_0x4a328e);_0x36be60();}),_0x20fac4=new ListItem(_0x5582f9,_0x3d6ed6,_0x226724[_0x3bd1e0(0x1fa)],{'value':_0x1089a1?MiscUtil['copy'](_0x1089a1):_0x1089a1,'default':_0x226724['default'],'baseValue':_0x1c015f?MiscUtil[_0x3bd1e0(0x122)](_0x1c015f):_0x1c015f});_0x12c304[_0x3bd1e0(0x18d)](_0x20fac4);}),_0x12c304[_0x271215(0x20e)](),_0x12c304[_0x271215(0x1a0)](),$$(_0x5168fd)`<div class="flex-col h-100 min-h-0">
							<div class="flex-v-stretch input-group input-group--top">
								${_0x1452b8}
								${_0x2fa57b}
							</div>
							${_0x1345c1}
							${_0x173799}
						</div>`;})[_0x34fb7(0x103)](_0x394a97);});}},Patcher['Actor']=class{static[_0x1325cd(0x20e)](){const _0x480419=_0x1325cd;libWrapper[_0x480419(0x1d3)](SharedConsts['MODULE_NAME'],_0x480419(0xf6),function(_0x24a0a1,..._0x14dc16){const _0xbdbae1=_0x480419;if(!Config[_0xbdbae1(0x1e3)]('actor',_0xbdbae1(0x129)))return _0x24a0a1(..._0x14dc16);return Patcher['Actor'][_0xbdbae1(0x114)](this,..._0x14dc16);},UtilLibWrapper[_0x480419(0xee)]);}static[_0x1325cd(0x114)](_0x29174c){const _0x310b3f=_0x1325cd,_0x21f862={},_0x18a025=_0x29174c[_0x310b3f(0x215)][_0x310b3f(0x205)]((_0x8087bf,_0x3becf3)=>{const _0x59cc2d=_0x310b3f;if(_0x3becf3[_0x59cc2d(0x169)][_0x59cc2d(0x18f)])return _0x8087bf;return _0x8087bf[_0x59cc2d(0x184)](_0x3becf3[_0x59cc2d(0x169)][_0x59cc2d(0x1ce)][_0x59cc2d(0x197)](_0x14ceaa=>{const _0x5be8c9=_0x59cc2d;return _0x14ceaa=duplicate(_0x14ceaa),_0x14ceaa[_0x5be8c9(0xea)]=_0x3becf3,_0x14ceaa[_0x5be8c9(0x1fc)]=_0x14ceaa[_0x5be8c9(0x1fc)]??_0x14ceaa['mode']*0xa,_0x14ceaa;}));},[]);_0x18a025['sort']((_0x24dfcc,_0x241326)=>_0x24dfcc[_0x310b3f(0x1fc)]-_0x241326['priority']),Patcher[_0x310b3f(0x147)][_0x310b3f(0x17e)](_0x29174c,_0x18a025);for(let _0x31a7b8 of _0x18a025){const _0x236a37=_0x31a7b8['effect']['apply'](_0x29174c,_0x31a7b8);if(_0x236a37!==null)_0x21f862[_0x31a7b8[_0x310b3f(0x188)]]=_0x236a37;}_0x29174c[_0x310b3f(0x1bf)]=expandObject(_0x21f862);}static[_0x1325cd(0x17e)](_0x321e9f,_0x5d279b){const _0x28f2bc=_0x1325cd;if(!_0x5d279b[_0x28f2bc(0xec)])return;let _0x35460c;const _0x58f895=UtilActiveEffects[_0x28f2bc(0x136)](_0x321e9f,{'isActorEffect':!![]});_0x5d279b[_0x28f2bc(0xfa)](_0x3c5afd=>{const _0x192960=_0x28f2bc;if(typeof _0x3c5afd[_0x192960(0x1cb)]!==_0x192960(0x16f))return;const _0x4c4de2=UtilActiveEffects[_0x192960(0x1e6)](_0x58f895,_0x3c5afd['key']);if(_0x4c4de2==null)return;switch(_0x4c4de2){case _0x192960(0x1b1):case _0x192960(0x126):{try{_0x3c5afd[_0x192960(0x1cb)]=eval(_0x3c5afd['value']);}catch(_0x5690b8){if(Util[_0x192960(0x192)]())console[_0x192960(0x1f5)](...LGT,_0x5690b8);}break;}case _0x192960(0x1c2):case _0x192960(0x132):case'boolean':{if(!_0x35460c)_0x35460c=Patcher['Actor'][_0x192960(0x1e5)](_0x321e9f);try{const _0xa47073=new Roll(_0x3c5afd[_0x192960(0x1cb)],_0x35460c);_0xa47073[_0x192960(0x1a6)](),_0x3c5afd['value']=_0xa47073[_0x192960(0x1dc)];if(_0x4c4de2===_0x192960(0x1eb))_0x3c5afd[_0x192960(0x1cb)]=!!_0x3c5afd[_0x192960(0x1cb)];}catch(_0x49d981){if(Util[_0x192960(0x192)]())console['error'](...LGT,_0x49d981);}break;}case _0x192960(0x16f):case _0x192960(0x211):default:break;}});}static['_applyActiveEffects_getFullRollData'](_0x3ac7cd){const _0x2c75d2=_0x1325cd,_0x4ebf2e=MiscUtil[_0x2c75d2(0x122)](_0x3ac7cd[_0x2c75d2(0x169)]);delete _0x4ebf2e[_0x2c75d2(0x215)];const _0x5dae10=new CONFIG[(_0x2c75d2(0x147))][(_0x2c75d2(0x133))]({..._0x4ebf2e});return _0x5dae10[_0x2c75d2(0x1e1)](),_0x5dae10[_0x2c75d2(0x1ec)]();}static[_0x1325cd(0x1f8)](_0x17a497,_0xadd37b){const _0x38645d=_0x1325cd;if(!Config['get'](_0x38645d(0x146),'isUseExtendedActiveEffectsParser'))return;if(!(_0xadd37b[_0x38645d(0x188)]||'')[_0x38645d(0x20f)](SharedConsts['MODULE_NAME_FAKE']))return;const _0x4ef9d9=UtilActiveEffects[_0x38645d(0x1c6)](_0xadd37b[_0x38645d(0x188)]);switch(_0x4ef9d9){case _0x38645d(0x1d4):{const {value:_0x168044}=_0xadd37b,_0xfa3950=getProperty(_0x17a497[_0x38645d(0x169)],_0x4ef9d9);if(typeof _0xfa3950===_0x38645d(0x132)&&_0xfa3950>=Number(_0x168044))return null;setProperty(_0x17a497[_0x38645d(0x169)],_0x4ef9d9,_0x168044);return;}default:console['warn'](...LGT,_0x38645d(0xf1)+_0x4ef9d9);}}};class JournalSheet_Plutonium extends JournalSheet{static[_0x1325cd(0x12d)](){const _0x119750=_0x1325cd,_0x4add8e=Config[_0x119750(0x1e3)](_0x119750(0x1b5),_0x119750(0x124));if(JournalSheet_Plutonium[_0x119750(0xd6)]===_0x4add8e)return;JournalSheet_Plutonium[_0x119750(0xd6)]=_0x4add8e;if(_0x4add8e)JournalSheet_Plutonium[_0x119750(0x142)]();else JournalSheet_Plutonium[_0x119750(0x1f4)]();}static[_0x1325cd(0x142)](){const _0x501a94=_0x1325cd;JournalSheet_Plutonium[_0x501a94(0x11e)]=!![],JournalSheet=JournalSheet_Plutonium,CONFIG['JournalEntry'][_0x501a94(0xe8)]=JournalSheet_Plutonium;}static[_0x1325cd(0x1f4)](){const _0x117de8=_0x1325cd;if(!JournalSheet_Plutonium[_0x117de8(0x11e)])return;JournalSheet=JournalSheet_Plutonium[_0x117de8(0x11f)],CONFIG[_0x117de8(0x18a)]['sheetClass']=JournalSheet_Plutonium[_0x117de8(0x11f)],Object['values'](ui[_0x117de8(0x19a)])[_0x117de8(0xfa)](_0x5119d0=>{const _0x419f05=_0x117de8;_0x5119d0['constructor']===JournalSheet_Plutonium&&_0x5119d0[_0x419f05(0x1b1)][_0x419f05(0x1b2)](SharedConsts['MODULE_NAME'],Consts[_0x419f05(0x1e8)])&&_0x5119d0[_0x419f05(0x179)]();});}static get[_0x1325cd(0x135)](){const _0x3afb25=_0x1325cd;return _0x3afb25(0x203);}static get[_0x1325cd(0x217)](){const _0x397d95=_0x1325cd;return{...super[_0x397d95(0x217)],'template':SharedConsts['MODULE_LOCATION']+_0x397d95(0x111)};}get[_0x1325cd(0x127)](){const _0x5196a5=_0x1325cd;if(this[_0x5196a5(0xdf)]==='image')return ImagePopout[_0x5196a5(0x217)][_0x5196a5(0x127)];return SharedConsts[_0x5196a5(0x17a)]+_0x5196a5(0x111);}[_0x1325cd(0x19e)](..._0x351caa){const _0x161973=_0x1325cd;if(this['object']&&this['object'][_0x161973(0x1b2)](SharedConsts[_0x161973(0x159)],Consts[_0x161973(0x1e8)])){this[_0x161973(0x170)]['hideVe']();return;}return super[_0x161973(0x19e)](..._0x351caa);}['forceClose'](){return super['close']();}[_0x1325cd(0x177)](..._0x3ca841){const _0x441383=_0x1325cd;if(_0x3ca841[0x1]&&_0x3ca841[0x1][_0x441383(0x1a1)]!==this[_0x441383(0xdf)])return super[_0x441383(0x177)](..._0x3ca841);if(this['element']&&this[_0x441383(0x170)]['length']){this[_0x441383(0x170)]['showVe'](),this[_0x441383(0x165)](),UtilApplications[_0x441383(0x149)](this);return;}return super[_0x441383(0x177)](..._0x3ca841);}}JournalSheet_Plutonium[_0x1325cd(0x115)]=![],JournalSheet_Plutonium[_0x1325cd(0x11f)]=JournalSheet,JournalSheet_Plutonium[_0x1325cd(0xd6)]=null,window['PlutPatcher']=Patcher;export{Patcher};
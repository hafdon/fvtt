const _0x19c5=['timed','optsGetSpellItem','@mod','damageInflict','preparation','homebrew','stripTags','243325aKjYYg','usesCurrent','get','distance','turn','escapeQuotes','map','createEmbeddedEntity','length','getCleanEntityName','level','school','permission','getMetricNumber','week','encodeForHash','388826qwVGCd','substring','isPrepared','VET_SPELL_SCHOOL_TO_ABV','getSrdCompendiumEntity','mode','msak','min','meta','inst','spell','heal','entriesHigherLevel','savingThrow','264078aMqiUH','consume','minute','name','5RTQAgu','VALID_DAMAGE_TYPES','doHookSpellLinkRender','save','usesMax','self','hashPreEncoded','_pFillSpellPromises_pAddSpellItem','_pFillSpellPromises_pUpdateSpellItem','URL_TO_HASH_BUILDER','hour','foundryData','permissions','\x20+\x20@mod','target','day','isExpanded','duration','components','spec','target.value','isIgnoreExisting','exec','create','replace','healing','melee\x20spell\x20attack','_id','LINK_DATA_SHEET_ITEM','perm','always','round','label','modules/','hover','preparationMode','_pGetAdditionalData','uid','range','hash','getSourceWithPagePart','error','condition','prepared','importSpell','items','pGetSpellItem','_getDescription','271200qiUZvp','concentration','pCacheAndGet','sphere','instant','assign','join','find','source','getEntryDescription','filter','miscTags','page','pGetIconImage','/media/icon/scroll-unfurled.svg','scaling','361972RMDIbM','touch','unit','includes','href','getNameWithSourcePart','foundrySpell','scalingLevelDice','1cKwEYZ','toLowerCase','year','_getReDiceYourSpellcastingMod','data','time','keys','split','OwnedItem','getItemSource','copy','push','miles','232660oMeaZG','MODULE_NAME','entries','number','Failed\x20to\x20import\x20spell\x20with\x20hash\x20\x22','special','value','PG_SPELLS','util','usesPer','set','stringify','1gVUxFV','pGetCompendiumImage','getActorSpell','parts','getActorSpellItemOpts','amount','none','427769sNjVrX','durationAmount','pGetSpellAdditionalData','pGetSpellHashToItemPosMapAndFillSpellsFromTagIds','type'];const _0x1467=function(_0x5842ba,_0x57514d){_0x5842ba=_0x5842ba-0x81;let _0x19c541=_0x19c5[_0x5842ba];return _0x19c541;};const _0x28f034=_0x1467;(function(_0x43c886,_0xdcba63){const _0x39656e=_0x1467;while(!![]){try{const _0x5a8eb4=-parseInt(_0x39656e(0xb2))*parseInt(_0x39656e(0x81))+parseInt(_0x39656e(0x94))+parseInt(_0x39656e(0x88))+parseInt(_0x39656e(0xf6))+parseInt(_0x39656e(0xa4))+parseInt(_0x39656e(0xfe))*parseInt(_0x39656e(0xe6))+parseInt(_0x39656e(0x10b))*-parseInt(_0x39656e(0xb6));if(_0x5a8eb4===_0xdcba63)break;else _0x43c886['push'](_0x43c886['shift']());}catch(_0x3bccf2){_0x43c886['push'](_0x43c886['shift']());}}}(_0x19c5,0x40df2));import{Vetools}from'./Vetools.js';import{UtilActors}from'./UtilActors.js';import{Config}from'./Config.js';import{SharedConsts}from'../shared/SharedConsts.js';import{UtilApplications}from'./UtilApplications.js';import{LGT}from'./Util.js';import{UtilEvents}from'./UtilEvents.js';import{DataConverter}from'./DataConverter.js';class DataConverterSpell{static async[_0x28f034(0xe4)](_0x1a77a7,_0x299f14){const _0x272b59=_0x28f034;_0x299f14=_0x299f14||{};const _0x6e7725=this[_0x272b59(0xe5)](_0x1a77a7),_0x55cc2c=JSON[_0x272b59(0x116)](_0x1a77a7[_0x272b59(0x10d)]);let _0x80a7e8='';if(_0x1a77a7[_0x272b59(0xf1)]&&_0x1a77a7['miscTags']['includes']('HL'))_0x80a7e8=_0x272b59(0xaf);if(_0x1a77a7[_0x272b59(0xb1)]&&_0x1a77a7['savingThrow'][_0x272b59(0x9c)])_0x80a7e8=_0x272b59(0xb9);if(_0x55cc2c[_0x272b59(0xff)]()[_0x272b59(0xf9)](_0x272b59(0xd0)))_0x80a7e8=_0x272b59(0xaa);if(_0x55cc2c[_0x272b59(0xff)]()[_0x272b59(0xf9)]('ranged\x20spell\x20attack'))_0x80a7e8='rsak';_0x80a7e8=_0x80a7e8||_0x272b59(0x113);const _0x530b75=UtilActors[_0x272b59(0xa7)][_0x1a77a7[_0x272b59(0x9f)]]||'',_0x200a0e=_0x1a77a7['components']&&_0x1a77a7[_0x272b59(0xc8)]['m']?_0x1a77a7['components']['m']!==!![]?''+(_0x1a77a7[_0x272b59(0xc8)]['m']['text']||_0x1a77a7['components']['m']):'':'';let _0x16175f=0x0,_0x36ee50='';const _0x1c7750=_0x1a77a7[_0x272b59(0xc7)][0x0];switch(_0x1c7750[_0x272b59(0x8c)]){case _0x272b59(0xea):_0x36ee50=_0x272b59(0xad);break;case _0x272b59(0x8d):{switch(_0x1c7750[_0x272b59(0xc7)]['type']){case _0x272b59(0x98):_0x36ee50='turn',_0x16175f=_0x1c7750[_0x272b59(0xc7)][_0x272b59(0x86)];break;case _0x272b59(0xd5):_0x36ee50=_0x272b59(0xd5),_0x16175f=_0x1c7750[_0x272b59(0xc7)][_0x272b59(0x86)];break;case _0x272b59(0xb4):_0x36ee50='minute',_0x16175f=_0x1c7750['duration'][_0x272b59(0x86)];break;case _0x272b59(0xc0):_0x36ee50=_0x272b59(0xc0),_0x16175f=_0x1c7750[_0x272b59(0xc7)][_0x272b59(0x86)];break;case'day':_0x36ee50=_0x272b59(0xc5),_0x16175f=_0x1c7750['duration'][_0x272b59(0x86)];break;case _0x272b59(0xa2):_0x36ee50=_0x272b59(0xc5),_0x16175f=_0x1c7750['duration']['amount']*0x7;break;case _0x272b59(0x100):_0x36ee50=_0x272b59(0x100),_0x16175f=_0x1c7750[_0x272b59(0xc7)][_0x272b59(0x86)];break;}break;}case'permanent':_0x36ee50=_0x272b59(0xd3);break;case _0x272b59(0x110):_0x36ee50=_0x272b59(0xc9);break;}let _0xfaa63=0x0,_0x51ab64='',_0x551b11=0x0,_0x33aba0='',_0x6c72a2='';switch(_0x1a77a7['range'][_0x272b59(0x8c)]){case RNG_SPECIAL:_0x51ab64='spec';break;case RNG_POINT:{const _0x412024=_0x1a77a7[_0x272b59(0xdc)]['distance'];switch(_0x412024[_0x272b59(0x8c)]){case RNG_SELF:{_0x33aba0=_0x272b59(0xbb),_0x6c72a2=_0x272b59(0xbb),_0x51ab64='self';break;}case RNG_UNLIMITED:case RNG_UNLIMITED_SAME_PLANE:case RNG_SIGHT:case RNG_SPECIAL:{_0x33aba0=_0x272b59(0xc9),_0x51ab64=_0x272b59(0xc9);break;}case RNG_TOUCH:{_0x33aba0=_0x272b59(0xf7),_0x51ab64=_0x272b59(0xf7);break;}case UNT_MILES:{_0xfaa63=Config[_0x272b59(0xa1)](_0x272b59(0xe2),_0x412024[_0x272b59(0x86)],UNT_MILES),_0x51ab64='mi';break;}case UNT_FEET:default:{_0xfaa63=Config[_0x272b59(0xa1)](_0x272b59(0xe2),_0x412024[_0x272b59(0x86)],UNT_FEET),_0x51ab64='ft';break;}}break;}case RNG_LINE:case RNG_CUBE:case RNG_CONE:case RNG_RADIUS:case RNG_SPHERE:case RNG_HEMISPHERE:case RNG_CYLINDER:{_0x551b11=Config['getMetricNumber'](_0x272b59(0xe2),_0x1a77a7[_0x272b59(0xdc)][_0x272b59(0x97)][_0x272b59(0x86)],_0x1a77a7[_0x272b59(0xdc)][_0x272b59(0x97)][_0x272b59(0x8c)]);if(_0x1a77a7[_0x272b59(0xdc)][_0x272b59(0x97)][_0x272b59(0x8c)]===_0x272b59(0x10a))_0x33aba0='mi';else _0x33aba0='ft';if(_0x1a77a7[_0x272b59(0xdc)][_0x272b59(0x8c)]===RNG_HEMISPHERE)_0x6c72a2=_0x272b59(0xe9);else _0x6c72a2=_0x1a77a7[_0x272b59(0xdc)]['type'];}}let _0x12332f=[],_0xd13d79=null,_0x40f1df=null;if(_0x1a77a7[_0x272b59(0xfd)]){const _0x28a8b5=[_0x1a77a7[_0x272b59(0xfd)]]['flat'](),_0x1b3b01=_0x453a60=>Math[_0x272b59(0xab)](...Object[_0x272b59(0x104)](_0x453a60)[_0x272b59(0x9a)](_0x517a67=>Number(_0x517a67))),_0x50b0cc=new RegExp('('+UtilActors[_0x272b59(0xb7)][_0x272b59(0xec)]('|')+')','i');_0x12332f[_0x272b59(0x109)](..._0x28a8b5[_0x272b59(0x9a)](_0x449e15=>{const _0x146b0b=_0x272b59,_0x2c04cf=_0x1b3b01(_0x449e15[_0x146b0b(0xf5)]),_0x390d68=_0x449e15[_0x146b0b(0xf5)][_0x2c04cf],_0x5abb5f=_0x50b0cc[_0x146b0b(0xcc)](_0x449e15[_0x146b0b(0xd6)]||'');return[(_0x390d68||'')[_0x146b0b(0xce)](/{{spellcasting_mod}}/g,_0x146b0b(0x8f)),_0x5abb5f?_0x5abb5f[0x1][_0x146b0b(0xff)]():null];}));const _0x17ee83=_0x28a8b5[0x0],_0x35fbc3=_0x1b3b01(_0x17ee83[_0x272b59(0xf5)]);_0xd13d79=_0x17ee83[_0x272b59(0xf5)][_0x35fbc3];}else{const _0x1a92ae=[];if(_0x1a77a7[_0x272b59(0x90)]&&_0x1a77a7[_0x272b59(0x90)][_0x272b59(0x9c)]){if(_0x55cc2c['toLowerCase']()[_0x272b59(0xf9)]('when\x20you\x20reach\x205th\x20level')){const _0x5b4edf=[];_0x55cc2c[_0x272b59(0xce)](/\({@damage ([^}]+)}\)/g,(..._0x42d28d)=>_0x5b4edf[_0x272b59(0x109)](_0x42d28d[0x1]));if(_0x5b4edf[_0x272b59(0x9c)]===0x3){const _0x2869dc=/(?:^|[^(]){@damage ([^}]+)}(?:[^)]|$)/['exec'](_0x55cc2c);if(_0x2869dc)_0xd13d79=_0x2869dc[0x1];else _0xd13d79=_0x5b4edf[0x0];}}_0x55cc2c[_0x272b59(0xce)](/{@damage ([^}]+)} ([^ ]+)(, [^ ]+)*(,? or [^ ]+)? damage/ig,(..._0x49dbc0)=>{_0x1a92ae['push']([_0x49dbc0[0x1],_0x49dbc0[0x2]]);});}if(_0x1a77a7[_0x272b59(0xf1)]&&_0x1a77a7[_0x272b59(0xf1)]['some'](_0x13eb79=>_0x13eb79==='HL')){const _0x54c447=['',_0x272b59(0xcf)];_0x55cc2c[_0x272b59(0xce)](this[_0x272b59(0x101)](),(..._0x3fed00)=>{const _0x1985b3=_0x272b59,[,_0x1490a3,_0x33ae8c]=_0x3fed00;_0x54c447[0x0]=_0x1490a3;if(_0x33ae8c)_0x54c447[0x0]=_0x54c447[0x0]+_0x1985b3(0xc3);}),_0x1a92ae['push'](_0x54c447);}_0x1a77a7[_0x272b59(0xb0)]&&JSON[_0x272b59(0x116)](_0x1a77a7[_0x272b59(0xb0)])['replace'](/{@(?:scaledice|scaledamage) ([^}]+)}/i,(..._0x4abfac)=>{const _0x31f722=_0x272b59,[_0x597884,_0x859f91,_0x1cc635]=_0x4abfac[0x1][_0x31f722(0x105)]('|');_0x40f1df=_0x1cc635;}),_0x12332f[_0x272b59(0x109)](..._0x1a92ae);}_0x12332f=_0x12332f[_0x272b59(0xf0)](Boolean);let _0x3a8b67='';!_0x12332f[_0x272b59(0x9c)]&&_0x55cc2c['replace'](this[_0x272b59(0x101)](),(..._0x14bf06)=>{const [,_0x46ed82,_0x19827a]=_0x14bf06;_0x3a8b67=_0x46ed82;if(_0x19827a)_0x3a8b67=_0x3a8b67+'\x20+\x20@mod';});let _0x3a7696='';if(_0x1a77a7[_0x272b59(0xb1)]&&_0x1a77a7[_0x272b59(0xb1)][_0x272b59(0x9c)])_0x3a7696=_0x1a77a7[_0x272b59(0xb1)][0x0][_0x272b59(0xa5)](0x0,0x3)[_0x272b59(0xff)]();const _0x4c7289=await DataConverter[_0x272b59(0xf3)](_0x272b59(0xae),_0x1a77a7)||await DataConverter[_0x272b59(0x82)]('spell',_0x1a77a7)||_0x272b59(0xd7)+SharedConsts[_0x272b59(0x10c)]+_0x272b59(0xf4),_0x58b7d5=await DataConverter[_0x272b59(0xa8)](_0x272b59(0xae),_0x1a77a7);_0x58b7d5&&(_0x551b11=MiscUtil['get'](_0x58b7d5,_0x272b59(0x102),_0x272b59(0xc4),_0x272b59(0x111))||_0x551b11,_0x33aba0=MiscUtil[_0x272b59(0x96)](_0x58b7d5,_0x272b59(0x102),_0x272b59(0xc4),'units')||_0x33aba0,_0x6c72a2=MiscUtil[_0x272b59(0x96)](_0x58b7d5,_0x272b59(0x102),_0x272b59(0xc4),_0x272b59(0x8c))||_0x6c72a2,_0x12332f=MiscUtil[_0x272b59(0x96)](_0x58b7d5,_0x272b59(0x102),'damage',_0x272b59(0x84))||_0x12332f);const _0x331dc0=await this[_0x272b59(0xda)](_0x1a77a7,_0x33aba0);if(_0x299f14[_0x272b59(0x89)]!==undefined)_0x16175f=_0x299f14[_0x272b59(0x89)];if(_0x299f14['durationUnit']!==undefined)_0x36ee50=_0x299f14['durationUnit'];const _0x406d65={'name':UtilApplications[_0x272b59(0x9d)](DataConverter[_0x272b59(0xfb)](_0x1a77a7)),'type':_0x272b59(0xae),'data':{'source':DataConverter[_0x272b59(0xde)](_0x1a77a7),'description':{'value':_0x6e7725,'chat':'','unidentified':''},'actionType':_0x80a7e8,'level':_0x1a77a7[_0x272b59(0x9e)],'school':_0x530b75,'components':{'value':'','vocal':_0x1a77a7['components']&&_0x1a77a7[_0x272b59(0xc8)]['v'],'somatic':_0x1a77a7['components']&&_0x1a77a7[_0x272b59(0xc8)]['s'],'material':!!(_0x1a77a7[_0x272b59(0xc8)]&&_0x1a77a7[_0x272b59(0xc8)]['m']),'ritual':_0x1a77a7[_0x272b59(0xac)]&&_0x1a77a7[_0x272b59(0xac)]['ritual'],'concentration':!!MiscUtil[_0x272b59(0x96)](_0x1a77a7,_0x272b59(0xc7),'0',_0x272b59(0xe7))},'materials':{'value':_0x200a0e,'consumed':!!MiscUtil[_0x272b59(0x96)](_0x1a77a7,_0x272b59(0xc8),'m',_0x272b59(0xb3)),'cost':Math['round']((MiscUtil[_0x272b59(0x96)](_0x1a77a7,'components','m','cost')||0x0)/0x64),'supply':0x0},'target':{'value':_0x551b11,'units':_0x33aba0,'type':_0x6c72a2},'range':{'value':_0xfaa63,'units':_0x51ab64,'long':0x0},'activation':{'type':_0x1a77a7[_0x272b59(0x103)][0x0][_0x272b59(0xf8)],'cost':_0x1a77a7[_0x272b59(0x103)][0x0][_0x272b59(0x10e)],'condition':Renderer[_0x272b59(0x93)](_0x1a77a7[_0x272b59(0x103)][0x0][_0x272b59(0xe0)]||'')},'duration':{'value':_0x16175f,'units':_0x36ee50},'damage':{'parts':_0x12332f,'versatile':''},'scaling':{'mode':_0xd13d79?'cantrip':_0x40f1df?_0x272b59(0x9e):_0x272b59(0x87),'formula':_0xd13d79||_0x40f1df||''},'save':{'ability':_0x3a7696,'dc':null},'ability':_0x299f14['abilityAbv']||'','uses':{'value':_0x299f14['usesCurrent']||0x0,'max':_0x299f14['usesMax']||0x0,'per':_0x299f14['usesPer']||''},'attackBonus':0x0,'chatFlavor':'','critical':null,'formula':_0x3a8b67,'preparation':{'mode':_0x1a77a7[_0x272b59(0x9e)]===0x0?_0x272b59(0xd4):_0x299f14[_0x272b59(0xd9)]||'prepared','prepared':_0x1a77a7[_0x272b59(0x9e)]===0x0?!![]:!!_0x299f14['isPrepared']},'consume':{'type':'','target':null,'amount':null},..._0x331dc0||{}},'img':_0x4c7289,'flags':{},'effects':[]};if(_0x299f14['isAddPermission'])_0x406d65[_0x272b59(0xa0)]={'default':Config['get'](_0x272b59(0xe2),_0x272b59(0xc2))};return _0x406d65;}static[_0x28f034(0x101)](){return/{@dice ([^}]+)}(\s*\+\s*your\s+spellcasting\s+ability\s+modifier)?/i;}static[_0x28f034(0xe5)](_0x6cc9d9){const _0x150b81=_0x28f034;if(!Config[_0x150b81(0x96)](_0x150b81(0xe2),'isImportDescription'))return'';const _0x388043=DataConverter[_0x150b81(0xef)](_0x6cc9d9),_0x3e14c2=_0x6cc9d9[_0x150b81(0xb0)]?DataConverter[_0x150b81(0xef)](_0x6cc9d9,{'prop':_0x150b81(0xb0)}):'';return[_0x388043,_0x3e14c2][_0x150b81(0xf0)](Boolean)[_0x150b81(0xec)]('');}static async[_0x28f034(0xda)](_0xe453d4,_0x228852){const _0x1e4798=_0x28f034;let _0x31fb8e=(MiscUtil[_0x1e4798(0x96)](BrewUtil,_0x1e4798(0x92),_0x1e4798(0xfc))||[])[_0x1e4798(0xed)](_0xbcfda5=>_0xbcfda5[_0x1e4798(0xb5)]===_0xe453d4['name']&&_0xbcfda5['source']===_0xe453d4[_0x1e4798(0xee)]);if(!_0x31fb8e){const _0x4198ed=await Vetools[_0x1e4798(0x8a)]();_0x31fb8e=_0x4198ed[_0x1e4798(0xae)][_0x1e4798(0xed)](_0x40363f=>_0x40363f['name']===_0xe453d4['name']&&_0x40363f[_0x1e4798(0xee)]===_0xe453d4[_0x1e4798(0xee)]);}const _0x20f532=_0xe453d4[_0x1e4798(0xc1)];if(!_0x31fb8e&&!_0x20f532)return null;const _0x2f6247=MiscUtil[_0x1e4798(0x108)](_0x31fb8e?_0x31fb8e[_0x1e4798(0x102)]:_0x20f532);if(_0x31fb8e&&_0x20f532)Object[_0x1e4798(0xeb)](_0x2f6247,MiscUtil['copy'](_0x20f532));if(_0x2f6247[_0x1e4798(0xca)])_0x2f6247[_0x1e4798(0xca)]=Config[_0x1e4798(0xa1)](_0x1e4798(0xe2),_0x2f6247[_0x1e4798(0xca)],_0x228852);return _0x2f6247;}static async[_0x28f034(0x8b)](_0x5b9332,_0x21a131,_0x451092){const _0x23692a=_0x28f034;_0x451092=_0x451092||{};const _0x6d3766=_0x451092['hashToIdMap']||{};for(const _0x10d906 of _0x21a131){const _0x4e14a1=_0x10d906[_0x23692a(0xdb)]||_0x10d906,_0x3f4259=_0x10d906[_0x23692a(0xdb)]?_0x10d906:null;if(_0x3f4259?.[_0x23692a(0xc6)])continue;let [_0x28e806,_0x237a18]=_0x4e14a1[_0x23692a(0x105)]('|');if(!_0x237a18)_0x237a18=SRC_PHB;const _0xab0957=UrlUtil[_0x23692a(0xbf)][UrlUtil[_0x23692a(0x112)]]({'name':_0x28e806,'source':_0x237a18});if(_0x6d3766[_0xab0957]!=null&&!_0x3f4259){await this[_0x23692a(0xbe)](_0x5b9332,_0x6d3766[_0xab0957],_0x237a18,_0xab0957,_0x451092);continue;}_0x3f4259&&(_0x451092={..._0x451092},_0x451092['optsGetSpellItem']=MiscUtil[_0x23692a(0x108)](_0x451092[_0x23692a(0x8e)]||{}),_0x451092[_0x23692a(0x8e)][_0x23692a(0x95)]=_0x3f4259['uses'],_0x451092['optsGetSpellItem'][_0x23692a(0xba)]=_0x3f4259['uses'],_0x451092[_0x23692a(0x8e)][_0x23692a(0x114)]=_0x3f4259['usesPer'],_0x451092[_0x23692a(0x8e)]['isPrepared']=_0x3f4259[_0x23692a(0xa6)]!=null?_0x3f4259['isPrepared']:_0x451092[_0x23692a(0x8e)][_0x23692a(0xa6)],_0x451092[_0x23692a(0x8e)]['preparationMode']=_0x3f4259[_0x23692a(0xd9)]!=null?_0x3f4259[_0x23692a(0xd9)]:_0x451092[_0x23692a(0x8e)][_0x23692a(0xd9)],_0x451092[_0x23692a(0xcb)]=!![]);const _0x26a968=await DataConverterSpell[_0x23692a(0xbd)](_0x5b9332,_0x237a18,_0xab0957,_0x451092);if(_0x26a968==null||_0x3f4259)continue;_0x6d3766[_0xab0957]=_0x26a968;}return _0x6d3766;}static async[_0x28f034(0xbe)](_0x5e03ec,_0x4e068c,_0x27e9f5,_0x205b5b,_0x38491a){const _0x2a8ec1=_0x28f034,_0x221f5c=_0x5e03ec['items']['find'](_0x228839=>_0x228839[_0x2a8ec1(0xd1)]===_0x4e068c||_0x228839['id']===_0x4e068c);if(!_0x221f5c)return;const _0x45c985=_0x221f5c[_0x2a8ec1(0x102)];_0x38491a=_0x38491a||{};let _0x1b54d1;try{_0x1b54d1=await Renderer[_0x2a8ec1(0xd8)][_0x2a8ec1(0xe8)](UrlUtil[_0x2a8ec1(0x112)],_0x27e9f5,_0x205b5b);}catch(_0x5a7014){console[_0x2a8ec1(0xdf)](...LGT,_0x2a8ec1(0x10f)+_0x205b5b+'\x22!',_0x5a7014);return;}if(!_0x1b54d1)return;const _0x2f3eba=await DataConverterSpell['pGetSpellItem'](_0x1b54d1,{...UtilActors['getActorSpellItemOpts'](_0x5e03ec),..._0x38491a[_0x2a8ec1(0x8e)]||{}}),_0x282515={'_id':_0x221f5c[_0x2a8ec1(0xd1)],'data':{}};let _0x5df820=![];MiscUtil[_0x2a8ec1(0x96)](_0x45c985['data'],_0x2a8ec1(0x91),_0x2a8ec1(0xa9))===_0x2a8ec1(0xe1)&&MiscUtil[_0x2a8ec1(0x96)](_0x2f3eba['data'],_0x2a8ec1(0x91),_0x2a8ec1(0xa9))===_0x2a8ec1(0xd4)&&(_0x5df820=!![],MiscUtil['set'](_0x282515[_0x2a8ec1(0x102)],_0x2a8ec1(0x91),'mode','always')),MiscUtil[_0x2a8ec1(0x96)](_0x45c985[_0x2a8ec1(0x102)],_0x2a8ec1(0x91),'prepared')!==!![]&&MiscUtil[_0x2a8ec1(0x96)](_0x2f3eba[_0x2a8ec1(0x102)],_0x2a8ec1(0x91),_0x2a8ec1(0xe1))===!![]&&(_0x5df820=!![],MiscUtil[_0x2a8ec1(0x115)](_0x282515[_0x2a8ec1(0x102)],'preparation',_0x2a8ec1(0xe1),!![])),_0x5df820&&await _0x5e03ec['updateEmbeddedEntity'](_0x2a8ec1(0x106),_0x282515);}static async['pGetSpellHashToItemPosMapAndFillSpells'](_0x1c2305,_0x2b66fb,_0x41a65d){const _0x17c59e=_0x28f034;_0x41a65d=_0x41a65d||{};const _0x5e639e=[],_0x3d769e=/{@spell ([^}]+)}/gi;let _0x272186;while(_0x272186=_0x3d769e[_0x17c59e(0xcc)](_0x2b66fb)){_0x5e639e['push'](_0x272186[0x1]);}return this[_0x17c59e(0x8b)](_0x1c2305,_0x5e639e,_0x41a65d);}static async[_0x28f034(0xbd)](_0x5ea9a4,_0x182ab6,_0x797d5,_0x55d63b){const _0x4826dd=_0x28f034;_0x55d63b=_0x55d63b||{};let _0x2b930e;try{_0x2b930e=await Renderer[_0x4826dd(0xd8)]['pCacheAndGet'](UrlUtil[_0x4826dd(0x112)],_0x182ab6,_0x797d5);}catch(_0x36446a){return console[_0x4826dd(0xdf)](...LGT,_0x4826dd(0x10f)+_0x797d5+'\x22!',_0x36446a),null;}if(!_0x2b930e)return null;if(!_0x55d63b['isIgnoreExisting']){const _0x4effb7=DataConverterSpell[_0x4826dd(0x83)](_0x5ea9a4,_0x2b930e[_0x4826dd(0xb5)],_0x2b930e[_0x4826dd(0xee)]);if(_0x4effb7)return _0x4effb7['_id']||_0x4effb7[_0x4826dd(0x102)][_0x4826dd(0xd1)];}const _0x31bd41=await DataConverterSpell[_0x4826dd(0xe4)](_0x2b930e,{...UtilActors[_0x4826dd(0x85)](_0x5ea9a4),..._0x55d63b[_0x4826dd(0x8e)]||{}});if(_0x55d63b['isTemporary']){const _0x15b04e=await Item[_0x4826dd(0xcd)](_0x31bd41,{'temporary':!![]});(_0x5ea9a4[_0x4826dd(0x102)][_0x4826dd(0xe3)]=_0x5ea9a4[_0x4826dd(0x102)][_0x4826dd(0xe3)]||[])[_0x4826dd(0x109)](_0x15b04e);}else{const _0x4dc5be=await _0x5ea9a4[_0x4826dd(0x9b)](_0x4826dd(0x106),_0x31bd41,{});return _0x4dc5be[_0x4826dd(0xd1)]||_0x4dc5be['data']['_id'];}}static[_0x28f034(0x83)](_0xb52aa5,_0x3db1d1,_0x15722b){const _0x29d5b8=_0x28f034;if(!_0x3db1d1||!_0x15722b)return null;return _0xb52aa5[_0x29d5b8(0xe3)]&&_0xb52aa5[_0x29d5b8(0xe3)][_0x29d5b8(0xed)](_0x137efa=>(_0x137efa[_0x29d5b8(0xb5)]||'')['toLowerCase']()===_0x3db1d1[_0x29d5b8(0xff)]()&&(!Config[_0x29d5b8(0x96)]('import','isStrictMatching')||(DataConverter[_0x29d5b8(0x107)](_0x137efa)||'')[_0x29d5b8(0xff)]()===_0x15722b[_0x29d5b8(0xff)]()));}static[_0x28f034(0xb8)](_0x500531,_0x54916,_0x3e7fde){const _0x510037=_0x28f034;if(_0x3e7fde[_0x510037(0xfa)]&&_0x3e7fde['href'][_0x510037(0xd8)]){if(_0x3e7fde['href']['hover'][_0x510037(0xf2)]===UrlUtil[_0x510037(0x112)]){const _0x5fc326=_0x3e7fde[_0x510037(0xfa)][_0x510037(0xbc)]?_0x3e7fde[_0x510037(0xfa)][_0x510037(0xdd)]:UrlUtil[_0x510037(0xa3)](_0x3e7fde[_0x510037(0xfa)][_0x510037(0xdd)]),_0x20b2fa=_0x54916[_0x5fc326];if(_0x20b2fa!=null){const _0xa46345=JSON['stringify']({'actorId':_0x500531,'itemId':_0x20b2fa})[_0x510037(0x99)]();return{'isDisableEvents':!![],'string':UtilEvents[_0x510037(0xd2)]+'=\x22'+_0xa46345+'\x22'};}}}return null;}}export{DataConverterSpell};
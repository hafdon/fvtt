const _0x2100=['consume','@mod','createEmbeddedEntity','importSpell','foundryData','1kBPcOl','get','inst','miscTags','usesCurrent','concentration','msak','getNameWithSourcePart','split','ritual','2075EmsWNu','pGetIconImage','label','filter','preparationMode','sphere','durationUnit','unit','cantrip','self','set','ranged\x20spell\x20attack','_getDescription','mode','condition','number','296484DzYdFT','min','time','parts','replace','toLowerCase','none','isPrepared','_pGetAdditionalData','pGetSpellAdditionalData','school','uses','meta','substring','cost','_pFillSpellPromises_pUpdateSpellItem','pGetCompendiumImage','healing','push','VET_SPELL_SCHOOL_TO_ABV','entries','timed','duration','encodeForHash','damage','hashToIdMap','minute','1656957UHdSCr','1TsoTEt','prepared','PG_SPELLS','length','foundrySpell','items','stripTags','pGetSpellHashToItemPosMapAndFillSpellsFromTagIds','amount','MODULE_NAME','getSrdCompendiumEntity','hover','pGetSpellHashToItemPosMapAndFillSpells','includes','isStrictMatching','getItemSource','URL_TO_HASH_BUILDER','doHookSpellLinkRender','273347DYipVc','preparation','_pFillSpellPromises_pAddSpellItem','permissions','special','getActorSpellItemOpts','permanent','day','_id','assign','spec','abilityAbv','savingThrow','target.value','level','getMetricNumber','miles','type','getEntryDescription','538634TzRPZm','perm','week','rsak','touch','import','round','distance','scaling','hash','modules/','isAddPermission','uid','map','optsGetSpellItem','spell','name','scalingLevelDice','usesPer','melee\x20spell\x20attack','components','\x20+\x20@mod','source','isIgnoreExisting','copy','heal','damageInflict','hour','usesMax','join','text','7121nXUwZv','1437195eNSFIu','href','getActorSpell','pGetSpellItem','always','stringify','241MsnTed','hashPreEncoded','escapeQuotes','2141OKDRhD','save','target','OwnedItem','Failed\x20to\x20import\x20spell\x20with\x20hash\x20\x22','data','year','getSourceWithPagePart','entriesHigherLevel','range','some','flat','exec','updateEmbeddedEntity','find','LINK_DATA_SHEET_ITEM'];const _0x38b3=function(_0x35090f,_0xd38548){_0x35090f=_0x35090f-0x1bb;let _0x2100af=_0x2100[_0x35090f];return _0x2100af;};const _0x11f900=_0x38b3;(function(_0x8c1fae,_0x3ee0c9){const _0x2341ef=_0x38b3;while(!![]){try{const _0x36c671=-parseInt(_0x2341ef(0x1db))*parseInt(_0x2341ef(0x22c))+parseInt(_0x2341ef(0x1ee))+-parseInt(_0x2341ef(0x20d))*-parseInt(_0x2341ef(0x214))+-parseInt(_0x2341ef(0x1c9))*-parseInt(_0x2341ef(0x1c8))+parseInt(_0x2341ef(0x246))+parseInt(_0x2341ef(0x20e))+-parseInt(_0x2341ef(0x236))*parseInt(_0x2341ef(0x217));if(_0x36c671===_0x3ee0c9)break;else _0x8c1fae['push'](_0x8c1fae['shift']());}catch(_0x2e44e3){_0x8c1fae['push'](_0x8c1fae['shift']());}}}(_0x2100,0xe2ee5));import{Vetools}from'./Vetools.js';import{UtilActors}from'./UtilActors.js';import{Config}from'./Config.js';import{SharedConsts}from'../shared/SharedConsts.js';import{UtilApplications}from'./UtilApplications.js';import{LGT}from'./Util.js';import{UtilEvents}from'./UtilEvents.js';import{DataConverter}from'./DataConverter.js';class DataConverterSpell{static async[_0x11f900(0x211)](_0x30148f,_0x1fdb4e){const _0x704f38=_0x11f900;_0x1fdb4e=_0x1fdb4e||{};const _0x361e20=this[_0x704f38(0x242)](_0x30148f),_0x5f2baf=JSON['stringify'](_0x30148f[_0x704f38(0x1c1)]);let _0x2fb626='';if(_0x30148f[_0x704f38(0x22f)]&&_0x30148f[_0x704f38(0x22f)][_0x704f38(0x1d6)]('HL'))_0x2fb626=_0x704f38(0x207);if(_0x30148f['savingThrow']&&_0x30148f[_0x704f38(0x1e7)][_0x704f38(0x1cc)])_0x2fb626=_0x704f38(0x218);if(_0x5f2baf[_0x704f38(0x24b)]()[_0x704f38(0x1d6)](_0x704f38(0x201)))_0x2fb626=_0x704f38(0x232);if(_0x5f2baf[_0x704f38(0x24b)]()[_0x704f38(0x1d6)](_0x704f38(0x241)))_0x2fb626=_0x704f38(0x1f1);_0x2fb626=_0x2fb626||'util';const _0x523d51=UtilActors[_0x704f38(0x1c0)][_0x30148f[_0x704f38(0x250)]]||'',_0x3451ac=_0x30148f[_0x704f38(0x202)]&&_0x30148f[_0x704f38(0x202)]['m']?_0x30148f[_0x704f38(0x202)]['m']!==!![]?''+(_0x30148f[_0x704f38(0x202)]['m'][_0x704f38(0x20c)]||_0x30148f[_0x704f38(0x202)]['m']):'':'';let _0xf27484=0x0,_0x39858e='';const _0x577ef3=_0x30148f[_0x704f38(0x1c3)][0x0];switch(_0x577ef3[_0x704f38(0x1ec)]){case'instant':_0x39858e=_0x704f38(0x22e);break;case _0x704f38(0x1c2):{switch(_0x577ef3[_0x704f38(0x1c3)]['type']){case'turn':_0x39858e='turn',_0xf27484=_0x577ef3[_0x704f38(0x1c3)][_0x704f38(0x1d1)];break;case _0x704f38(0x1f4):_0x39858e='round',_0xf27484=_0x577ef3['duration']['amount'];break;case _0x704f38(0x1c7):_0x39858e='minute',_0xf27484=_0x577ef3[_0x704f38(0x1c3)][_0x704f38(0x1d1)];break;case _0x704f38(0x209):_0x39858e=_0x704f38(0x209),_0xf27484=_0x577ef3[_0x704f38(0x1c3)][_0x704f38(0x1d1)];break;case _0x704f38(0x1e2):_0x39858e='day',_0xf27484=_0x577ef3[_0x704f38(0x1c3)][_0x704f38(0x1d1)];break;case _0x704f38(0x1f0):_0x39858e=_0x704f38(0x1e2),_0xf27484=_0x577ef3[_0x704f38(0x1c3)][_0x704f38(0x1d1)]*0x7;break;case _0x704f38(0x21d):_0x39858e='year',_0xf27484=_0x577ef3[_0x704f38(0x1c3)][_0x704f38(0x1d1)];break;}break;}case _0x704f38(0x1e1):_0x39858e=_0x704f38(0x1ef);break;case _0x704f38(0x1df):_0x39858e=_0x704f38(0x1e5);break;}let _0x267834=0x0,_0x5c8615='',_0x2aff31=0x0,_0x404413='',_0x2b2ddd='';switch(_0x30148f['range']['type']){case RNG_SPECIAL:_0x5c8615='spec';break;case RNG_POINT:{const _0x3d8706=_0x30148f['range'][_0x704f38(0x1f5)];switch(_0x3d8706[_0x704f38(0x1ec)]){case RNG_SELF:{_0x404413=_0x704f38(0x23f),_0x2b2ddd='self',_0x5c8615=_0x704f38(0x23f);break;}case RNG_UNLIMITED:case RNG_UNLIMITED_SAME_PLANE:case RNG_SIGHT:case RNG_SPECIAL:{_0x404413=_0x704f38(0x1e5),_0x5c8615='spec';break;}case RNG_TOUCH:{_0x404413=_0x704f38(0x1f2),_0x5c8615=_0x704f38(0x1f2);break;}case UNT_MILES:{_0x267834=Config[_0x704f38(0x1ea)](_0x704f38(0x22a),_0x3d8706[_0x704f38(0x1d1)],UNT_MILES),_0x5c8615='mi';break;}case UNT_FEET:default:{_0x267834=Config[_0x704f38(0x1ea)](_0x704f38(0x22a),_0x3d8706[_0x704f38(0x1d1)],UNT_FEET),_0x5c8615='ft';break;}}break;}case RNG_LINE:case RNG_CUBE:case RNG_CONE:case RNG_RADIUS:case RNG_SPHERE:case RNG_HEMISPHERE:case RNG_CYLINDER:{_0x2aff31=Config['getMetricNumber'](_0x704f38(0x22a),_0x30148f['range'][_0x704f38(0x1f5)][_0x704f38(0x1d1)],_0x30148f[_0x704f38(0x220)][_0x704f38(0x1f5)][_0x704f38(0x1ec)]);if(_0x30148f[_0x704f38(0x220)][_0x704f38(0x1f5)][_0x704f38(0x1ec)]===_0x704f38(0x1eb))_0x404413='mi';else _0x404413='ft';if(_0x30148f['range'][_0x704f38(0x1ec)]===RNG_HEMISPHERE)_0x2b2ddd=_0x704f38(0x23b);else _0x2b2ddd=_0x30148f[_0x704f38(0x220)][_0x704f38(0x1ec)];}}let _0x4e5cd3=[],_0x35bf45=null,_0x1745a9=null;if(_0x30148f[_0x704f38(0x1ff)]){const _0x305020=[_0x30148f['scalingLevelDice']][_0x704f38(0x222)](),_0x587e4d=_0x49a612=>Math[_0x704f38(0x247)](...Object['keys'](_0x49a612)[_0x704f38(0x1fb)](_0x2e9092=>Number(_0x2e9092))),_0x224608=new RegExp('('+UtilActors['VALID_DAMAGE_TYPES'][_0x704f38(0x20b)]('|')+')','i');_0x4e5cd3[_0x704f38(0x1bf)](..._0x305020[_0x704f38(0x1fb)](_0x672bd9=>{const _0x28b95f=_0x704f38,_0x45de42=_0x587e4d(_0x672bd9['scaling']),_0xd6fe56=_0x672bd9['scaling'][_0x45de42],_0x56e1c1=_0x224608[_0x28b95f(0x223)](_0x672bd9[_0x28b95f(0x238)]||'');return[(_0xd6fe56||'')[_0x28b95f(0x24a)](/{{spellcasting_mod}}/g,_0x28b95f(0x228)),_0x56e1c1?_0x56e1c1[0x1][_0x28b95f(0x24b)]():null];}));const _0x5359df=_0x305020[0x0],_0x23a81b=_0x587e4d(_0x5359df[_0x704f38(0x1f6)]);_0x35bf45=_0x5359df[_0x704f38(0x1f6)][_0x23a81b];}else{const _0x4201c9=[];if(_0x30148f[_0x704f38(0x208)]&&_0x30148f[_0x704f38(0x208)][_0x704f38(0x1cc)]){if(_0x5f2baf['toLowerCase']()[_0x704f38(0x1d6)]('when\x20you\x20reach\x205th\x20level')){const _0x4b1168=[];_0x5f2baf[_0x704f38(0x24a)](/\({@damage ([^}]+)}\)/g,(..._0x4d90ca)=>_0x4b1168['push'](_0x4d90ca[0x1]));if(_0x4b1168['length']===0x3){const _0x1d9793=/(?:^|[^(]){@damage ([^}]+)}(?:[^)]|$)/[_0x704f38(0x223)](_0x5f2baf);if(_0x1d9793)_0x35bf45=_0x1d9793[0x1];else _0x35bf45=_0x4b1168[0x0];}}_0x5f2baf['replace'](/{@damage ([^}]+)} ([^ ]+)(, [^ ]+)*(,? or [^ ]+)? damage/ig,(..._0x29e5c7)=>{const _0x204b1a=_0x704f38;_0x4201c9[_0x204b1a(0x1bf)]([_0x29e5c7[0x1],_0x29e5c7[0x2]]);});}if(_0x30148f[_0x704f38(0x22f)]&&_0x30148f['miscTags'][_0x704f38(0x221)](_0x1019d0=>_0x1019d0==='HL')){const _0x56c1ea=['',_0x704f38(0x1be)];_0x5f2baf[_0x704f38(0x24a)](/{@dice ([^}]+)}(\s*\+\s*your\s+spellcasting\s+ability\s+modifier)/i,(..._0x3399d7)=>{const _0x52458f=_0x704f38;_0x56c1ea[0x0]=_0x3399d7[0x1],_0x3399d7[0x1]&&(_0x56c1ea[0x0]=_0x56c1ea[0x0]+_0x52458f(0x203));}),_0x4201c9[_0x704f38(0x1bf)](_0x56c1ea);}_0x30148f[_0x704f38(0x21f)]&&JSON['stringify'](_0x30148f['entriesHigherLevel'])['replace'](/{@(?:scaledice|scaledamage) ([^}]+)}/i,(..._0x10d4a6)=>{const _0x16c796=_0x704f38,[_0x120d53,_0x1e408a,_0x333814]=_0x10d4a6[0x1][_0x16c796(0x234)]('|');_0x1745a9=_0x333814;}),_0x4e5cd3['push'](..._0x4201c9);}_0x4e5cd3=_0x4e5cd3[_0x704f38(0x239)](Boolean);let _0x3cc010='';if(_0x30148f[_0x704f38(0x1e7)]&&_0x30148f['savingThrow'][_0x704f38(0x1cc)])_0x3cc010=_0x30148f[_0x704f38(0x1e7)][0x0][_0x704f38(0x253)](0x0,0x3)[_0x704f38(0x24b)]();const _0x40ce32=await DataConverter[_0x704f38(0x237)]('spell',_0x30148f)||await DataConverter[_0x704f38(0x1bd)](_0x704f38(0x1fd),_0x30148f)||_0x704f38(0x1f8)+SharedConsts[_0x704f38(0x1d2)]+'/media/icon/scroll-unfurled.svg',_0x4eca1d=await DataConverter[_0x704f38(0x1d3)](_0x704f38(0x1fd),_0x30148f);_0x4eca1d&&(_0x2aff31=MiscUtil[_0x704f38(0x22d)](_0x4eca1d,_0x704f38(0x21c),_0x704f38(0x219),'value')||_0x2aff31,_0x404413=MiscUtil[_0x704f38(0x22d)](_0x4eca1d,_0x704f38(0x21c),'target','units')||_0x404413,_0x2b2ddd=MiscUtil[_0x704f38(0x22d)](_0x4eca1d,_0x704f38(0x21c),_0x704f38(0x219),_0x704f38(0x1ec))||_0x2b2ddd,_0x4e5cd3=MiscUtil[_0x704f38(0x22d)](_0x4eca1d,_0x704f38(0x21c),_0x704f38(0x1c5),_0x704f38(0x249))||_0x4e5cd3);const _0x34f110=await this[_0x704f38(0x24e)](_0x30148f,_0x404413);if(_0x1fdb4e['durationAmount']!==undefined)_0xf27484=_0x1fdb4e['durationAmount'];if(_0x1fdb4e['durationUnit']!==undefined)_0x39858e=_0x1fdb4e[_0x704f38(0x23c)];const _0xf98ad2={'name':UtilApplications['getCleanEntityName'](DataConverter[_0x704f38(0x233)](_0x30148f)),'type':_0x704f38(0x1fd),'data':{'source':DataConverter[_0x704f38(0x21e)](_0x30148f),'description':{'value':_0x361e20,'chat':'','unidentified':''},'actionType':_0x2fb626,'level':_0x30148f['level'],'school':_0x523d51,'components':{'value':'','vocal':_0x30148f[_0x704f38(0x202)]&&_0x30148f[_0x704f38(0x202)]['v'],'somatic':_0x30148f['components']&&_0x30148f['components']['s'],'material':!!(_0x30148f['components']&&_0x30148f[_0x704f38(0x202)]['m']),'ritual':_0x30148f[_0x704f38(0x252)]&&_0x30148f[_0x704f38(0x252)][_0x704f38(0x235)],'concentration':!!MiscUtil['get'](_0x30148f,_0x704f38(0x1c3),'0',_0x704f38(0x231))},'materials':{'value':_0x3451ac,'consumed':!!MiscUtil[_0x704f38(0x22d)](_0x30148f,_0x704f38(0x202),'m',_0x704f38(0x227)),'cost':Math['round']((MiscUtil[_0x704f38(0x22d)](_0x30148f,_0x704f38(0x202),'m',_0x704f38(0x1bb))||0x0)/0x64),'supply':0x0},'target':{'value':_0x2aff31,'units':_0x404413,'type':_0x2b2ddd},'range':{'value':_0x267834,'units':_0x5c8615,'long':0x0},'activation':{'type':_0x30148f[_0x704f38(0x248)][0x0][_0x704f38(0x23d)],'cost':_0x30148f[_0x704f38(0x248)][0x0][_0x704f38(0x245)],'condition':Renderer[_0x704f38(0x1cf)](_0x30148f[_0x704f38(0x248)][0x0][_0x704f38(0x244)]||'')},'duration':{'value':_0xf27484,'units':_0x39858e},'damage':{'parts':_0x4e5cd3,'versatile':''},'scaling':{'mode':_0x35bf45?_0x704f38(0x23e):_0x1745a9?_0x704f38(0x1e9):_0x704f38(0x24c),'formula':_0x35bf45||_0x1745a9||''},'save':{'ability':_0x3cc010,'dc':null},'ability':_0x1fdb4e[_0x704f38(0x1e6)]||'','uses':{'value':_0x1fdb4e['usesCurrent']||0x0,'max':_0x1fdb4e['usesMax']||0x0,'per':_0x1fdb4e[_0x704f38(0x200)]||''},'attackBonus':0x0,'chatFlavor':'','critical':null,'formula':'','preparation':{'mode':_0x30148f['level']===0x0?_0x704f38(0x212):_0x1fdb4e[_0x704f38(0x23a)]||'prepared','prepared':_0x30148f[_0x704f38(0x1e9)]===0x0?!![]:!!_0x1fdb4e[_0x704f38(0x24d)]},'consume':{'type':'','target':null,'amount':null},..._0x34f110||{}},'img':_0x40ce32,'flags':{},'effects':[]};if(_0x1fdb4e[_0x704f38(0x1f9)])_0xf98ad2['permission']={'default':Config[_0x704f38(0x22d)](_0x704f38(0x22a),_0x704f38(0x1de))};return _0xf98ad2;}static[_0x11f900(0x242)](_0x301da8){const _0x13cc6d=_0x11f900;if(!Config[_0x13cc6d(0x22d)]('importSpell','isImportDescription'))return'';const _0x3ee660=DataConverter['getEntryDescription'](_0x301da8),_0x108040=_0x301da8[_0x13cc6d(0x21f)]?DataConverter[_0x13cc6d(0x1ed)](_0x301da8,{'prop':'entriesHigherLevel'}):'';return[_0x3ee660,_0x108040][_0x13cc6d(0x239)](Boolean)['join']('');}static async[_0x11f900(0x24e)](_0x50b853,_0x51fb77){const _0x2565d9=_0x11f900;let _0x1a61bc=(MiscUtil[_0x2565d9(0x22d)](BrewUtil,'homebrew',_0x2565d9(0x1cd))||[])[_0x2565d9(0x225)](_0x57869d=>_0x57869d[_0x2565d9(0x1fe)]===_0x50b853['name']&&_0x57869d[_0x2565d9(0x204)]===_0x50b853['source']);if(!_0x1a61bc){const _0x127522=await Vetools[_0x2565d9(0x24f)]();_0x1a61bc=_0x127522[_0x2565d9(0x1fd)][_0x2565d9(0x225)](_0x9953df=>_0x9953df[_0x2565d9(0x1fe)]===_0x50b853['name']&&_0x9953df[_0x2565d9(0x204)]===_0x50b853[_0x2565d9(0x204)]);}const _0x12ad55=_0x50b853[_0x2565d9(0x22b)];if(!_0x1a61bc&&!_0x12ad55)return null;const _0x3c2050=MiscUtil[_0x2565d9(0x206)](_0x1a61bc?_0x1a61bc['data']:_0x12ad55);if(_0x1a61bc&&_0x12ad55)Object[_0x2565d9(0x1e4)](_0x3c2050,MiscUtil[_0x2565d9(0x206)](_0x12ad55));if(_0x3c2050[_0x2565d9(0x1e8)])_0x3c2050['target.value']=Config[_0x2565d9(0x1ea)](_0x2565d9(0x22a),_0x3c2050[_0x2565d9(0x1e8)],_0x51fb77);return _0x3c2050;}static async[_0x11f900(0x1d0)](_0x2e90f3,_0x565d52,_0x57334c){const _0x840637=_0x11f900;_0x57334c=_0x57334c||{};const _0x425ce6=_0x57334c[_0x840637(0x1c6)]||{};for(const _0x249f66 of _0x565d52){const _0x5cccd3=_0x249f66[_0x840637(0x1fa)]||_0x249f66,_0x5d2cb5=_0x249f66['uid']?_0x249f66:null;let [_0x3e791b,_0x50254b]=_0x5cccd3[_0x840637(0x234)]('|');if(!_0x50254b)_0x50254b=SRC_PHB;const _0x3b54d6=UrlUtil[_0x840637(0x1d9)][UrlUtil['PG_SPELLS']]({'name':_0x3e791b,'source':_0x50254b});if(_0x425ce6[_0x3b54d6]!=null&&!_0x5d2cb5){await this[_0x840637(0x1bc)](_0x2e90f3,_0x425ce6[_0x3b54d6],_0x50254b,_0x3b54d6,_0x57334c);continue;}_0x5d2cb5&&(_0x57334c={..._0x57334c},_0x57334c[_0x840637(0x1fc)]=MiscUtil[_0x840637(0x206)](_0x57334c[_0x840637(0x1fc)]||{}),_0x57334c[_0x840637(0x1fc)][_0x840637(0x230)]=_0x5d2cb5[_0x840637(0x251)],_0x57334c['optsGetSpellItem'][_0x840637(0x20a)]=_0x5d2cb5[_0x840637(0x251)],_0x57334c[_0x840637(0x1fc)]['usesPer']=_0x5d2cb5['usesPer'],_0x57334c[_0x840637(0x1fc)]['isPrepared']=_0x5d2cb5[_0x840637(0x24d)]!=null?_0x5d2cb5[_0x840637(0x24d)]:_0x57334c[_0x840637(0x1fc)][_0x840637(0x24d)],_0x57334c[_0x840637(0x1fc)]['preparationMode']=_0x5d2cb5['preparationMode']!=null?_0x5d2cb5[_0x840637(0x23a)]:_0x57334c[_0x840637(0x1fc)][_0x840637(0x23a)],_0x57334c[_0x840637(0x205)]=!![]);const _0x50b8bf=await DataConverterSpell[_0x840637(0x1dd)](_0x2e90f3,_0x50254b,_0x3b54d6,_0x57334c);if(_0x50b8bf==null||_0x5d2cb5)continue;_0x425ce6[_0x3b54d6]=_0x50b8bf;}return _0x425ce6;}static async[_0x11f900(0x1bc)](_0x55da9e,_0x145b62,_0x2f22e0,_0x47689b,_0x93223d){const _0x4f089e=_0x11f900,_0x53d470=_0x55da9e['items'][_0x4f089e(0x225)](_0x2b94ca=>_0x2b94ca[_0x4f089e(0x1e3)]===_0x145b62||_0x2b94ca['id']===_0x145b62);if(!_0x53d470)return;const _0x959bd5=_0x53d470[_0x4f089e(0x21c)];_0x93223d=_0x93223d||{};let _0x2b6393;try{_0x2b6393=await Renderer[_0x4f089e(0x1d4)]['pCacheAndGet'](UrlUtil[_0x4f089e(0x1cb)],_0x2f22e0,_0x47689b);}catch(_0x62292){console['error'](...LGT,_0x4f089e(0x21b)+_0x47689b+'\x22!',_0x62292);return;}if(!_0x2b6393)return;const _0x3c4499=await DataConverterSpell['pGetSpellItem'](_0x2b6393,{...UtilActors['getActorSpellItemOpts'](_0x55da9e),..._0x93223d[_0x4f089e(0x1fc)]||{}}),_0x4a874d={'_id':_0x53d470['_id'],'data':{}};let _0x3fe4f3=![];MiscUtil[_0x4f089e(0x22d)](_0x959bd5[_0x4f089e(0x21c)],_0x4f089e(0x1dc),'mode')===_0x4f089e(0x1ca)&&MiscUtil[_0x4f089e(0x22d)](_0x3c4499[_0x4f089e(0x21c)],'preparation','mode')==='always'&&(_0x3fe4f3=!![],MiscUtil[_0x4f089e(0x240)](_0x4a874d['data'],_0x4f089e(0x1dc),_0x4f089e(0x243),_0x4f089e(0x212))),MiscUtil['get'](_0x959bd5['data'],'preparation',_0x4f089e(0x1ca))!==!![]&&MiscUtil[_0x4f089e(0x22d)](_0x3c4499[_0x4f089e(0x21c)],_0x4f089e(0x1dc),'prepared')===!![]&&(_0x3fe4f3=!![],MiscUtil[_0x4f089e(0x240)](_0x4a874d['data'],_0x4f089e(0x1dc),'prepared',!![])),_0x3fe4f3&&await _0x55da9e[_0x4f089e(0x224)](_0x4f089e(0x21a),_0x4a874d);}static async[_0x11f900(0x1d5)](_0xeb4dfe,_0x1d28ae,_0x387224){const _0x16c5cd=_0x11f900;_0x387224=_0x387224||{};const _0x59efe7=[],_0x55caf2=/{@spell ([^}]+)}/gi;let _0x44cdb3;while(_0x44cdb3=_0x55caf2[_0x16c5cd(0x223)](_0x1d28ae)){_0x59efe7['push'](_0x44cdb3[0x1]);}return this[_0x16c5cd(0x1d0)](_0xeb4dfe,_0x59efe7,_0x387224);}static async[_0x11f900(0x1dd)](_0x89f44a,_0x4d5416,_0x5ee55c,_0xc8f4eb){const _0x499cf7=_0x11f900;_0xc8f4eb=_0xc8f4eb||{};let _0x4172d8;try{_0x4172d8=await Renderer[_0x499cf7(0x1d4)]['pCacheAndGet'](UrlUtil[_0x499cf7(0x1cb)],_0x4d5416,_0x5ee55c);}catch(_0x4cf6c5){return console['error'](...LGT,_0x499cf7(0x21b)+_0x5ee55c+'\x22!',_0x4cf6c5),null;}if(!_0x4172d8)return null;if(!_0xc8f4eb[_0x499cf7(0x205)]){const _0x17aa1a=DataConverterSpell[_0x499cf7(0x210)](_0x89f44a,_0x4172d8['name'],_0x4172d8['source']);if(_0x17aa1a)return _0x17aa1a[_0x499cf7(0x1e3)]||_0x17aa1a['data']['_id'];}const _0x3ce597=await DataConverterSpell[_0x499cf7(0x211)](_0x4172d8,{...UtilActors[_0x499cf7(0x1e0)](_0x89f44a),..._0xc8f4eb[_0x499cf7(0x1fc)]||{}});if(_0xc8f4eb['isTemporary']){const _0x4d7fb8=await Item['create'](_0x3ce597,{'temporary':!![]});(_0x89f44a[_0x499cf7(0x21c)][_0x499cf7(0x1ce)]=_0x89f44a[_0x499cf7(0x21c)][_0x499cf7(0x1ce)]||[])[_0x499cf7(0x1bf)](_0x4d7fb8);}else{const _0x27b1ee=await _0x89f44a[_0x499cf7(0x229)]('OwnedItem',_0x3ce597,{});return _0x27b1ee[_0x499cf7(0x1e3)]||_0x27b1ee[_0x499cf7(0x21c)]['_id'];}}static[_0x11f900(0x210)](_0x2385bd,_0x558caa,_0x56acc8){const _0x7751b=_0x11f900;if(!_0x558caa||!_0x56acc8)return null;return _0x2385bd[_0x7751b(0x1ce)]&&_0x2385bd['items'][_0x7751b(0x225)](_0x4e40f7=>(_0x4e40f7['name']||'')['toLowerCase']()===_0x558caa[_0x7751b(0x24b)]()&&(!Config[_0x7751b(0x22d)](_0x7751b(0x1f3),_0x7751b(0x1d7))||(DataConverter[_0x7751b(0x1d8)](_0x4e40f7)||'')[_0x7751b(0x24b)]()===_0x56acc8[_0x7751b(0x24b)]()));}static[_0x11f900(0x1da)](_0x4f6e9d,_0x2027bc,_0x2a45bc){const _0x391fbd=_0x11f900;if(_0x2a45bc['href']&&_0x2a45bc[_0x391fbd(0x20f)]['hover']){if(_0x2a45bc[_0x391fbd(0x20f)][_0x391fbd(0x1d4)]['page']===UrlUtil['PG_SPELLS']){const _0x48d7a0=_0x2a45bc[_0x391fbd(0x20f)][_0x391fbd(0x215)]?_0x2a45bc[_0x391fbd(0x20f)]['hash']:UrlUtil[_0x391fbd(0x1c4)](_0x2a45bc['href'][_0x391fbd(0x1f7)]),_0x12ed09=_0x2027bc[_0x48d7a0];if(_0x12ed09!=null){const _0x71d144=JSON[_0x391fbd(0x213)]({'actorId':_0x4f6e9d,'itemId':_0x12ed09})[_0x391fbd(0x216)]();return{'isDisableEvents':!![],'string':UtilEvents[_0x391fbd(0x226)]+'=\x22'+_0x71d144+'\x22'};}}}return null;}}export{DataConverterSpell};
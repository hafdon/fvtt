const _0x3fcd=['DATA_URL_OPTIONALFEATURES','getMaxWindowHeight','pRenderStarting','set','update','background','uid','compsClassLevelSelect','pImportClass','_pHandleSaveClick_pDoApplyToolProficiencies','preparationMode','Component','compAbility','MODE_MULTICLASS','usesPer','immune','feat_getActiveFeatIxProps','SOURCE_TYP_OFFICIAL_ALL','Build\x20complete!','compEquipmentShopGold','292618IiHwsz','ability','pCacheAndGet','_pRender_pRenderTabSpells','push','<button\x20class=\x22btn\x20btn-5et\x22>Finalize</button>','OwnedItem','languageProficiencies','uses','_compRace','_compAbility','compSpellAdditionalSpellRace','feats','Equipment\x20Shop','compClass','SRD','abilityAbv','967xCPUQe','compsSpellSpells','pGetUserBoolean','decorate','pImportEntry','error','class','isExpanded','_foundryStartingProficiencyMode','split','DataSourceSpecial','_foundryIsSkipImportPreparedSpells','Imported\x20background.','feat_getProps','_getTab','_pHandleSaveClick','resist','347UUIKCk','STR_SEE_CONSOLE','has','_render_pRenderTabEquipmentShop','pWaitForUserInput','additionalSpells','empty','skillProficiencies','render','Spells','compEquipmentStartingDefault','DATA_URL_BACKGROUNDS','feat','pGetItems','class_getTotalLevels','optionalfeature','compBackground','compBackgroundCharacteristics','pImportEquipmentItemEntries','Imported\x20race.','constructor','_pRender_renderTabBackground','copy','item','SKILL_TO_ATB_ABV','compEquipment','spells','filterBox','compBackgroundLanguageProficiencies','spellcastingAbility','_foundryFormDataCharacteristics','_pHandleSaveClick_pDoImportAdditionalSpells','_cbPostSave','forEach','_foundrySelectedLevelIndices','22274vwMtup','skills','pGetSpellItem','append','compBackgroundSkillProficiencies','PG_SPELLS','_pGetClassData','background_ixBackground','Failed\x20to\x20load!\x20','ActorCharactermancerSourceSelector_savedSelection','catch','setProgress','ascSort','_pRender','click','_pGetSources','multiclassing','inherit','toolProficiencies','/template/Charactermancer.handlebars','mergeMap','Select\x20Sources','class_getProps','state','_pHandleSaveClick_pDoApplySkills','_compEquipment','pageFilter','URL_TO_HASH_BUILDER','then','5etools','feat_ixMaxCustom','mode','_foundryAllFeatures','pInit','_pRender_renderTabRace','Imported\x20classes\x20and\x20subclasses.','data','_actor','_pRender_renderTabAbilities','1526QZgRpv','pLoad','_pLoad','Importing\x20race...','conditionImmune','namespace','Charactermancer','_render_loading','isPrepared','race','Race','vulnerable','getFormDataAsi','Imported\x20feats.','_foundryHpIncreaseMode','keys','pRender','_TOTAL_TASKS','compRaceDamageResistance','2gfRXwE','177083bXFYYy','startingEquipment','addClass','class_ixMax','Build\x20cancelled.','name','Are\x20You\x20Sure?','createEmbeddedEntity','get','_data','_tabs','max','_compBackground','_state','pGetAllSpells','compsSpellAdditionalSpellSubclass','_pHandleSaveClick_','ActorCharactermancerSourceSelector_filter','subclasses','pGetRaces','filterValuesSpellsCache','_compSpell','Build\x20failed!\x20','actor','MODULE_LOCATION','pGetClasses','_comp','delete','155BoQCpA','_pHandleSaveClick_pDoApplyLanguageProficiencies','sort','getMaxWindowWidth','Setting\x20ability\x20scores...','Imported\x20spells.','compRaceDamageVulnerability','Starting\x20Equipment','notifications','pPostLoad','modalFilterClasses','Class','getValues','_compFeat','compsClassSkillProficiencies','_compClass','compsSpellAdditionalSpellFeat','compStatgen','isCancelled','pGetWithCache','Abilities','map','compEquipmentCurrency','pHandleButtonClick','abilityChosen','isStreamerMode','Building...','Importing\x20feats...','compRaceDamageImmunity','$wrpTab','cbPostSave','_pRender_renderTabClass','2uyFPtF','compFeat','compRaceLanguageProficiencies','Importing\x20equipment...','isPrimary','28iqUTHP','Build\x20Complete','_render_pRenderTabEquipmentStarting','Importing\x20background...','Set\x20ability\x20scores.','length','compRaceToolProficiencies','appendTo','filter','btn-sm','race_ixRace','132WhoCrM','addFauxOptionalFeatureFeatures','cls','entries','mutateForFilters','equipmentItemEntries','364411ChtDGs','pGetFormData'];const _0x8081=function(_0x57b2c4,_0x161b1a){_0x57b2c4=_0x57b2c4-0xb8;let _0x3fcd1b=_0x3fcd[_0x57b2c4];return _0x3fcd1b;};const _0x1be304=_0x8081;(function(_0x2d3643,_0x4959ee){const _0x4be9e0=_0x8081;while(!![]){try{const _0x17f796=-parseInt(_0x4be9e0(0x194))*-parseInt(_0x4be9e0(0xe6))+parseInt(_0x4be9e0(0xd3))*parseInt(_0x4be9e0(0x128))+-parseInt(_0x4be9e0(0x14f))+-parseInt(_0x4be9e0(0x103))*parseInt(_0x4be9e0(0x160))+-parseInt(_0x4be9e0(0xe7))+parseInt(_0x4be9e0(0x171))*-parseInt(_0x4be9e0(0x133))+-parseInt(_0x4be9e0(0x139))*-parseInt(_0x4be9e0(0x123));if(_0x17f796===_0x4959ee)break;else _0x2d3643['push'](_0x2d3643['shift']());}catch(_0xd4ee4f){_0x2d3643['push'](_0x2d3643['shift']());}}}(_0x3fcd,0x24cb4));import{SharedConsts}from'../shared/SharedConsts.js';import{LGT,Util}from'./Util.js';import{Config}from'./Config.js';import{Vetools}from'./Vetools.js';import{ImportList}from'./ImportList.js';import{AppSourceSelectorMulti}from'./AppSourceSelectorMulti.js';import{ImportListRace}from'./ImportListRace.js';import{Charactermancer_Class_ProficiencyImportModeSelect,Charactermancer_Class_Util,PageFilterClassesFoundry}from'./UtilCharactermancerClass.js';import{ImportListClass}from'./ImportListClass.js';import{Charactermancer_StartingEquipment}from'./UtilCharactermancerEquipment.js';import{ImportListBackground}from'./ImportListBackground.js';import{DataConverterSpell}from'./DataConverterSpell.js';import{ImportListFeat}from'./ImportListFeat.js';import{UtilApplications}from'./UtilApplications.js';import{ActorCharactermancerRace}from'./ActorCharactermancerRace.js';import{ActorCharactermancerBaseComponent}from'./ActorCharactermancerUtil.js';import{ActorCharactermancerEquipment}from'./ActorCharactermancerEquipment.js';import{ActorCharactermancerBackground}from'./ActorCharactermancerBackground.js';import{ActorCharactermancerClass}from'./ActorCharactermancerClass.js';import{ActorCharactermancerFeat}from'./ActorCharactermancerFeat.js';import{ActorCharactermancerSpell}from'./ActorCharactermancerSpell.js';import{ActorCharactermancerAbility}from'./ActorCharactermancerAbility.js';class ActorCharactermancerSourceSelector extends AppSourceSelectorMulti{static async[_0x1be304(0x11a)](_0x1131d3,_0xfb120a,_0x587190,_0x429ae3){const _0x29500b=_0x1be304,_0x198c63=await this[_0x29500b(0xbb)](),_0x113a62=new ActorCharactermancerSourceSelector({'title':_0x29500b(0xc1),'filterNamespace':_0x29500b(0xf8),'savedSelectionKey':_0x29500b(0x19d),'sourcesToDisplay':_0x198c63});_0x113a62['render'](!![]);const _0x1a42c8=await _0x113a62[_0x29500b(0x175)]();if(_0x1a42c8==null)return;const _0x38a745=new ActorCharactermancer({'actor':_0xfb120a[_0x29500b(0xfe)],'data':_0x1a42c8});_0x38a745['render'](!![]);}static async['_pGetSources'](){const _0x1083f1=_0x1be304;return[new ImportList[(_0x1083f1(0x16a))](Config[_0x1083f1(0xef)]('ui',_0x1083f1(0x11c))?_0x1083f1(0x15e):_0x1083f1(0xc9),async()=>{const _0x105ae4=_0x1083f1,_0x1ce286={},[_0x447a74,_0x40bff2,_0x481221,_0xf56f67,_0x121ed6,_0xf279f4,_0x2ddb85]=await Promise['all']([this[_0x105ae4(0x19a)](),Vetools[_0x105ae4(0xfa)](),Vetools[_0x105ae4(0x116)](Vetools[_0x105ae4(0x17c)]),Vetools[_0x105ae4(0x17e)](),Vetools[_0x105ae4(0xf5)](),Vetools[_0x105ae4(0x116)](Vetools['DATA_URL_FEATS']),Vetools[_0x105ae4(0x116)](Vetools[_0x105ae4(0x13b)])]);return _0x1ce286[_0x105ae4(0x166)]=MiscUtil[_0x105ae4(0x187)](_0x447a74[_0x105ae4(0x166)]),_0x1ce286[_0x105ae4(0x166)]['forEach'](_0x5e5933=>PageFilterClasses['mutateForFilters'](_0x5e5933)),Charactermancer_Class_Util[_0x105ae4(0x134)](_0x1ce286[_0x105ae4(0x166)],_0x2ddb85[_0x105ae4(0x180)]),_0x1ce286[_0x105ae4(0xdc)]=MiscUtil[_0x105ae4(0x187)](_0x40bff2['race']),_0x1ce286[_0x105ae4(0xdc)]['forEach'](_0xaaec4=>PageFilterRaces[_0x105ae4(0x137)](_0xaaec4)),_0x1ce286[_0x105ae4(0x140)]=_0x481221[_0x105ae4(0x140)],_0x1ce286[_0x105ae4(0x188)]=_0xf56f67[_0x105ae4(0x188)],_0x1ce286['spell']=_0x121ed6['spell'],_0x1ce286['feat']=_0xf279f4[_0x105ae4(0x17d)],_0x1ce286[_0x105ae4(0x180)]=_0x2ddb85['optionalfeature'],_0x1ce286;},{'cacheKey':'5etools','filterTypes':[ImportList[_0x1083f1(0x14c)]],'isDefault':!![]})];}static async['_pGetClassData'](){const _0x3e4256=_0x1be304,_0x253e60=await Vetools[_0x3e4256(0x100)]();return{'class':await PageFilterClassesFoundry[_0x3e4256(0x10c)](_0x253e60)};}}class ActorCharactermancer extends Application{constructor(_0x579bee){const _0x251a6d=_0x1be304;_0x579bee=_0x579bee||{},super({'title':_0x251a6d(0xd9),'template':SharedConsts[_0x251a6d(0xff)]+_0x251a6d(0xbf),'width':Util[_0x251a6d(0x106)](0x4b0),'height':Util[_0x251a6d(0x13c)](),'resizable':!![]});const _0x3857d9={};_0x579bee[_0x251a6d(0xd0)][_0x251a6d(0x192)](_0x44dcb5=>{const _0x58942a=_0x251a6d;Object['entries'](_0x44dcb5)[_0x58942a(0x192)](([_0x448a66,_0x4da2d4])=>{if(_0x3857d9[_0x448a66])_0x3857d9[_0x448a66]=[..._0x3857d9[_0x448a66],MiscUtil['copy'](_0x4da2d4)];else _0x3857d9[_0x448a66]=MiscUtil['copy'](_0x4da2d4);});}),this[_0x251a6d(0x101)]=new ActorCharactermancer[(_0x251a6d(0x146))]({'actor':_0x579bee[_0x251a6d(0xfe)],'data':_0x3857d9});}['activateListeners'](_0x1adf4f){const _0x878c8f=_0x1be304;this[_0x878c8f(0x101)][_0x878c8f(0x179)](_0x1adf4f);}}ActorCharactermancer[_0x1be304(0x146)]=class extends ActorCharactermancerBaseComponent{constructor(_0x1f127f){const _0x174e41=_0x1be304;_0x1f127f=_0x1f127f||{},super(),TabUiUtil[_0x174e41(0x163)](this),this['_actor']=_0x1f127f['actor'],this[_0x174e41(0xf0)]=_0x1f127f[_0x174e41(0xd0)],this[_0x174e41(0x191)]=_0x1f127f[_0x174e41(0x121)],this['_tabs']=[_0x174e41(0x10e),_0x174e41(0xdd),_0x174e41(0x117),'Background',_0x174e41(0x10a),_0x174e41(0x15c),_0x174e41(0x17a),'Feats'][_0x174e41(0x118)]((_0x33de5c,_0x4266b7)=>this[_0x174e41(0x16e)](_0x4266b7,_0x33de5c,{'hasBorder':!![],'stateObj':this[_0x174e41(0xf4)]})),this[_0x174e41(0x158)]=new ActorCharactermancerRace({'actor':_0x1f127f[_0x174e41(0xfe)],'data':_0x1f127f[_0x174e41(0xd0)],'parent':this}),this[_0x174e41(0x112)]=new ActorCharactermancerClass({'actor':_0x1f127f[_0x174e41(0xfe)],'data':_0x1f127f[_0x174e41(0xd0)],'parent':this}),this['_compBackground']=new ActorCharactermancerBackground({'actor':_0x1f127f[_0x174e41(0xfe)],'data':_0x1f127f['data'],'parent':this}),this[_0x174e41(0xc5)]=new ActorCharactermancerEquipment({'actor':_0x1f127f[_0x174e41(0xfe)],'data':_0x1f127f[_0x174e41(0xd0)],'parent':this}),this[_0x174e41(0xfc)]=new ActorCharactermancerSpell({'actor':_0x1f127f[_0x174e41(0xfe)],'data':_0x1f127f[_0x174e41(0xd0)],'parent':this}),this[_0x174e41(0x110)]=new ActorCharactermancerFeat({'actor':_0x1f127f[_0x174e41(0xfe)],'data':_0x1f127f[_0x174e41(0xd0)],'parent':this}),this[_0x174e41(0x159)]=new ActorCharactermancerAbility({'actor':_0x1f127f[_0x174e41(0xfe)],'data':_0x1f127f[_0x174e41(0xd0)],'parent':this});}get[_0x1be304(0x15d)](){const _0x12324e=_0x1be304;return this[_0x12324e(0x112)];}get['compRace'](){return this['_compRace'];}get[_0x1be304(0x181)](){const _0x136b82=_0x1be304;return this[_0x136b82(0xf3)];}get[_0x1be304(0x18a)](){const _0x4e11d2=_0x1be304;return this[_0x4e11d2(0xc5)];}get['compSpell'](){const _0x55085a=_0x1be304;return this[_0x55085a(0xfc)];}get[_0x1be304(0x124)](){return this['_compFeat'];}get[_0x1be304(0x147)](){const _0x229a15=_0x1be304;return this[_0x229a15(0x159)];}['render'](_0x44f0e0){const _0x1956c8=_0x1be304;this['_render_loading'](_0x44f0e0),this[_0x1956c8(0xd5)]()[_0x1956c8(0xc8)](()=>this['_pRender'](_0x44f0e0))[_0x1956c8(0x19e)](_0x4640dd=>{const _0x1072e3=_0x1956c8;ui[_0x1072e3(0x10b)][_0x1072e3(0x165)](_0x1072e3(0x19c)+VeCt[_0x1072e3(0x172)]);throw _0x4640dd;});}[_0x1be304(0xda)](_0xd1afee){_0xd1afee['append']('<div\x20class=\x22flex-vh-center\x20w-100\x20h-100\x22><i>Loading...</i></div>');}async[_0x1be304(0xd5)](){const _0x4560e2=_0x1be304;await this[_0x4560e2(0x158)][_0x4560e2(0xd4)](),await this[_0x4560e2(0xf3)][_0x4560e2(0xd4)](),await this[_0x4560e2(0x112)][_0x4560e2(0xd4)](),await this[_0x4560e2(0xfc)]['pLoad'](),await this['_compFeat']['pLoad']();}async[_0x1be304(0xb9)](_0x56458f){const _0x12316d=_0x1be304;_0x56458f[_0x12316d(0x177)]();const _0x4d6563=$(_0x12316d(0x154))[_0x12316d(0xba)](()=>this[_0x12316d(0x16f)]());$$`<div class="w-100 no-shrink ui-tab__wrp-tab-heads--border">
			${this[_0x12316d(0xf1)]['map'](_0x11cf72=>_0x11cf72['$btnTab'][_0x12316d(0xe9)](_0x12316d(0x131)))}
		</div>`['appendTo'](_0x56458f),this['_tabs'][_0x12316d(0x192)](_0x2c30c9=>_0x2c30c9[_0x12316d(0x120)]['appendTo'](_0x56458f)),_0x56458f[_0x12316d(0x197)]('<hr\x20class=\x22hr-1\x20w-100\x22>'),$$`<div class="w-100 no-shrink flex-h-right pr-3">${_0x4d6563}</div>`[_0x12316d(0x12f)](_0x56458f);const [_0x3d1059,_0x3e74f5,_0x50147b,_0x2c9f56,_0x1d9498,_0x2d0d85,_0x47de59,_0x14820b]=this['_tabs'][_0x12316d(0x118)](_0x1a2fd6=>_0x1a2fd6[_0x12316d(0x120)]);this['_pRender_renderTabClass'](_0x3d1059),this[_0x12316d(0xce)](_0x3e74f5),this['_pRender_renderTabAbilities'](_0x50147b),this[_0x12316d(0x186)](_0x2c9f56),await this[_0x12316d(0x12a)](_0x1d9498),await this[_0x12316d(0x174)](_0x2d0d85),await this[_0x12316d(0x152)](_0x47de59),this['_pRender_renderTabFeats'](_0x14820b);}[_0x1be304(0x122)](_0x29415f){const _0x23dbf0=_0x1be304;this['_compClass'][_0x23dbf0(0x179)](_0x29415f);}['_pRender_renderTabRace'](_0x52aad2){const _0xad26d2=_0x1be304;this[_0xad26d2(0x158)][_0xad26d2(0x179)](_0x52aad2);}[_0x1be304(0xd2)](_0x54ab67){this['_compAbility']['render'](_0x54ab67);}[_0x1be304(0x186)](_0x3975ac){const _0x540f8b=_0x1be304;this[_0x540f8b(0xf3)][_0x540f8b(0x179)](_0x3975ac);}async[_0x1be304(0x12a)](_0x4f1bf8){const _0x34d0e3=_0x1be304;await this[_0x34d0e3(0xc5)][_0x34d0e3(0x13d)](_0x4f1bf8);}async[_0x1be304(0x174)](_0x370080){await this['_compEquipment']['pRenderShop'](_0x370080);}async[_0x1be304(0x152)](_0x4fe2d6){const _0x215584=_0x1be304;await this['_compSpell'][_0x215584(0xe3)](_0x4fe2d6);}['_pRender_renderTabFeats'](_0x5964fe){const _0x4f555d=_0x1be304;this[_0x4f555d(0x110)]['render'](_0x5964fe);}async['_pHandleSaveClick'](){const _0x3ea218=_0x1be304,_0x3c8327=await InputUiUtil[_0x3ea218(0x162)]({'title':_0x3ea218(0xed)});if(!_0x3c8327)return;const _0x5b7f3c=new UtilApplications['TaskRunner']({'titleInitial':_0x3ea218(0x11d),'titleComplete':_0x3ea218(0x129)});await _0x5b7f3c[_0x3ea218(0xcd)]();const _0x5b3239={'_':0x0};try{await this[_0x3ea218(0xf7)](_0x5b7f3c,_0x5b3239);}catch(_0x200ac7){_0x5b7f3c[_0x3ea218(0x19f)](_0x3ea218(0xfd)+VeCt[_0x3ea218(0x172)],_0x5b3239['_'],this['constructor']['_TOTAL_TASKS'],!![]);throw _0x200ac7;}}async[_0x1be304(0xf7)](_0x5ba25f,_0x487101){const _0x3dc74c=_0x1be304;_0x5ba25f[_0x3dc74c(0x19f)](_0x3dc74c(0x107),++_0x487101['_'],this[_0x3dc74c(0x185)]['_TOTAL_TASKS']);if(_0x5ba25f[_0x3dc74c(0x115)])return _0x5ba25f[_0x3dc74c(0x19f)](_0x3dc74c(0xeb),this['constructor'][_0x3dc74c(0xe4)],this[_0x3dc74c(0x185)][_0x3dc74c(0xe4)]);const _0x47d756=this['_compAbility']['compStatgen']['getTotals'](),_0x4e29fe={'data':{'abilities':{...Parser['ABIL_ABVS'][_0x3dc74c(0xc0)](_0x168521=>({[_0x168521]:{'value':_0x47d756?.['totals']?.[_0x47d756[_0x3dc74c(0xcb)]]?.[_0x168521]||0x0}}))}}};await this[_0x3dc74c(0xd1)][_0x3dc74c(0x13f)](_0x4e29fe),_0x5ba25f[_0x3dc74c(0x19f)](_0x3dc74c(0x12c),_0x487101['_'],this[_0x3dc74c(0x185)]['_TOTAL_TASKS']);if(_0x5ba25f[_0x3dc74c(0x115)])return _0x5ba25f[_0x3dc74c(0x19f)](_0x3dc74c(0xeb),_0x487101['_'],this[_0x3dc74c(0x185)][_0x3dc74c(0xe4)]);_0x5ba25f[_0x3dc74c(0x19f)](_0x3dc74c(0xd6),++_0x487101['_'],this['constructor'][_0x3dc74c(0xe4)]);const _0x5141d0=this['_data'][_0x3dc74c(0xdc)][this[_0x3dc74c(0x158)]['state'][_0x3dc74c(0x132)]];if(_0x5141d0){const _0x5105eb=new ImportListRace({'actor':this[_0x3dc74c(0xd1)]});await _0x5105eb[_0x3dc74c(0xcd)]();const _0x5f2207=MiscUtil[_0x3dc74c(0x187)](_0x5141d0);delete _0x5f2207[_0x3dc74c(0x150)],delete _0x5f2207['feats'],delete _0x5f2207[_0x3dc74c(0x176)],await this[_0x3dc74c(0xc4)](this['_compRace']['compRaceSkillProficiencies'],_0x5f2207,_0x3dc74c(0x178)),await this['_pHandleSaveClick_pDoApplyLanguageProficiencies'](this['_compRace'][_0x3dc74c(0x125)],_0x5f2207,_0x3dc74c(0x156)),await this['_pHandleSaveClick_pDoApplyToolProficiencies'](this[_0x3dc74c(0x158)][_0x3dc74c(0x12e)],_0x5f2207,_0x3dc74c(0xbe)),delete _0x5f2207[_0x3dc74c(0x14a)];if(this[_0x3dc74c(0x158)]['compRaceDamageImmunity']){const _0x489a68=await this['_compRace'][_0x3dc74c(0x11f)][_0x3dc74c(0x13a)](),_0x4c457e=[];Object[_0x3dc74c(0x136)](_0x489a68[_0x3dc74c(0xd0)])['filter'](([,_0x308868])=>_0x308868)[_0x3dc74c(0x192)](([_0x3116e6])=>_0x4c457e['push'](_0x3116e6));if(_0x4c457e[_0x3dc74c(0x12d)])_0x5f2207[_0x3dc74c(0x14a)]=_0x4c457e;}delete _0x5f2207[_0x3dc74c(0x170)];if(this[_0x3dc74c(0x158)][_0x3dc74c(0xe5)]){const _0x25c0c0=await this[_0x3dc74c(0x158)][_0x3dc74c(0xe5)][_0x3dc74c(0x13a)](),_0x1f8713=[];Object['entries'](_0x25c0c0[_0x3dc74c(0xd0)])['filter'](([,_0x341087])=>_0x341087)[_0x3dc74c(0x192)](([_0x22197b])=>_0x1f8713['push'](_0x22197b));if(_0x1f8713[_0x3dc74c(0x12d)])_0x5f2207[_0x3dc74c(0x170)]=_0x1f8713;}delete _0x5f2207[_0x3dc74c(0xde)];if(this[_0x3dc74c(0x158)][_0x3dc74c(0x109)]){const _0x48df31=await this['_compRace'][_0x3dc74c(0x109)][_0x3dc74c(0x13a)](),_0x1fa989=[];Object[_0x3dc74c(0x136)](_0x48df31[_0x3dc74c(0xd0)])['filter'](([,_0x2ee92f])=>_0x2ee92f)[_0x3dc74c(0x192)](([_0x45a43d])=>_0x1fa989[_0x3dc74c(0x153)](_0x45a43d));if(_0x1fa989[_0x3dc74c(0x12d)])_0x5f2207['vulnerable']=_0x1fa989;}delete _0x5f2207[_0x3dc74c(0xd7)];if(this['_compRace']['compRaceConditionImmunity']){const _0x526b29=await this[_0x3dc74c(0x158)]['compRaceConditionImmunity']['pGetFormData'](),_0x5e1ade=[];Object[_0x3dc74c(0x136)](_0x526b29['data'])['filter'](([,_0x1211f6])=>_0x1211f6)[_0x3dc74c(0x192)](([_0x449fb0])=>_0x5e1ade['push'](_0x449fb0));if(_0x5e1ade[_0x3dc74c(0x12d)])_0x5f2207[_0x3dc74c(0xd7)]=_0x5e1ade;}await _0x5105eb[_0x3dc74c(0x164)](_0x5f2207);}_0x5ba25f[_0x3dc74c(0x19f)](_0x3dc74c(0x184),_0x487101['_'],this[_0x3dc74c(0x185)][_0x3dc74c(0xe4)]);if(_0x5ba25f[_0x3dc74c(0x115)])return _0x5ba25f[_0x3dc74c(0x19f)]('Build\x20cancelled.',_0x487101['_'],this[_0x3dc74c(0x185)]['_TOTAL_TASKS']);_0x5ba25f[_0x3dc74c(0x19f)]('Importing\x20classes\x20and\x20subclasses...',++_0x487101['_'],this[_0x3dc74c(0x185)]['_TOTAL_TASKS']);const _0x2e79d8=[];for(let _0xff4204=0x0;_0xff4204<this['_compClass'][_0x3dc74c(0xc3)][_0x3dc74c(0xea)]+0x1;++_0xff4204){const {propIxClass:_0x139c10,propIxSubclass:_0x3e567f}=ActorCharactermancerBaseComponent[_0x3dc74c(0xc2)](_0xff4204),_0x5bf699=this['_data']['class'][this[_0x3dc74c(0x112)][_0x3dc74c(0xc3)][_0x139c10]];if(!_0x5bf699)continue;const _0x229174=this[_0x3dc74c(0x112)][_0x3dc74c(0xc3)][_0x3e567f]!=null?_0x5bf699[_0x3dc74c(0xf9)][this['_compClass'][_0x3dc74c(0xc3)][_0x3e567f]]:null;_0x2e79d8[_0x3dc74c(0x153)]({'ix':_0xff4204,'cls':_0x5bf699,'sc':_0x229174,'isPrimary':this['_compClass'][_0x3dc74c(0xc3)]['class_ixPrimaryClass']===_0xff4204});}if(_0x2e79d8['length']){_0x2e79d8[_0x3dc74c(0x105)]((_0x450faa,_0x2ee894)=>SortUtil[_0x3dc74c(0xb8)](Number(_0x2ee894['isPrimary']),Number(_0x450faa[_0x3dc74c(0x127)]))||SortUtil[_0x3dc74c(0xb8)](_0x450faa[_0x3dc74c(0x135)]['name'],_0x2ee894[_0x3dc74c(0x135)][_0x3dc74c(0xec)]));const _0x1f8202=new ImportListClass({'actor':this['_actor']});await _0x1f8202[_0x3dc74c(0xcd)]();const _0x53a31c=this[_0x3dc74c(0x112)][_0x3dc74c(0x10d)][_0x3dc74c(0xc6)][_0x3dc74c(0x18c)][_0x3dc74c(0x10f)]();for(let _0x337219=0x0;_0x337219<_0x2e79d8['length'];++_0x337219){const {ix:_0x291280,cls:_0x4733fc,sc:_0x5a8392,isPrimary:_0x36466d}=_0x2e79d8[_0x337219],_0x58264f=MiscUtil[_0x3dc74c(0x187)](_0x4733fc),_0x1a6f53=_0x5a8392?MiscUtil[_0x3dc74c(0x187)](_0x5a8392):null;if(_0x1a6f53)delete _0x1a6f53[_0x3dc74c(0x176)];if(_0x1a6f53)_0x58264f[_0x3dc74c(0xf9)]=[_0x1a6f53];else _0x58264f[_0x3dc74c(0xf9)]=[];_0x58264f[_0x3dc74c(0x168)]=_0x337219===0x0?Charactermancer_Class_ProficiencyImportModeSelect['MODE_PRIMARY']:Charactermancer_Class_ProficiencyImportModeSelect[_0x3dc74c(0x148)],_0x58264f[_0x3dc74c(0xe1)]=await this[_0x3dc74c(0x112)]['compsClassHpIncreaseMode'][_0x291280]['pGetFormData']()['data'],_0x58264f[_0x3dc74c(0x193)]=await this['_compClass'][_0x3dc74c(0x142)][_0x291280][_0x3dc74c(0x13a)]()[_0x3dc74c(0xd0)],_0x58264f[_0x3dc74c(0xcc)]=[];for(const _0x17d4e9 of this['_compClass']['compsClassFeatureOptionsSelect'][_0x291280]){const _0xe6b215=(await _0x17d4e9[_0x3dc74c(0x13a)]())[_0x3dc74c(0xd0)];_0x58264f[_0x3dc74c(0xcc)][_0x3dc74c(0x153)](..._0xe6b215);}_0x58264f[_0x3dc74c(0x16b)]=!![];const _0x57b359=_0x36466d?['startingProficiencies','skills']:[_0x3dc74c(0xbc),'proficienciesGained',_0x3dc74c(0x195)];await this[_0x3dc74c(0xc4)](this['_compClass'][_0x3dc74c(0x111)][_0x291280],_0x58264f,..._0x57b359),delete _0x58264f[_0x3dc74c(0xe8)],await _0x1f8202[_0x3dc74c(0x143)](_0x58264f,{'filterValues':_0x53a31c});}}_0x5ba25f[_0x3dc74c(0x19f)](_0x3dc74c(0xcf),_0x487101['_'],this[_0x3dc74c(0x185)][_0x3dc74c(0xe4)]);if(_0x5ba25f[_0x3dc74c(0x115)])return _0x5ba25f['setProgress']('Build\x20cancelled.',_0x487101['_'],this['constructor'][_0x3dc74c(0xe4)]);_0x5ba25f[_0x3dc74c(0x19f)](_0x3dc74c(0x12b),++_0x487101['_'],this[_0x3dc74c(0x185)][_0x3dc74c(0xe4)]);const _0xafb495=this[_0x3dc74c(0xf0)]['background'][this[_0x3dc74c(0xf4)][_0x3dc74c(0x19b)]];if(_0xafb495){const _0x109b92=new ImportListBackground({'actor':this[_0x3dc74c(0xd1)]});await _0x109b92['pInit']();const _0x5f3b26=MiscUtil[_0x3dc74c(0x187)](_0xafb495);await this[_0x3dc74c(0xc4)](this[_0x3dc74c(0xf3)][_0x3dc74c(0x198)],_0x5f3b26,_0x3dc74c(0x178)),await this[_0x3dc74c(0x104)](this[_0x3dc74c(0xf3)][_0x3dc74c(0x18d)],_0x5f3b26,_0x3dc74c(0x156)),await this[_0x3dc74c(0x144)](this[_0x3dc74c(0xf3)]['compBackgroundToolProficiencies'],_0x5f3b26,_0x3dc74c(0xbe)),this[_0x3dc74c(0xf3)][_0x3dc74c(0x182)]?_0x5f3b26[_0x3dc74c(0x18f)]=await this['_compBackground'][_0x3dc74c(0x182)]['pGetFormData']():_0x5f3b26['_foundryIsSkipImportCharacteristics']=!![],delete _0x5f3b26[_0x3dc74c(0xe8)],await _0x109b92['pImportEntry'](_0x5f3b26);}_0x5ba25f[_0x3dc74c(0x19f)](_0x3dc74c(0x16c),_0x487101['_'],this[_0x3dc74c(0x185)][_0x3dc74c(0xe4)]);if(_0x5ba25f['isCancelled'])return _0x5ba25f[_0x3dc74c(0x19f)](_0x3dc74c(0xeb),_0x487101['_'],this[_0x3dc74c(0x185)][_0x3dc74c(0xe4)]);_0x5ba25f['setProgress'](_0x3dc74c(0x11e),++_0x487101['_'],this['constructor']['_TOTAL_TASKS']);const _0x305bae=[],_0x58884a=new Set(this[_0x3dc74c(0x110)][_0x3dc74c(0x14b)]());for(let _0x754aae=0x0;_0x754aae<this['_compFeat'][_0x3dc74c(0xc3)]['feat_ixMaxAbility']+0x1;++_0x754aae){const {propIxFeat:_0x19ce7b}=ActorCharactermancerBaseComponent['feat_getProps'](_0x754aae,'ability');if(!_0x58884a['has'](_0x19ce7b))continue;_0x305bae['push']({'propIxFeat':_0x19ce7b,'namespace':'ability','ix':_0x754aae});}for(let _0x1e4d27=0x0;_0x1e4d27<this[_0x3dc74c(0x110)][_0x3dc74c(0xc3)]['feat_ixMaxRace']+0x1;++_0x1e4d27){const {propIxFeat:_0xb87af0}=ActorCharactermancerBaseComponent[_0x3dc74c(0x16d)](_0x1e4d27,_0x3dc74c(0xdc));if(!_0x58884a[_0x3dc74c(0x173)](_0xb87af0))continue;_0x305bae[_0x3dc74c(0x153)]({'propIxFeat':_0xb87af0,'namespace':_0x3dc74c(0xdc),'ix':_0x1e4d27});}for(let _0x54e28a=0x0;_0x54e28a<this[_0x3dc74c(0x110)][_0x3dc74c(0xc3)][_0x3dc74c(0xca)]+0x1;++_0x54e28a){const {propIxFeat:_0x470df4}=ActorCharactermancerBaseComponent['feat_getProps'](_0x54e28a,'custom');if(!_0x58884a[_0x3dc74c(0x173)](_0x470df4))continue;_0x305bae[_0x3dc74c(0x153)]({'propIxFeat':_0x470df4,'namespace':'custom','ix':_0x54e28a});}if(_0x305bae['length']){const _0x9e3746=new ImportListFeat({'actor':this['_actor']});await _0x9e3746[_0x3dc74c(0xcd)]();for(const _0x4cbf3e of _0x305bae){const _0x900569=this[_0x3dc74c(0xf0)][_0x3dc74c(0x17d)][this[_0x3dc74c(0x110)]['state'][_0x4cbf3e['propIxFeat']]];if(!_0x900569)continue;const _0x5885ae=MiscUtil[_0x3dc74c(0x187)](_0x900569);delete _0x5885ae['ability'],delete _0x5885ae[_0x3dc74c(0x176)],await _0x9e3746[_0x3dc74c(0x164)](_0x5885ae);}}_0x5ba25f[_0x3dc74c(0x19f)](_0x3dc74c(0xe0),_0x487101['_'],this[_0x3dc74c(0x185)][_0x3dc74c(0xe4)]);if(_0x5ba25f[_0x3dc74c(0x115)])return _0x5ba25f[_0x3dc74c(0x19f)]('Build\x20cancelled.',_0x487101['_'],this['constructor'][_0x3dc74c(0xe4)]);_0x5ba25f[_0x3dc74c(0x19f)]('Importing\x20spells...',++_0x487101['_'],this[_0x3dc74c(0x185)][_0x3dc74c(0xe4)]);const _0x17ec56=this['_compClass'][_0x3dc74c(0x17f)](),_0xf48a59=this[_0x3dc74c(0xfc)][_0x3dc74c(0xfb)]||this[_0x3dc74c(0xfc)]['filterBoxSpells']['getValues']();for(let _0x104c4e=0x0;_0x104c4e<this['_compClass'][_0x3dc74c(0xc3)][_0x3dc74c(0xea)]+0x1;++_0x104c4e){const {propIxClass:_0x40683e,propIxSubclass:_0x58e26a}=ActorCharactermancerBaseComponent[_0x3dc74c(0xc2)](_0x104c4e),_0x400d3a=this[_0x3dc74c(0xf0)][_0x3dc74c(0x166)][this[_0x3dc74c(0x112)][_0x3dc74c(0xc3)][_0x40683e]];if(!_0x400d3a)continue;const _0x2817c7=await this[_0x3dc74c(0x112)][_0x3dc74c(0x142)][_0x104c4e][_0x3dc74c(0x13a)]()[_0x3dc74c(0xd0)],_0x295cea=Math[_0x3dc74c(0xf2)](..._0x2817c7)+0x1;if(this[_0x3dc74c(0xfc)][_0x3dc74c(0x161)][_0x104c4e]){const _0x435efc=await this[_0x3dc74c(0xfc)][_0x3dc74c(0x161)][_0x104c4e]['pGetFormData'](_0xf48a59),_0x404e96=_0x435efc?.[_0x3dc74c(0xd0)]?.[_0x3dc74c(0x18b)]||[];for(let _0x4a875f=0x0;_0x4a875f<_0x404e96[_0x3dc74c(0x12d)];++_0x4a875f){const {spell:_0x3ea77f,isPrepared:_0x67051f,isLearned:_0x59b6c4,preparationMode:_0x1a73b6,usesCurrent:_0x43b42a,usesMax:_0x134d03,usesPer:_0x5659b9}=_0x404e96[_0x4a875f],_0x40bd5b=await DataConverterSpell[_0x3dc74c(0x196)](_0x3ea77f,{'isPrepared':_0x67051f||_0x59b6c4,'casterLevel':_0x295cea,'abilityAbv':_0x400d3a[_0x3dc74c(0x18e)],'preparationMode':_0x1a73b6,'usesCurrent':_0x43b42a,'usesMax':_0x134d03,'usesPer':_0x5659b9}),_0xa1fc78=await this[_0x3dc74c(0xd1)][_0x3dc74c(0xee)](_0x3dc74c(0x155),_0x40bd5b,{});}}const _0xda3606=this[_0x3dc74c(0x112)][_0x3dc74c(0xc3)][_0x58e26a]!=null?_0x400d3a[_0x3dc74c(0xf9)][this[_0x3dc74c(0x112)][_0x3dc74c(0xc3)][_0x58e26a]]:null;if(!_0xda3606)continue;if(this[_0x3dc74c(0xfc)]['compsSpellAdditionalSpellSubclass'][_0x104c4e]){const _0x3981f8=await this[_0x3dc74c(0xfc)][_0x3dc74c(0xf6)][_0x104c4e][_0x3dc74c(0x13a)]();await this['_pHandleSaveClick_pDoImportAdditionalSpells']({'formData':_0x3981f8,'targetLevel':_0x295cea,'abilityAbv':_0xda3606[_0x3dc74c(0x18e)]||_0x400d3a[_0x3dc74c(0x18e)]});}}if(this[_0x3dc74c(0xfc)][_0x3dc74c(0x15a)]){const _0x258dd7=await this['_compSpell']['compSpellAdditionalSpellRace'][_0x3dc74c(0x13a)]();await this[_0x3dc74c(0x190)]({'formData':_0x258dd7,'totalClassLevels':_0x17ec56});}const _0xd9389c=this[_0x3dc74c(0x159)][_0x3dc74c(0x114)][_0x3dc74c(0xdf)]();for(const _0x141864 of _0x305bae){const _0x384194=this[_0x3dc74c(0xfc)][_0x3dc74c(0x113)][_0x141864[_0x3dc74c(0xd8)]][_0x141864['ix']];if(_0x384194){let _0x1c0717=null;if(_0xd9389c['feats'][_0x141864['ix']]){const _0x535ca4=_0xd9389c[_0x3dc74c(0x15b)][_0x141864['ix']];_0x1c0717=Object[_0x3dc74c(0xe2)](_0x535ca4[_0x3dc74c(0x11b)]||{})[0x0];}const _0x3aa2bf=await _0x384194[_0x3dc74c(0x13a)]();await this[_0x3dc74c(0x190)]({'formData':_0x3aa2bf,'totalClassLevels':_0x17ec56,'parentAbilityAbv':_0x1c0717});}}_0x5ba25f[_0x3dc74c(0x19f)](_0x3dc74c(0x108),_0x487101['_'],this['constructor'][_0x3dc74c(0xe4)]);if(_0x5ba25f[_0x3dc74c(0x115)])return _0x5ba25f[_0x3dc74c(0x19f)](_0x3dc74c(0xeb),_0x487101['_'],this[_0x3dc74c(0x185)][_0x3dc74c(0xe4)]);_0x5ba25f[_0x3dc74c(0x19f)](_0x3dc74c(0x126),++_0x487101['_'],this['constructor'][_0x3dc74c(0xe4)]);const _0x5374b5=await this[_0x3dc74c(0xc5)][_0x3dc74c(0x119)][_0x3dc74c(0x13a)](),_0x2b3b11=await this['_compEquipment'][_0x3dc74c(0x17b)][_0x3dc74c(0x13a)](),_0x8cf092=await this['_compEquipment'][_0x3dc74c(0x14e)]['pGetFormData']();if(_0x5374b5?.[_0x3dc74c(0xd0)]?.['currency'])await Charactermancer_StartingEquipment['pUpdateActorCurrency'](this[_0x3dc74c(0xd1)],_0x5374b5);if(_0x2b3b11?.[_0x3dc74c(0xd0)]?.[_0x3dc74c(0x138)])await Charactermancer_StartingEquipment[_0x3dc74c(0x183)](this[_0x3dc74c(0xd1)],_0x2b3b11);if(_0x8cf092?.['data']?.[_0x3dc74c(0x138)])await Charactermancer_StartingEquipment[_0x3dc74c(0x183)](this[_0x3dc74c(0xd1)],_0x8cf092);_0x5ba25f[_0x3dc74c(0x19f)]('Imported\x20equipment.',_0x487101['_'],this['constructor'][_0x3dc74c(0xe4)]);if(_0x5ba25f['isCancelled'])return _0x5ba25f['setProgress'](_0x3dc74c(0xeb),_0x487101['_'],this['constructor'][_0x3dc74c(0xe4)]);_0x5ba25f[_0x3dc74c(0x19f)]('Running\x20post-build\x20step...',++_0x487101['_'],this[_0x3dc74c(0x185)][_0x3dc74c(0xe4)]);if(this[_0x3dc74c(0x191)])this[_0x3dc74c(0x191)]();_0x5ba25f['setProgress'](_0x3dc74c(0x14d),_0x487101['_'],this[_0x3dc74c(0x185)][_0x3dc74c(0xe4)]);}async[_0x1be304(0xc4)](_0xe69bd5,_0x4f5c75,..._0x335fbf){const _0xba8b6f=_0x1be304;MiscUtil[_0xba8b6f(0x102)](_0x4f5c75,..._0x335fbf);if(_0xe69bd5){const _0x5c58c5=await _0xe69bd5[_0xba8b6f(0x13a)](),_0x2a765a={};Object[_0xba8b6f(0xe2)](Parser[_0xba8b6f(0x189)])[_0xba8b6f(0x130)](_0x4b6989=>_0x5c58c5['data'][_0x4b6989])['forEach'](_0x147e08=>_0x2a765a[_0x147e08]=!![]),Object['keys'](_0x2a765a)[_0xba8b6f(0x12d)]&&MiscUtil[_0xba8b6f(0x13e)](_0x4f5c75,..._0x335fbf,[_0x2a765a]);}}async[_0x1be304(0x104)](_0xb3d651,_0x304cd8,..._0x2d049e){const _0x2ee211=_0x1be304;MiscUtil['delete'](_0x304cd8,..._0x2d049e);if(_0xb3d651){const _0x1f13f6=await _0xb3d651[_0x2ee211(0x13a)](),_0x349492={};Object[_0x2ee211(0x136)](_0x1f13f6[_0x2ee211(0xd0)])[_0x2ee211(0x192)](([_0x1aae3b,_0x16b543])=>_0x349492[_0x1aae3b]=_0x16b543),Object[_0x2ee211(0xe2)](_0x349492)[_0x2ee211(0x12d)]&&MiscUtil[_0x2ee211(0x13e)](_0x304cd8,..._0x2d049e,[_0x349492]);}}async[_0x1be304(0x144)](_0x39be8d,_0x3539bd,..._0x4e9790){const _0x5a792e=_0x1be304;MiscUtil[_0x5a792e(0x102)](_0x3539bd,..._0x4e9790);if(_0x39be8d){const _0x4016a7=await _0x39be8d['pGetFormData'](),_0x1ffa7d={};Object[_0x5a792e(0x136)](_0x4016a7[_0x5a792e(0xd0)])[_0x5a792e(0x192)](([_0x324982,_0x1d776c])=>_0x1ffa7d[_0x324982]=_0x1d776c),Object['keys'](_0x1ffa7d)[_0x5a792e(0x12d)]&&MiscUtil[_0x5a792e(0x13e)](_0x3539bd,..._0x4e9790,[_0x1ffa7d]);}}async[_0x1be304(0x190)]({formData:_0x3ca26c,targetLevel:_0xf622da,abilityAbv:_0x414915,parentAbilityAbv:_0x7e777a}){const _0x3c3d8c=_0x1be304,_0x2bf1dc=_0x3ca26c?.[_0x3c3d8c(0xd0)]||[];_0x414915=_0x3ca26c?.[_0x3c3d8c(0x15f)]||_0x414915;if(_0x414915===_0x3c3d8c(0xbd))_0x414915=_0x7e777a;for(const _0x149452 of _0x2bf1dc){if(_0x149452[_0x3c3d8c(0x167)])continue;let [_0x150862,_0x1d2873]=_0x149452[_0x3c3d8c(0x141)][_0x3c3d8c(0x169)]('|');if(!_0x1d2873)_0x1d2873=SRC_PHB;const _0x59ac36=UrlUtil[_0x3c3d8c(0xc7)][UrlUtil['PG_SPELLS']]({'name':_0x150862,'source':_0x1d2873}),_0x42b6f9=await Renderer['hover'][_0x3c3d8c(0x151)](UrlUtil[_0x3c3d8c(0x199)],_0x1d2873,_0x59ac36),_0x10535f=await DataConverterSpell['pGetSpellItem'](_0x42b6f9,{'isPrepared':_0x149452[_0x3c3d8c(0xdb)],'preparationMode':_0x149452[_0x3c3d8c(0x145)],'casterLevel':_0xf622da,'abilityAbv':_0x414915,'usesCurrent':_0x149452[_0x3c3d8c(0x157)],'usesMax':_0x149452[_0x3c3d8c(0x157)],'usesPer':_0x149452[_0x3c3d8c(0x149)]}),_0x175d39=await this[_0x3c3d8c(0xd1)][_0x3c3d8c(0xee)]('OwnedItem',_0x10535f,{});}}},ActorCharactermancer[_0x1be304(0x146)][_0x1be304(0xe4)]=0x8;export{ActorCharactermancerSourceSelector,ActorCharactermancerBaseComponent};